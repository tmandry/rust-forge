<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Rust Forge</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Supplemental documentation for contributing to The Rust Programming Language">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Overview</a></li><li class="chapter-item expanded "><a href="platforms/index.html">Platforms</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="platforms/twitter.html">Twitter</a></li><li class="chapter-item expanded "><a href="platforms/discord.html">Discord</a></li><li class="chapter-item expanded "><a href="platforms/email.html">Email</a></li><li class="chapter-item expanded "><a href="platforms/github.html">GitHub</a></li><li class="chapter-item expanded "><a href="platforms/zulip.html">Zulip</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="platforms/zulip/moderation.html">Moderation</a></li><li class="chapter-item expanded "><a href="platforms/zulip/triagebot.html">Triagebot</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="core/index.html">Core</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="core/blogs.html">Rust Blog Guidelines</a></li></ol></li><li class="chapter-item expanded "><a href="community/index.html">Community</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="community/survey-faq.html">State of Rust Survey FAQ</a></li></ol></li><li class="chapter-item expanded "><a href="compiler/index.html">Compiler</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="compiler/cross-compilation/index.html">Cross Compilation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="compiler/cross-compilation/windows.html">Windows</a></li></ol></li><li class="chapter-item expanded "><a href="compiler/cross-team-collaboration.html">Cross-team Collaboration</a></li><li class="chapter-item expanded "><a href="compiler/reviews.html">Review policies</a></li><li class="chapter-item expanded "><a href="compiler/new_option.html">So you want to add a new option to rustc?</a></li><li class="chapter-item expanded "><a href="compiler/mcp.html">Major Change Proposals</a></li><li class="chapter-item expanded "><a href="compiler/membership.html">Membership</a></li><li class="chapter-item expanded "><a href="compiler/prioritization.html">Prioritization</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="compiler/prioritization/procedure.html">Procedure</a></li><li class="chapter-item expanded "><a href="compiler/prioritization/priority-levels.html">Priority Levels</a></li></ol></li><li class="chapter-item expanded "><a href="compiler/notification-groups.html">Notification groups</a></li><li class="chapter-item expanded "><a href="compiler/triage-meeting.html">Triage Meeting</a></li><li class="chapter-item expanded "><a href="compiler/steering-meeting.html">Steering Meeting</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="compiler/steering-meeting/submit.html">Submitting a proposal</a></li><li class="chapter-item expanded "><a href="compiler/steering-meeting/how-to-run-planning.html">How to run the planning meeting</a></li><li class="chapter-item expanded "><a href="compiler/steering-meeting/how-to-run-design.html">How to run a design meeting</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="crates-io/index.html">crates.io</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="crates-io/crate-removal.html">Crate removal</a></li><li class="chapter-item expanded "><a href="crates-io/db-maintenance.html">Database maintenance</a></li></ol></li><li class="chapter-item expanded "><a href="docs-rs/index.html">docs.rs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="docs-rs/add-dependencies.html">Adding dependencies to the build environment</a></li><li class="chapter-item expanded "><a href="docs-rs/self-hosting.html">Self-hosting a docs.rs instance</a></li><li class="chapter-item expanded "><a href="docs-rs/maintenance.html">Maintenance procedures</a></li></ol></li><li class="chapter-item expanded "><a href="governance/index.html">Governance</a></li><li class="chapter-item expanded "><a href="infra/index.html">Infrastructure</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="infra/other-installation-methods.html">Other Installation Methods</a></li><li class="chapter-item expanded "><a href="infra/channel-layout.html">Release Channel Layout</a></li><li class="chapter-item expanded "><a href="infra/service-infrastructure.html">Service Infrastructure</a></li><li class="chapter-item expanded "><a href="infra/team-maintenance.html">Team Maintenance</a></li><li class="chapter-item expanded "><a href="infra/toolstate.html">The Toolstate System</a></li><li class="chapter-item expanded "><a href="infra/policies/index.html">Policies</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="infra/policies/broken-nightlies.html">Broken nightlies</a></li></ol></li><li class="chapter-item expanded "><a href="infra/guidelines/index.html">Guidelines</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="infra/guidelines/static-websites.html">Static websites</a></li></ol></li><li class="chapter-item expanded "><a href="infra/docs/index.html">Documentation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="infra/docs/aws-access.html">AWS access for team members</a></li><li class="chapter-item expanded "><a href="infra/docs/aws-access-management.html">AWS access management</a></li><li class="chapter-item expanded "><a href="infra/docs/bastion.html">Bastion server</a></li><li class="chapter-item expanded "><a href="infra/docs/bors.html">Bors</a></li><li class="chapter-item expanded "><a href="infra/docs/crater-agents.html">Crater agents</a></li><li class="chapter-item expanded "><a href="infra/docs/gha-self-hosted.html">Custom GitHub Actions runners</a></li><li class="chapter-item expanded "><a href="infra/docs/dev-desktop.html">Dev Desktops</a></li><li class="chapter-item expanded "><a href="infra/docs/dev-desktop-github-app.html">GitHub App for dev-desktops</a></li><li class="chapter-item expanded "><a href="infra/docs/discord-mods-bot.html">Discord moderation bot</a></li><li class="chapter-item expanded "><a href="infra/docs/dns.html">Domain names and DNS</a></li><li class="chapter-item expanded "><a href="infra/docs/docs-rs.html">docs.rs</a></li><li class="chapter-item expanded "><a href="infra/docs/ecs-services.html">ECS services management</a></li><li class="chapter-item expanded "><a href="infra/docs/monitoring.html">Monitoring</a></li><li class="chapter-item expanded "><a href="infra/docs/rust-bots.html">rust-bots server</a></li><li class="chapter-item expanded "><a href="infra/docs/rustc-ci.html">rust-lang/rust CI</a></li><li class="chapter-item expanded "><a href="infra/docs/sentry.html">Sentry</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="lang/index.html">Language</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="lang/rfc-merge-procedure.html">RFC Merge Procedure</a></li><li class="chapter-item expanded "><a href="lang/triage-meeting-procedure.html">Triage Meeting Procedure</a></li></ol></li><li class="chapter-item expanded "><a href="libs/index.html">Libs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="libs/maintaining-std.html">Maintaining the standard library</a></li></ol></li><li class="chapter-item expanded "><a href="release/index.html">Release</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="release/backporting.html">Backporting</a></li><li class="chapter-item expanded "><a href="release/release-notes.html">Preparing Release Notes</a></li><li class="chapter-item expanded "><a href="release/process.html">Release Process</a></li><li class="chapter-item expanded "><a href="release/rollups.html">Rollup Procedure</a></li><li class="chapter-item expanded "><a href="release/triage-procedure.html">Triage Procedure</a></li><li class="chapter-item expanded "><a href="release/crater.html">Triaging Crater Runs</a></li></ol></li><li class="chapter-item expanded "><a href="archive/index.html">Archive</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="archive/fott.html">Friends of the Tree</a></li><li class="chapter-item expanded "><a href="archive/release-history.html">Release History</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust Forge</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-lang/rust-forge" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="rust-forge"><a class="header" href="#rust-forge">Rust Forge</a></h1>
<p>Welcome to the Rust Forge! Rust Forge serves as a repository of supplementary
documentation useful for members of <a href="https://rust-lang.org">The Rust Programming Language</a>. If
you find any mistakes, typos, or want to add to the Rust Forge, feel free to
file an issue or PR on the <a href="https://github.com/rust-lang/rust-forge">Rust Forge GitHub</a>.</p>
<h3 id="help-wanted"><a class="header" href="#help-wanted">Help Wanted</a></h3>
<p>Want to contribute to Rust, but don't know where to start? Here's a list of
<code>rust-lang</code> projects that have marked issues that need help and issues that are
good first issues.</p>
<div class="table-wrapper"><table><thead><tr><th>Repository</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+is%3Aissue+label%3AE-help-wanted+no%3Aassignee">rust</a></td><td>The Rust Language &amp; Compiler</td></tr>
<tr><td><a href="https://github.com/rust-lang/cargo/issues?q=is%3Aopen+is%3Aissue+label%3AE-help-wanted+no%3Aassignee">cargo</a></td><td>The Rust package manager</td></tr>
<tr><td><a href="https://github.com/rust-lang/crates.io/issues?q=is%3Aopen+is%3Aissue+label%3AE-help-wanted+no%3Aassignee">crates.io</a></td><td>Source code for <a href="https://crates.io">crates.io</a></td></tr>
<tr><td><a href="https://github.com/rust-lang/www.rust-lang.org/issues?q=is%3Aopen+label%3A%22good+first+issue%22+no%3Aassignee">www.rust-lang.org</a></td><td>The Rust website</td></tr>
</tbody></table>
</div>
<h3 id="current-release-versions"><a class="header" href="#current-release-versions">Current Release Versions</a></h3>
<!-- All `<span id="..."></span>` elements are filled at run time when a reader
visits the website. Please refer to `js/index.js` for how these values
are generated.

Avoid changing the "Current Release Versions" without also updating the selector
in `js/index.js`.
-->
<div class="table-wrapper"><table><thead><tr><th>Channel</th><th>Version</th><th>Will be stable on</th><th>Will branch from master on</th></tr></thead><tbody>
<tr><td>Stable</td><td><span id="stable-version"></span></td><td><span id="stable-release-date"></span></td><td><span id="stable-branch-date"></span></td></tr>
<tr><td>Beta</td><td><span id="beta-version"></span></td><td><span id="beta-release-date"></span></td><td><span id="beta-branch-date"></span></td></tr>
<tr><td>Nightly</td><td><span id="nightly-version"></span></td><td><span id="nightly-release-date"></span></td><td><span id="nightly-branch-date"></span></td></tr>
<tr><td>Nightly +1</td><td><span id="next-version"></span></td><td><span id="next-release-date"></span></td><td><span id="next-branch-date"></span></td></tr>
</tbody></table>
</div>
<p>See the <a href="./release/process.html">release process</a> documentation for details on
what happens in the days leading up to a release.</p>
<h3 id="no-tools-breakage-week"><a class="header" href="#no-tools-breakage-week">No Tools Breakage Week</a></h3>
<p>To ensure the beta release includes all the tools, no <a href="./infra/toolstate.html">tool breakages</a> are
allowed in the week before the beta cutoff (except for nightly-only tools).</p>
<div class="table-wrapper"><table><thead><tr><th>Beta Cut</th><th>No Breakage Week</th></tr></thead><tbody>
<tr><td><span id="nightly-cycle"></span></td><td><span id="nightly-timespan"></span></td></tr>
<tr><td><span id="next-cycle"></span></td><td><span id="next-timespan"></span></td></tr>
</tbody></table>
</div>
<h3 id="external-links"><a class="header" href="#external-links">External Links</a></h3>
<ul>
<li><a href="https://rustc-dev-guide.rust-lang.org/appendix/bibliography.html">Bibliography</a> of research papers and other projects that influenced Rust.</li>
<li><a href="https://pontoon.rust-lang.org/">Rust Pontoon</a> is a translation management system used to localize the Rust
website.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="platforms"><a class="header" href="#platforms">Platforms</a></h2>
<p>Rust uses a number of different platforms for organizing work and internal communications between
teams. This does not currently seek to be an exhaustive list, rather documenting
the policies for a select few platforms used by the teams.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="twitter"><a class="header" href="#twitter">Twitter</a></h1>
<p>The Rust project has a number of official Twitter accounts, credentials for which are
currently maintained by the infrastructure team.</p>
<ul>
<li><a href="https://twitter.com/rustlang"><code>@rustlang</code></a></li>
<li><a href="https://twitter.com/RustStatus"><code>@RustStatus</code></a></li>
<li><a href="https://twitter.com/cratesiostatus"><code>@cratesiostatus</code></a></li>
<li><a href="https://twitter.com/rustasync"><code>@rustasync</code></a></li>
</ul>
<h2 id="twitter-guidelines"><a class="header" href="#twitter-guidelines">Twitter Guidelines</a></h2>
<p>The project runs the Twitter account [@rustlang]
The account is handled by a small team of volunteers.</p>
<p>The account will mostly tweet links to the Rust blog and Rust Insiders blog.
Additionally it will retweet:</p>
<ul>
<li>links to blog posts about Rust, retweeting the original author if possible</li>
<li>questions about Rust, so all followers can help</li>
<li>Meetup or conference announcements</li>
<li>announcements of new Rust projects</li>
<li>anything else relevant</li>
</ul>
<p>We will not retweet:</p>
<ul>
<li>content that bashes other programming languages/projects or is otherwise unconstructive in its discussion of language/tech choice</li>
<li>Personal announcements (&quot;Today I start my job at $COMPANY writing Rust&quot;)</li>
<li>Learning Rust updates (&quot;Today I started to learn Rust&quot;)</li>
</ul>
<p>The Direct Messages are open to everyone.
If someone wants something retweeted, they should send the tweet via DM.
The vast majority of these things should be retweeted, keeping it to the above rules.
Requests of an author via DM or Tweet to not retweet something will be honored.</p>
<p>Additionally account handlers may look through the <a href="https://twitter.com/hashtag/rustlang?src=hashtag_click">#rustlang</a> hashtag for noteworthy content.</p>
<p>The account will only follow a small number of Project-owned/related Twitter accounts.
At the time of writing (February 2022) this is only <a href="https://twitter.com/cratesiostatus">@cratesiostatus</a> and <a href="https://twitter.com/rust_foundation">@rust_foundation</a>.</p>
<h3 id="access"><a class="header" href="#access">Access</a></h3>
<p>Currently access to all four accounts is granted together via a 1password
vault; we don't split this into more fine-grained access. Some automation uses
API keys of the status accounts to automatically tweet about upcoming events on
crates.io.</p>
<p>Access is limited to a small set of folks in the
<a href="https://github.com/rust-lang/team/blob/master/teams/twitter.toml">twitter</a>
marker team; this isn't automated (changes should ping infra admins for provisioning access).</p>
<p>People with access to 1password should:</p>
<ul>
<li>Never change the password or take other administrative action (this is only
to be done by infra admins)</li>
<li>Exclusively use the project-hosted instance to keep a copy of the password
(don't save it to any other password database, including in browser)</li>
<li>Never share the password with others (even if they're in the list)
<ul>
<li>All access should always go through regular channels to ensure we're not
accidentally leaking the password by passing it through unsecure channels
(e.g., email)</li>
</ul>
</li>
<li>Be aware that the password may change regularly (requiring re-authorization)</li>
</ul>
<p>If you believe you should have access, please file a PR against the team
repository requesting it and note in the description that you've read this
policy.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="discord"><a class="header" href="#discord">Discord</a></h2>
<p>Rust's Discord is currently used by a variety of teams such as Community, Ops, and Documentation, as well as their working groups. It is also maintained as a communication tool for Domain Working Groups, and provides a space for general discussion among Rust users, contributors, and beginners. </p>
<h1 id="where-to-go-for-help-with-using-discord"><a class="header" href="#where-to-go-for-help-with-using-discord">Where to go for help with using Discord</a></h1>
<p>Discord's support center provides documentation about its <a href="https://support.discordapp.com/hc/en-us/categories/200404398">user interface</a> and <a href="https://support.discordapp.com/hc/en-us/categories/200404358">account settings</a>.</p>
<h1 id="getting-started"><a class="header" href="#getting-started">Getting started</a></h1>
<ol>
<li>
<p>Understand community standards <br/>
Discord, like all official Rust spaces, is governed by the Code of Conduct. Before joining the conversation there, you can prepare by reading the <a href="https://www.rust-lang.org/community#conduct">Code of Conduct and Moderation Guidelines</a>.
It is also useful to read <a href="https://discordapp.com/guidelines">Discord's Community Guidelines</a></p>
</li>
<li>
<p>Access channels <br/>
To access the Rust Discord, visit <a href="https://discord.gg/rust-lang">https://discord.gg/rust-lang</a>. If you do not already have a Discord account, you can register for one as part of the process of gaining access. Your first action should be agreeing to our Code of Conduct by following the instructions in #welcome.</p>
</li>
<li>
<p>Configure notifications <br/>
It is a good idea to disable notifications for channels that are not relevant to you, so that you will not be overwhelmed with messages. 
Select the expansion arrow next to the server name banner (titled &quot;The Rust Programming Language&quot;) and select Notifications from the dropdown. Then follow the configuration instructions provided <a href="https://support.discordapp.com/hc/en-us/articles/215253258-Notifications-Settings-101">on the Discord Support site</a>.</p>
</li>
</ol>
<h1 id="appropriate-conversation"><a class="header" href="#appropriate-conversation">Appropriate conversation</a></h1>
<p>Discussions should be related to the channel purpose. On team channels, conversation should be related to team business.
All channels are expected to be used for purposes related to the Rust project. Discussion of (for example) wildlife or sightseeing are not appropriate. </p>
<h1 id="channels"><a class="header" href="#channels">Channels</a></h1>
<p>The following channels are relevant to newcomers to the Rust project: </p>
<ul>
<li>welcome - Where you agree to the CoC.</li>
<li>rust-usage - This is a channel where you can access support for resolving specific language use questions. The <a href="https://users.rust-lang.org/">Rust Users Forum</a> is also relevant to your needs.</li>
<li>beginners - Here, you can meet people who began using Rust relatively recently. </li>
<li>contribute - Interested in contributing to the Rust project? In addition to joining this channel, you can subscribe to the <a href="https://this-week-in-rust.org/">This Week In Rust</a> newsletter, where many opportunities are regularly posted. 
It may also help to find out more about <a href="https://www.rust-lang.org/governance#teams">specific teams</a>.</li>
</ul>
<p>Channels outside of General are for contributors to Rust.</p>
<h1 id="messages"><a class="header" href="#messages">Messages</a></h1>
<p>Discord conversation takes place when people are available, so you should not generally expect that your messages will receive a response quickly unless a meeting is taking place. Depending on how your notifications are configured, you will see a red circle on top of the Discord icon in your system tray when new messages are received. If you wish to communicate with a specific individual, right-click on their user icon and select &quot;Message&quot; in the dropdown menu.</p>
<h1 id="read-only-view"><a class="header" href="#read-only-view">Read-only view</a></h1>
<p>Set up a Discord account (as described in Getting Started, above) in order to access Discord. There is not
currently a read-only archive view available. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="email"><a class="header" href="#email">Email</a></h1>
<p>While most of Rust's discussion happens on other platforms, email is eternal and
we occasionally need a way to approach individuals or groups privately. Our
email is hosted through Mailgun (provided by Mozilla). We create and edit the
mailing lists for teams through the <a href="https://github.com/rust-lang/team">rust-lang/team</a> repository. Our email
domain is <code>rust-lang.org</code>, e.g. <code>ferris@rust-lang.org</code>.</p>
<h2 id="sending-a-public-broadcast"><a class="header" href="#sending-a-public-broadcast">Sending a public broadcast</a></h2>
<p>If your teams need to reach everyone in the Rust organisation, they can send an
email to <code>all@</code>. It is recommended that you only use this mailing list when you
know that you need to contact every member, such as for organising a members event
like the All Hands, or for security alerts.</p>
<h3 id="keeping-responses-private"><a class="header" href="#keeping-responses-private">Keeping responses private</a></h3>
<p>When sending a message to <code>all@</code>, do not put <code>all@</code> in <code>To</code>. This will mean that
any replies to your broadcast will also be sent to everyone. Instead, put your
team's email address in <code>To</code> field, and place <code>all@</code> in the <code>Bcc</code> field. Then
any replies will be sent to just your team.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="github"><a class="header" href="#github">GitHub</a></h1>
<p>Github is where the Rust project hosts all of its code, as well as large parts
of its discussions.</p>
<h2 id="organisations"><a class="header" href="#organisations">Organisations</a></h2>
<ul>
<li><a href="https://github.com/rust-lang"><code>rust-lang</code></a> — The Rust project organisation.</li>
<li><a href="https://github.com/rust-embedded"><code>rust-embedded</code></a> — The Embedded Working Group organisation.</li>
<li><a href="https://github.com/rustwasm"><code>rustwasm</code></a> — The WebAssembly Working Group organisation.</li>
<li><a href="https://github.com/rust-cli"><code>rust-cli</code></a> — The Command Line Application Working Group organisation.</li>
<li><a href="https://github.com/rust-secure-code"><code>rust-secure-code</code></a> — The Secure Code Working Group organisation.</li>
<li><a href="https://github.com/rust-gamedev"><code>rust-gamedev</code></a> — The Game Development Working Group organisation.</li>
</ul>
<h2 id="team-repositories"><a class="header" href="#team-repositories">Team Repositories</a></h2>
<ul>
<li><a href="https://github.com/rust-lang/compiler-team">Compiler Team</a></li>
<li><a href="https://github.com/rust-lang/core-team">Core Team</a></li>
<li><a href="https://github.com/rust-lang/crates-io-cargo-teams">Crates.io Team</a></li>
<li><a href="https://github.com/rust-lang/infra-team">Infrastructure Team</a></li>
<li><a href="https://github.com/rust-lang/lang-team">Language Team</a></li>
<li><a href="https://github.com/rust-lang/moderation-team">Moderation Team</a></li>
<li><a href="https://github.com/rust-lang/release-team">Release Team</a></li>
</ul>
<h2 id="administration-faq"><a class="header" href="#administration-faq">Administration FAQ</a></h2>
<blockquote>
<p>Who administrates the <code>rust-lang</code> organisation?</p>
</blockquote>
<p>All core team members have the <code>admin</code> role.</p>
<blockquote>
<p>How do I create a new repository under the <code>rust-lang</code> organisation, or make
changes that require <code>admin</code> level permissions?</p>
</blockquote>
<p>You can contact a GitHub admin directly, or post the request in <a href="https://rust-lang.zulipchat.com/#narrow/stream/217588-project-leads.20(public)"><code>project leads (public)</code></a> stream on Zulip and an admin will be able to respond to your request
there.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="zulip"><a class="header" href="#zulip">Zulip</a></h1>
<p><a href="https://rust-lang.zulipchat.com">Rust's Zulip</a> is used by a number of teams, notably
the compiler, language, and library teams, along with their working groups.</p>
<p>Zulip can be an unintuitive platform to get started with. To get started, take a
look at the <a href="https://zulipchat.com/help/getting-started-with-zulip">getting started
guide</a>. For more detail,
examine the <a href="https://zulipchat.com/help/">Zulip user documentation</a>!</p>
<h2 id="where-to-go-for-help-with-using-zulip"><a class="header" href="#where-to-go-for-help-with-using-zulip">Where to go for help with using Zulip</a></h2>
<p>If you're testing a feature, or want to get help, the <code>#zulip</code> stream is the
place to go. Like elsewhere, the best thing to do is to create a new topic
for each question.</p>
<h2 id="getting-started-1"><a class="header" href="#getting-started-1">Getting started</a></h2>
<p>It is recommended to first look at the official <a href="https://zulipchat.com/help/getting-started-with-zulip">getting started
guide</a>. Like Rust itself,
Zulip is a bit special and reading the documentation before digging can be
really helpful.</p>
<p>You'll definitely want to configure the streams that you're subscribed to when
getting started; the default set is quite limited, and there are many groups
that exist beyond it. Subscribing to a stream is very low cost -- it is similar
to being &quot;in&quot; an IRC channel, except that logs are available for all streams,
regardless of subscription status.</p>
<p>It's not necessary to introduce yourself, but feel free to say hello in the
<code>#new members</code> stream.</p>
<h2 id="user-groups"><a class="header" href="#user-groups">User groups</a></h2>
<p>User groups can be pinged by anyone with the <code>@&lt;group&gt;</code> notation, same as
pinging another user. Groups can be created by anyone, and anyone can join a
group.</p>
<p>Users should feel free to join (or leave) groups on their own. Furthermore,
users should feel free to create groups as needed, though it is currently
expected that this is somewhat rare. You should name your group similar to how
you would name a stream for the same purpose, though groups can be more
fine-grained (or less). For example, <code>@T-compiler/meeting</code> currently does not
have a dedicated stream.</p>
<h2 id="appropriate-conversation-1"><a class="header" href="#appropriate-conversation-1">Appropriate conversation</a></h2>
<p>In most streams, you should try to keep conversations related to team business.
The <code>#general</code> stream is a bit broader, but even there, discussions should be
closely related to Rust (though may not relate to projects of any particular
team). All channels are expected to be used for discussions related to the Rust
project, though; discussions of (for example) wildlife or sightseeing are not
appropriate.</p>
<h2 id="streams"><a class="header" href="#streams">Streams</a></h2>
<p>These are similar to &quot;channels&quot; on other platforms (i.e., there should not be
too many). On the other hand, you can choose which streams you subscribe to, so
there can be more than channels on other platforms. Read <a href="https://zulipchat.com/help/about-streams-and-topics">Zulip's
documentation</a> for more
details.</p>
<p>Streams are appropriate for any Rust official group. For example, working
groups, project groups, teams are all examples of official groups. These should
ideally also be represented in the <a href="platforms/../infra/team-maintenance.html">team repository</a>.</p>
<h3 id="default-streams"><a class="header" href="#default-streams">Default streams</a></h3>
<p><strong>This section is still under debate, and it is not yet clear which direction we
will go. It is non-normative, and should not be used yet for modifications to
the Zulip instance.</strong></p>
<p>The default set of streams is chosen to allow incoming people to be able to have
at least one place to go that can then, if necessary, direct them to a more
specific location.</p>
<p>Currently that means that every top-level group present on Zulip is by default
visible. Specifically, no stream that contains a <code>/</code> will be enabled by default.</p>
<p>Currently this set is:</p>
<ul>
<li>general</li>
<li>t-lang</li>
<li>t-compiler</li>
<li>t-libs</li>
<li>project-ffi-unwind</li>
<li>project-inline-asm</li>
<li>project-safe-transmute</li>
<li>rust-survey-2019</li>
<li>wg-async-foundations</li>
<li>wg-database</li>
<li>wg-formal-methods</li>
<li>wg-secure-code</li>
<li>wg-traits</li>
<li>zulip</li>
</ul>
<p>An alternative, minimalistic, approach is to use:</p>
<ul>
<li>general</li>
<li>zulip</li>
<li>announce</li>
<li>new members</li>
</ul>
<p>as the default set, which would push people into customizing their default set when
starting out.</p>
<h3 id="stream-naming"><a class="header" href="#stream-naming">Stream naming</a></h3>
<p>A stream should be named such as <code>#t-{team}/{group name}</code>. For example,
<code>#t-compiler/wg-parallel-rustc</code>. More levels of nesting are fine, e.g., a
working group might want &quot;subgroups&quot; as well, though you may want to omit the
team name in such a case -- keeping the stream name short is good for usability,
to avoid confusion between different streams which share the same prefix.</p>
<p>If no top-level team exists, or the group spans multiple teams (e.g.,
project-ffi-unwind), then the top level team should be omitted.</p>
<p>Streams should be clearly communicated as being for a specific purpose. That
purpose can be broad, but it should likely include a group of some kind (even if
that group is transient, e.g., people who are having trouble with the rust build
system, or people working on the compiler). Furthermore, we do not currently
intend for this Zulip to be a general place for community projects not
affiliated with the Rust organization; if they wish to use Zulip, it is <a href="https://zulipchat.com/for/open-source/">free
for open source</a>.</p>
<p>When a new stream is created, you should announce it in <code>#announce</code>. This is
generally done automatically by Zulip.</p>
<h2 id="topics"><a class="header" href="#topics">Topics</a></h2>
<p>A topic is attached to every message within a given stream (these are the
subdivisions within streams). Topics are generally transient, and live for as
long as there is active discussion on a topic. Thinking of topics like email
subjects is helpful.</p>
<p>New conversation in a given stream should almost always start in a new topic,
not a preexisting one. Unlike (for example) GitHub issues, you should not
attempt to search for a past topic on the same subject. Do not spend too long on
the name of the topic, either, beyond trying to make it short. Topics should
generally be no longer than 20 characters (loosely two to three words), to make
sure it is visible to users.</p>
<p>You should eagerly fork new discussion topics into fresh topics. Note that this
can be done with the tail of another topic (if accidentally you diverge into
another area of discussion).</p>
<p>To fork from an existing topic, see Zulip's documentation
<a href="https://zulipchat.com/help/rename-a-topic">here</a>.</p>
<h2 id="messages-1"><a class="header" href="#messages-1">Messages</a></h2>
<p>Zulip is a unique platform which combines synchronous and
asynchronous communication in one location. You should not generally expect that
your messages will receive a response quickly, and unlike (for example) Discord,
there is likely not much reason to &quot;re-ping&quot; on a particular issue every few
hours as your message is unlikely to vanish into history, being isolated to a
specific topic.</p>
<h3 id="linkifiers"><a class="header" href="#linkifiers">Linkifiers</a></h3>
<p>Our Zulip supports a lot of helpful linkifiers, and we're generally happy to add
more on request. See <a href="https://rust-lang.zulipchat.com/help/add-a-custom-linkification-filter">the
documentation</a>
for the format. Propose one in <code>#zulip</code>!</p>
<p>Generally, <code>github-org/repo#123</code> works for linking to an issue or PR; the below
list gives a few more &quot;special cased&quot; repositories.</p>
<p>Don't forget that standard Markdown syntax for links also works.</p>
<p>We currently support linking to issues on a few repositories:</p>
<ul>
<li>rust-lang/rust with <a href="https://github.com/rust-lang/rust/issues/4545"><code>#4545</code></a> or <code>rust#4545</code></li>
<li>rust-lang/rfcs with <code>RFC#3434</code> or <code>rfc#3434</code></li>
<li>rust-lang/async-book with <code>async-book#2334</code></li>
<li>rust-lang/chalk with <code>chalk#2334</code></li>
<li>rust-lang/compiler-team with <code>compiler-team#3433</code></li>
<li>rust-lang/ena with <code>ena#3434</code></li>
<li>rust-lang/miri with <code>miri#3434</code></li>
<li>rust-lang/polonius with <code>polonius#3434</code></li>
<li>rust-analyzer/rust-analyzer with <code>rust-analyzer#3434</code></li>
<li>rust-lang/rustc-dev-guide with <code>rustc-dev-guide#3434</code></li>
<li>rust-lang/stdarch with <code>stdarch#3434</code></li>
<li>rust-lang/team with <code>team#3434</code></li>
<li>rust-lang/unsafe-code-guidelines with <code>ucg#3434</code></li>
</ul>
<p>We currently support linking to commits on these repositories:</p>
<ul>
<li>rust-lang/rust with 40-character long SHAs, e.g., <a href="https://github.com/rust-lang/rust/commit/25434f898b499876203a3b95c1b38bad5ed2cc5d"><code>25434f898b499876203a3b95c1b38bad5ed2cc5d</code></a></li>
</ul>
<h2 id="read-only-view-1"><a class="header" href="#read-only-view-1">Read-only view</a></h2>
<p>Our Zulip instance has the web-public streams beta feature enabled, and we use
it for all public streams. Please let us or Zulip developers know if there's any
problems with this. The previous solution to the web-public view was the zulip
archive, which now redirects to the web public view.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="zulip-moderation"><a class="header" href="#zulip-moderation">Zulip Moderation</a></h1>
<p>Zulip, like all official Rust spaces, is governed by the <a href="https://www.rust-lang.org/policies/code-of-conduct">Code of
Conduct</a>. If you have
concerns, please feel free to escalate to the moderation team.</p>
<p>However, though the moderation team is the top-level body here, it is not the
only place where you can seek help with moderation within Zulip.</p>
<p>One method for reaching the Zulip administrators privately is to email
<code>zulip-admin.239bd484c0347d2d43214d8581f3e125.show-sender@streams.zulipchat.com</code>.
See <a href="https://rust-lang.zulipchat.com/help/message-a-stream-by-email">this page</a>
for details on how this works.</p>
<p>You can also ping the <code>@mods</code> group on Zulip; note that this will be public.</p>
<p>It is not currently possible for normal users to self-administrate (e.g., muting
another user). However, each individual stream, including private streams, can
be muted:</p>
<h2 id="for-adminsmoderators"><a class="header" href="#for-adminsmoderators">For admins/moderators</a></h2>
<p>Some common actions for moderators are listed <a href="https://zulipchat.com/help/moderating-open-organizations">on this
page</a>.</p>
<p>Notably,</p>
<ul>
<li>in <a href="https://rust-lang.zulipchat.com/#organization/organization-permissions">&quot;Organization permissions&quot;</a>
we can restrict users to mandate invitations before joining (this is the &quot;no new users&quot; button)</li>
</ul>
<p>New admins/moderators should add themselves to the <code>mods</code> group on Zulip. (Note
that this is something that any user can do!)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="triagebot"><a class="header" href="#triagebot">Triagebot</a></h1>
<p>Triaging on the rust-lang repository is an important step to take care of issues. The triagebot is the tool that allows <em>anyone</em> to help by assigning, self-assigning or labeling issues without being a member of the rust-lang organization.</p>
<p>To enable triagebot on a particular repository (currently only in the rust-lang organization), add a <code>triagebot.toml</code> file in the repository root. It should have a section per &quot;feature&quot;. Please read this page to learn how to enable each feature and the options supported; if you spot something missing please let us know <a href="https://github.com/rust-lang/rust-forge/issues">by filing an issue</a>, thanks!</p>
<ul>
<li><a href="platforms/zulip/triagebot.html#issue-assignment">Issue assignment</a></li>
<li><a href="platforms/zulip/triagebot.html#issue-notifications">Issue notifications</a></li>
<li><a href="platforms/zulip/triagebot.html#ping-a-team">Ping a team</a></li>
<li><a href="platforms/zulip/triagebot.html#glacier">Glacier</a></li>
<li><a href="platforms/zulip/triagebot.html#triage">Triage</a></li>
<li><a href="platforms/zulip/triagebot.html#apply-labels-to-issues">Apply labels to issues</a></li>
<li><a href="platforms/zulip/triagebot.html#request-prioritization">Request prioritization</a></li>
<li><a href="platforms/zulip/triagebot.html#autolabel-an-issue">Autolabel an issue</a></li>
<li><a href="platforms/zulip/triagebot.html#notify-zulip">Notify Zulip</a></li>
<li><a href="platforms/zulip/triagebot.html#major-changes">Major Changes</a></li>
</ul>
<h2 id="issue-assignment"><a class="header" href="#issue-assignment">Issue assignment</a></h2>
<p>Any user belonging to the rust-lang organization can claim an issue via <code>@rustbot claim</code> or if the user is not part of the rust-lang organization <code>rustbot</code> will assign the issue to itself; then it will add a &quot;claimed&quot; message in the top-level comment, to signal who the current assignee is. It is possible to override someone else's claim (no warning/error is given).</p>
<p>You can drop your claim to the issue via <code>@rustbot release-assignment</code>; Rust team members can do the same if they want to release someone else's assignment.</p>
<p><code>@rustbot assign @user</code> can be used only by Rust team members and will assign that user to the issue (with same rules as before -- either directly or indirectly).</p>
<p>Soon (when the &quot;highfive&quot; bot migration will be complete, see <a href="https://github.com/rust-lang/highfive/pull/258">rust-lang/highfive#258</a>), <code>r?</code> will also assign reviewers to PRs, though unlike issues, non-team members cannot be assigned. Anyone can invoke the command.</p>
<p>To enable on a repository, add the following to a <code>triagebot.toml</code> file in the repository root.</p>
<pre><code class="language-toml">[assign]
</code></pre>
<h2 id="issue-notifications"><a class="header" href="#issue-notifications">Issue notifications</a></h2>
<p>Each registered team member has a notifications page at:</p>
<p><code>https://triage.rust-lang.org/notifications?user=&lt;github-username&gt;</code></p>
<p>This page is populated from direct mentions (@user) and team mentions (@rust-lang/libs) across the rust-lang organization.</p>
<p>It can also be edited via Zulip by <a href="https://rust-lang.zulipchat.com/#narrow/pm-with/261224-triage-rust-lang-bot">private-messaging triagebot</a>. Any Rust organization member can edit their notifications page, or pages of other Rust organization team members. To do so, the editor must have a <code>zulip-id</code> listed in their <code>people/username.toml</code> file in the <a href="https://github.com/rust-lang/team/">team repository</a>. The bot will tell you which ID to use when talking to it for the first time; please <code>r? @Mark-Simulacrum</code> on PRs adding Zulip IDs.</p>
<p>The following commands are supported:</p>
<ul>
<li><code>acknowledge &lt;url&gt;</code> (or short form <code>ack &lt;url&gt;</code>)</li>
<li><code>acknowledge &lt;idx&gt;</code> (or short form <code>ack &lt;idx&gt;</code>)</li>
</ul>
<p>These both acknowledge (and remove) a notification from the list.</p>
<ul>
<li><code>acknowledge all</code> or <code>acknowledge *</code> (or short form <code>ack all</code> or <code>ack *</code>)</li>
</ul>
<p>This acknowledges and removes all notifications.</p>
<ul>
<li><code>add &lt;url&gt; &lt;description... (multiple words)&gt;</code></li>
</ul>
<p>This adds a new notification to the list.</p>
<ul>
<li><code>move &lt;from&gt; &lt;to&gt;</code></li>
</ul>
<p>This moves the notification at index <code>from</code> to the index <code>to</code>.</p>
<ul>
<li><code>meta &lt;idx&gt; &lt;metadata...&gt;</code></li>
</ul>
<p>This adds some text as a sub-bullet to the notification at <code>idx</code>. If the metadata is empty, the text is removed.</p>
<ul>
<li><code>as &lt;github username&gt; &lt;command...&gt;</code></li>
</ul>
<p>This executes any of the above commands as if you were the other GH user.</p>
<h2 id="ping-a-team"><a class="header" href="#ping-a-team">Ping a team</a></h2>
<p>The bot can be used to &quot;ping&quot; teams of people that do not have corresponding Github teams. This is useful because sometimes we want to keep groups of people that we can notify but we don't want to add all the members in those groups to the Github org, as that would imply that they are members of the Rust team (for example, Github would decorate their names with &quot;member&quot; and so forth). The compiler team uses this feature to reach the <a href="https://rustc-dev-guide.rust-lang.org/notification-groups/about.html">notification groups</a>.</p>
<p>When a team is pinged, we will both post a message to the issue and add a label. The message will include a <code>cc</code> line that <code>@</code>-mentions all members of the team.</p>
<h3 id="teams-that-can-be-pinged"><a class="header" href="#teams-that-can-be-pinged">Teams that can be pinged</a></h3>
<p>To be pinged, teams have to be created in the <a href="https://github.com/rust-lang/team">Rust team repository</a>. Frequently those teams will be marked as <code>marker-team</code>, meaning that they do not appear on the website. The <a href="https://github.com/rust-lang/team/blob/master/teams/icebreakers-llvm.toml#L2">LLVM team</a> is an example.</p>
<h3 id="configuration"><a class="header" href="#configuration">Configuration</a></h3>
<p>To enable the team (e.g. <code>TeamName</code>) to be pinged, you have to add section to the <code>triagebot.toml</code> file at the root of a repository, like so:</p>
<pre><code class="language-toml">[ping.TeamName]
message = &quot;&quot;&quot;\
Put your message here. It will be added as a Github comment,
so it can include Markdown and other markup.
&quot;&quot;&quot;
label = &quot;help wanted&quot;
</code></pre>
<p>This configuration would post the given message and also add the label <code>help wanted</code> to the issue.</p>
<p>You can also define aliases to add additional labels to refer to same target team. Aliases can be useful to add mnemonic labels or accomodate slight mispellings (such as &quot;llvms&quot; instead &quot;llvm&quot;), see the following example:</p>
<pre><code class="language-toml">[ping.cleanup-crew]
alias = [&quot;cleanup&quot;, &quot;cleanups&quot;, &quot;shrink&quot;, &quot;reduce&quot;, &quot;bisect&quot;]
message = &quot;&quot;&quot;\
message content...
&quot;&quot;&quot;
</code></pre>
<p>This will allow the command <code>@rustbot ping cleanup-crew</code> to be understood with all the aliased variants, ex.:</p>
<pre><code class="language-text">@rustbot ping cleanup
@rustbot ping shrink
...
</code></pre>
<p>Check out <a href="https://github.com/rust-lang/rust/blob/master/triagebot.toml">the rust-lang/rust configuration</a> for an up-to-date examples.</p>
<h3 id="pinging-teams"><a class="header" href="#pinging-teams">Pinging teams</a></h3>
<p>To ping the team <code>XXX</code>, simply leave a comment with the command:</p>
<pre><code class="language-text">@rustbot ping XXX
</code></pre>
<h3 id="related-issues"><a class="header" href="#related-issues">Related issues</a></h3>
<ul>
<li>Requested in <a href="https://github.com/rust-lang/triagebot/issues/169">https://github.com/rust-lang/triagebot/issues/169</a></li>
</ul>
<h2 id="glacier"><a class="header" href="#glacier">Glacier</a></h2>
<p>This adds the option to track ICEs (Internal Compiler Errors). Do note that the GitHub Gist must be from a <a href="https://play.rust-lang.org">Rust Playground</a> link. The link must also be in quotes (<code>&quot;&quot;</code>), example:</p>
<p><code>@rustbot glacier &quot;https://gist.github.com/rust-play/xxx&quot;</code></p>
<p>where <code>xxx</code> is the SHA1 hash of the GitHub gist generated by the Playground &quot;share&quot; button.</p>
<h2 id="triage"><a class="header" href="#triage">Triage</a></h2>
<p>This command can be used by people in charge of prioritizing issues, to assign either low or high priorities to issues. This is mostly done by the Compiler Prioritization WG for compiler bugs.</p>
<p><code>@rustbot triage {high,medium,low}</code></p>
<p>The configuration for this feature is:</p>
<pre><code class="language-toml">[triage]
remove = [&quot;I-prioritize&quot;] # the set of labels to remove when this command is invoked
high = &quot;P-high&quot;
medium = &quot;P-medium&quot;
low = &quot;P-low&quot;
</code></pre>
<h2 id="apply-labels-to-issues"><a class="header" href="#apply-labels-to-issues">Apply labels to issues</a></h2>
<p>This command lets anyone apply labels to issues. This is most useful when opening an issue. In general, labels get applied to issues by the Triage WG. If you are interested in helping triaging issues, see the <a href="platforms/zulip/../../release/triage-procedure.html">Triage WG procedure</a>.</p>
<p>The specific grammar can be found <a href="https://github.com/rust-lang/triagebot/blob/master/parser/src/command/relabel.rs">here</a>, but some examples are listed below. The grammar is intended to be fairly intuitive for people, to prevent needing to reach for documentation when using the bot.</p>
<pre><code class="language-text">@rustbot modify labels to +T-lang, -T-compiler
</code></pre>
<p>This will remove the <code>T-compiler</code> label and add the <code>T-lang</code> label. You can also omit the <code>+</code> sign, if you want, and it'll be implied.</p>
<p>You can also write the same command in a few other ways:</p>
<pre><code class="language-text">@rustbot modify labels to +T-lang and -T-compiler
@rustbot modify labels: +T-lang and -T-compiler
@rustbot modify labels to +T-lang -T-compiler
</code></pre>
<p>Note that the command can either terminate with a <code>.</code> or a newline, otherwise the bot will not parse the command successfully.</p>
<h3 id="errors"><a class="header" href="#errors">Errors</a></h3>
<p>The bot currently restricts the labels that can be applied by people outside the Rust teams. For example, they can't add the I-unsound label. Most of the time, you shouldn't hit this. Feel free to ping the release team if you feel that a label should be added to the set of allowed labels!</p>
<h3 id="enabling"><a class="header" href="#enabling">Enabling</a></h3>
<pre><code class="language-toml">[relabel]
# any label is allowed to be set by team members (anyone on a team in rust-lang/team)
# but these can be set by anyone in the world
allow-unauthenticated = [
    &quot;C-*&quot;, # any C- prefixed label will be allowed for anyone
           # independent of authorization with rust-lang/team
    &quot;!C-bug&quot;, # but not C-bug (order does not matter)
]
</code></pre>
<h2 id="request-prioritization"><a class="header" href="#request-prioritization">Request prioritization</a></h2>
<p>Users can request an issue to be prioritized by the Prioritization WG.</p>
<p>To do so, you can invoke the following command:</p>
<pre><code class="language-text">@rustbot prioritize
</code></pre>
<p>This will simply add the <code>I-prioritize</code> label to the issue.</p>
<h3 id="errors-1"><a class="header" href="#errors-1">Errors</a></h3>
<p>The command fails if the issue has already been requested for prioritization (i.e. already has the <code>I-prioritize</code> label).</p>
<h3 id="enabling-1"><a class="header" href="#enabling-1">Enabling</a></h3>
<pre><code class="language-toml">[prioritize]
# Name of the label used for requesting prioritization on issues
label = &quot;I-prioritize&quot;
</code></pre>
<h2 id="autolabel-an-issue"><a class="header" href="#autolabel-an-issue">Autolabel an issue</a></h2>
<p>When certain labels are added to an issue, this command will trigger adding a set of additional prioritization labels to the issue. In the following example adding the &quot;I-prioritize&quot; label will automatically add the labels in <code>trigger_labels</code> but only if the issue is not already labeled with those in <code>exclude_labels</code> (this is to avoid applying unrelated labels to issues).</p>
<pre><code class="language-toml">[autolabel.&quot;I-prioritize&quot;]
trigger_labels = [
    &quot;regression-from-stable-to-stable&quot;,
    &quot;regression-from-stable-to-beta&quot;,
    &quot;regression-from-stable-to-nightly&quot;
]
exclude_labels = [
    &quot;P-*&quot;,
    &quot;T-infra&quot;,
    &quot;T-release&quot;
]
</code></pre>
<h2 id="notify-zulip"><a class="header" href="#notify-zulip">Notify Zulip</a></h2>
<p>When a prioritization label is added to an issue, this command will create a new topic on Zulip, in the designated stream (&quot;245100&quot; in the following example), replacing <code>{number}</code> and <code>{title}</code> with the issue GitHub ID and title:</p>
<pre><code class="language-toml">[notify-zulip.&quot;I-prioritize&quot;]
zulip_stream = 245100 # t-compiler/wg-prioritization/alerts
topic = &quot;I-prioritize #{number} {title}&quot;
message_on_add = &quot;@**WG-prioritization** issue #{number} has been requested for prioritization.&quot;
message_on_remove = &quot;Issue #{number}'s prioritization request has been removed.&quot;
</code></pre>
<p>The subscribers of that Zulip stream will receive a notification and can discuss the prioritization of the issue.</p>
<h2 id="major-changes"><a class="header" href="#major-changes">Major Changes</a></h2>
<p>A major change is an issue that will have a big impact on users. See <a href="platforms/zulip/../../compiler/mcp.html">this page on the MCP process</a> for detailed explanations.</p>
<p>The compiler team uses the major change process, which requires:</p>
<ul>
<li>An issue</li>
<li>A &quot;second&quot;, who is an expert from the Compiler team who thinks the proposal is a good idea</li>
</ul>
<p>We have supporting automation for both parts.</p>
<p>First, on the rust-lang/compiler-team repository, an issue with the &quot;major-change&quot; label (MCP = Major Change Proposal) is created via the template. Once that's opened, it automatically gains the &quot;to-announce&quot; label which should be removed when it's announced at a compiler team meeting.</p>
<p>For seconds, you tell rustbot <code>@rustbot seconded</code> or <code>@rustbot second</code> and it will apply the relevant label. Only team members can do so.</p>
<p>Configuration:</p>
<pre><code class="language-toml">[major-change]
# Label to apply once an MCP is seconded
second_label = &quot;final-comment-period&quot;
# Label to apply when an MCP is created
meeting_label = &quot;to-announce&quot;
# The Zulip stream to automatically create topics about MCPs in
# Can be found by looking for the first number in URLs, e.g. https://rust-lang.zulipchat.com/#narrow/stream/131828-t-compiler
zulip_stream = 131828
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="core"><a class="header" href="#core">Core</a></h1>
<p>This section documents policies established by the core team. These
policies tend to apply for &quot;project-wide resources&quot;, such as the Rust
blogs.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-blog-guidelines"><a class="header" href="#rust-blog-guidelines">Rust Blog Guidelines</a></h1>
<h2 id="context"><a class="header" href="#context">Context</a></h2>
<p>The Rust project maintains two blogs. The “main blog” (blog.rust-lang.org) and a “team blog”
(blog.rust-lang.org/inside-rust). This document provides the guidelines for what it takes to write
a post for each of those blogs, as well as how to propose a post and to choose which blog is most
appropriate.</p>
<h2 id="how-to-select-the-right-blog-audience"><a class="header" href="#how-to-select-the-right-blog-audience">How to select the right blog: audience</a></h2>
<p>So you want to write a Rust blog post, and you’d like to know which blog you should post it on.
Ultimately, there are three options:</p>
<ul>
<li>The main Rust blog
<ul>
<li>Suitable when your audience is “all Rust users or potential users”</li>
<li>Written from an “official position”, even if signed by an individual</li>
</ul>
</li>
<li>The team Rust blog
<ul>
<li>Suitable when your audience is “all Rust contributors or potential contributors”</li>
<li>Written from an “official position”, even if signed by an individual</li>
</ul>
</li>
<li>Your own personal blog
<ul>
<li>Everything else</li>
</ul>
</li>
</ul>
<p>There are two key questions to answer in deciding which of these seems right:</p>
<ul>
<li>Are you speaking in an “official capacity” or as a “private citizen”?</li>
<li>Who is the audience for your post?</li>
</ul>
<p>In general, if you are speaking as a “private citizen”, then you are probably best off writing on
your own personal blog.</p>
<p>If, however, you are writing in an <strong>official capacity</strong>, then one of the Rust blogs would be a
good fit. Note that this doesn’t mean you can’t write as an individual. Plenty of the posts on
Rust’s blog are signed by individuals, and, in fact, that is the preferred option. However, those
posts are typically documenting the official position of a team — a good example is Aaron Turon’s
classic post on <a href="https://blog.rust-lang.org/2017/03/02/lang-ergonomics.html">Rust’s language ergonomics
initiative</a>. Sometimes, the posts are
describing an exciting project, but again in a way that represents the project as a whole (e.g.,
Manish Goregaokar’s report on <a href="https://blog.rust-lang.org/2017/11/14/Fearless-Concurrency-In-Firefox-Quantum.html">Fearless Concurrency in Firefox
Quantum</a>).</p>
<p>To decide between the main blog and the team blog, the question to ask yourself is <strong>who is the
audience</strong> for your post. Posts on the main blog should be targeting <strong>all</strong> Rust users or
potential users — they tend to be lighter on technical detail, and written without requiring as
much context. Posts on the team blog can assume a lot more context and familiarity with Rust.</p>
<h2 id="writing-for-the-main-rust-blog"><a class="header" href="#writing-for-the-main-rust-blog">Writing for the Main Rust blog</a></h2>
<p>The core team ultimately decides what to post on the main Rust blog.</p>
<p>Post proposals describing exciting developments from within the Rust org are welcome, as well as
posts that describe exciting applications of Rust. We do not generally do “promotional
cross-posting” with other projects, however.</p>
<p>If you would like to propose a blog post for the main blog, please reach out to a <a href="https://www.rust-lang.org/governance/teams/core">core team
member</a>. It is not suggested to just open PRs
against the main Rust blog that add posts without first discussing it with a core team member.</p>
<h3 id="release-note-blog-posts"><a class="header" href="#release-note-blog-posts">Release note blog posts</a></h3>
<p>One special case are the regular release note posts that accompany every Rust release. These are
managed by the release team and go on the main blog.</p>
<p>The blog posts are published on the same day as the release by the same person in the release team
running the release. Releases always happen on Thursdays.</p>
<p>Before publishing a release post, it goes through a drafting process:</p>
<ol>
<li>The milestone (e.g. for <a href="https://github.com/rust-lang/rust/milestone/66?closed=1">1.39.0</a>) for the release is consulted.</li>
<li>PRs that we think are sufficiently important are included, and some items are headlined.
The writing of a blog post typically happens through a <a href="https://hackmd.io/">hackmd</a> document.</li>
<li>Headlined items are sometimes written by different people, and we try to peer-review each
subsection.</li>
<li>The blog post draft is submitted as a PR on the blog repo for final review a few days before the
release.</li>
</ol>
<h2 id="team-rust-blogs"><a class="header" href="#team-rust-blogs">Team Rust blogs</a></h2>
<p>Teams can generally decide for themselves what to write on the team Rust blog.</p>
<p>Typical subjects for team Rust blog posts include:</p>
<ul>
<li>New initiatives and calls for participation</li>
<li>Updates and status reports from ongoing work</li>
<li>Design notes</li>
</ul>
<p>To propose a blog post for the team blog of a particular team, reach out to the team lead or some
other team representative.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="community"><a class="header" href="#community">Community</a></h1>
<p>This section documents the processes of the community team, and related projects.</p>
<h3 id="external-links-1"><a class="header" href="#external-links-1">External Links</a></h3>
<ul>
<li>The <a href="https://github.com/rust-community/team">Community team</a> GitHub repository contains information about how the community team organizes.</li>
<li>The <a href="https://rustbridge.com">RustBridge</a> website contains information on hosting your own local RustBridge event.</li>
<li><a href="https://github.com/rust-lang/rustlings">Rustlings</a> is an project with small exercises designed around getting newcomers used to reading and writing Rust.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="state-of-rust-survey-faq"><a class="header" href="#state-of-rust-survey-faq">State of Rust Survey FAQ</a></h1>
<p>In this FAQ we try to answer common questions about the Annual State of the Rust Language Community Survey. If in your opinion there is a missing question or if you have a concern about this document, please do not hesitate to contact the <a href="community/community-team@rust-lang.org">Rust Community Team</a> or open an <a href="https://github.com/rust-community/team/issues">issue with the Community Team</a>.</p>
<h2 id="why-is-this-survey-important-for-the-rust-project"><a class="header" href="#why-is-this-survey-important-for-the-rust-project">Why is this survey important for the Rust project?</a></h2>
<p><a href="https://rust-lang.org">Rust</a> is an Open Source project. As such, we want to hear both from people inside and outside our ecosystem about the language, how it is perceived, and how we can make the language more accessible and our community more welcoming. This feedback will give our community the opportunity to participate on shaping the future of the project. We want to focus in the requirements of the language current and potential users to offer a compelling tool for them to solve real world problems in a safe, efficient and modern way.</p>
<h2 id="what-are-the-goals-of-the-survey"><a class="header" href="#what-are-the-goals-of-the-survey">What are the goals of the survey?</a></h2>
<ul>
<li>To understand the community's main development priorities and needs</li>
<li>To categorize the population of users of the language</li>
<li>To focus our efforts on events and conferences to drive more impact</li>
<li>To identify potential new contributors to the community goals</li>
</ul>
<h2 id="how-much-time-will-it-take-to-answer-the-survey"><a class="header" href="#how-much-time-will-it-take-to-answer-the-survey">How much time will it take to answer the survey?</a></h2>
<p>In average, it should take from 10 to 15 minutes.</p>
<h2 id="what-kind-of-questions-are-included-in-the-survey"><a class="header" href="#what-kind-of-questions-are-included-in-the-survey">What kind of questions are included in the survey?</a></h2>
<p>It includes some basic questions about how do responders use Rust, their opinion the ecosystem's tools and libraries, some basic questions regarding the responders' employer or organization and their intention to use Rust, technical background and demographic questions and some feedback related to the Rust project's community activities and general priorities.</p>
<h2 id="how-will-we-use-the-data-from-the-survey-responses"><a class="header" href="#how-will-we-use-the-data-from-the-survey-responses">How will we use the data from the survey responses?</a></h2>
<p>The answers from the survey will be anonymized, aggregated, and summarized. A high level writeup will be posted to https://blog.rust-lang.org.</p>
<h3 id="how-is-personally-identifiable-information-handled"><a class="header" href="#how-is-personally-identifiable-information-handled">How is personally identifiable information handled?</a></h3>
<p>Nearly every question in the survey is optional. You are welcome to share as much or as little information as you are comfortable with. Only the Rust language Core Team and the Community Team Survey Leads will have access to the raw data from the survey. All the answers are anonymized prior to be shared with the rest of the teams and prior to the results publication.</p>
<h3 id="why-is-the-survey-collecting-contact-information"><a class="header" href="#why-is-the-survey-collecting-contact-information">Why is the survey collecting contact information?</a></h3>
<p>The survey optionally collects contact information for the following cases if you expressed interest in:</p>
<ul>
<li>future conferences or meetups in your area</li>
<li>helping to organize a Rust event, meetup, or conference</li>
<li>talking to a Rust team about using Rust inside your company</li>
<li>Rust training</li>
<li>interest in a Rust team contacting you about your survey responses</li>
</ul>
<p>If you would like to be contacted about any of this, or any other concerns, but you don't want to associate your email with your survey responses, you can instead email the Rust Community Team at community-team@rust-lang.org or the Core Team at core-team@rust-lang.org, and we will connect you to the right people.</p>
<h2 id="where-and-when-is-the-survey-results-report-published"><a class="header" href="#where-and-when-is-the-survey-results-report-published">Where and when is the survey results report published?</a></h2>
<p>We expect to publish results from the survey within a month or two of the survey completion. The survey results will be posted to <a href="https://blog.rust-lang.org">project's blog</a>.</p>
<h2 id="where-can-i-see-the-previous-survey-reports"><a class="header" href="#where-can-i-see-the-previous-survey-reports">Where can I see the previous survey reports?</a></h2>
<ul>
<li><a href="https://blog.rust-lang.org/2018/11/27/Rust-survey-2018.html">State of Rust 2018</a></li>
<li><a href="https://blog.rust-lang.org/2017/09/05/Rust-2017-Survey-Results.html">State of Rust 2017</a></li>
<li><a href="https://blog.rust-lang.org/2016/06/30/State-of-Rust-Survey-2016.html">State of Rust 2016</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compiler"><a class="header" href="#compiler">Compiler</a></h1>
<p>This section documents the Rust compiler itself, its APIs, and how to
contribute and provide bug fixes for the compiler.</p>
<h3 id="external-links-2"><a class="header" href="#external-links-2">External Links</a></h3>
<ul>
<li>The <a href="https://rustc-dev-guide.rust-lang.org/">Rustc Dev Guide</a> documents how the compiler works as well providing helpful
information to help get new contributors involved in the development.</li>
<li>Rustc's <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_middle/">internal documentation</a>.</li>
<li>The <a href="https://rust-lang.github.io/compiler-team/">Compiler team</a> website is the home for all of the compiler
team's planning.</li>
<li>oli-obk's <a href="https://oli-obk.github.io/fixmeh/">FIXME page</a> lists all of the <code>FIXME</code> comments in the Rust compiler.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cross-compilation"><a class="header" href="#cross-compilation">Cross Compilation</a></h1>
<p>This subsection documents cross compiling your code on one platform to another.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="windows"><a class="header" href="#windows">Windows</a></h1>
<ol>
<li>Acquire LLD somehow. Either your distro provides it or you have to build it
from source.</li>
<li>You'll need an lld-link wrapper, which is just lld using the link flavor so
it accepts the same flags as link.exe. You may either have a binary called
lld-link, or you may have to write some sort of script to wrap lld.</li>
<li>If you want to be able to cross compile C/C++ as well, you will need to
obtain clang-cl, which is clang pretending to be cl.</li>
<li>You'll need libraries from an existing msvc installation on Windows to link
your Rust code against. You'll need the VC++ libraries from either VS 2015 or
VS 2017, and the system libraries from either the Windows 8.1 or Windows 10
SDK. Here are some approximate paths which may vary depending on the exact
version you have installed. Copy them over to your non-windows machine.
<ul>
<li>VS 2015: <code>C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\lib</code></li>
<li>VS 2017: <code>C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Tools\MSVC\14.10.24728\lib</code></li>
<li>Windows 10 SDK: <code>C:\Program Files (x86)\Windows Kits\10\Lib\10.0.14393.0</code></li>
<li>Windows 8.1 SDK: <code>C:\Program Files (x86)\Windows Kits\8.1\Lib\winv6.3</code></li>
</ul>
</li>
<li>If you want to cross compile C/C++ you'll also need headers. Replace <code>lib</code> in
the above paths with <code>include</code> to get the appropriate headers.</li>
<li>Set your LIB and INCLUDE environment variables to semicolon separated lists
of all the relevant directories for the correct architecture.</li>
<li>In your .cargo/config add <code>[target.x86_64-pc-windows-msvc] linker = &quot;lld-link&quot;</code>
or whatever your lld pretending to be link.exe is called.</li>
<li>For cross compiling C/C++, you'll need to get the gcc crate working
correctly. I never tested it to cross compile, I have no idea whether it will
even do anything sane.</li>
<li>Install the appropriate target using rustup and pass
<code>--target=x86_64-pc-windows-msvc</code> while building. Hopefully it works. If it
doesn't, well... I don't know.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cross-team-collaboration"><a class="header" href="#cross-team-collaboration">Cross-team Collaboration</a></h1>
<p>If you are a member of another team and would like to raise an issue with the
compiler team..</p>
<h2 id="for-discussion"><a class="header" href="#for-discussion">..for discussion</a></h2>
<p>Write a comment on a GitHub issue describing the reason for the nomination
(i.e. what decision needs to be made/what opinion is sought; what are the
relevant parts to the compiler team, etc) and add the <code>I-compiler-nominated</code>
label to a issue (you can include <code>@rustbot label +I-compiler-nominated</code> in
your comment to do this).</p>
<p>Once nominated, the issue will be discussed in a upcoming <a href="compiler/./triage-meeting.html">triage
meeting</a>. The compiler team doesn't always get through
all nominated issues each week, so it can take more than one meeting for your
issue to be discussed.</p>
<p>Once discussed, a member of the team will comment on the issue with the
conclusion of the discussion and linking to the relevant Zulip chat.</p>
<h2 id="to-be-fixed"><a class="header" href="#to-be-fixed">..to be fixed</a></h2>
<p>If there is an existing working relationship between a member of the requesting
team and a contributor to the compiler, then the first option that a team has
for requesting tasks be completed is to ping that contributor and ask if they
can complete the task. It is recommended that pings take place in public Zulip
channels so that..</p>
<ul>
<li>..other contributors that have free time have the opportunity to
offer their help.</li>
<li>..other compiler team members/leadership can ensure that requests being made
are reasonable (see the rest of this section for the types of issues that the
compiler team commits to prioritizing on behalf of other teams).</li>
</ul>
<p>It is worth considering the available bandwidth of the contributor that the
request is being made of, and whether their areas of expertise in the compiler
are relevant.</p>
<p>When there is not a appropriate contact in the compiler team to reach out to
directly, write a comment on a GitHub issue (or create an issue) describing the
task that needs completed. Teams should nominate issues for the compiler team
when issues..</p>
<ul>
<li>..are not already tracked by/part of an existing initiative or working group
and..</li>
<li>..are blocking/impeding the work of the other team (e.g. a feature or bug
preventing the stabilization of something otherwise complete), but..</li>
<li>..aren't absolutely mission-critical - a soundness bug or otherwise critical
issue will be prioritized by the <a href="compiler/./prioritization.html">prioritization working
group</a> and addressed through the compiler team's other
processes for these bugs. If the issue lacks a prioritization label, you can
add the <code>I-prioritize</code> label and it will be enqueued for prioritization.</li>
</ul>
<p>A detailed description of the feature being requested or the bug to be fixed is
helpful wherever possible (so that the compiler contributor does not need to
make a guess as to a solution that would solve the problem for the requesting
team). If a member of the requesting team isn't explicitly listed as the
point-of-contact for the issue, then the author of the comment will be assumed
to be the point-of-contact.</p>
<p>Add the <code>I-compiler-nominated</code> label to a issue (you can use <code>@rustbot label +I-compiler-nominated</code> to do this).</p>
<p>Once nominated, the issue will be discussed in a upcoming <a href="compiler/./triage-meeting.html">triage
meeting</a>. The compiler team doesn't always get through
all nominated issues each week, so it can take more than one meeting for your
issue to be discussed. In the compiler team's discussion, the issue may..</p>
<ul>
<li>..be accepted, in which case it will be assigned to a contributor and the
nomination label removed. Once assigned, a member of the team will work on
the issue. If no work is completed after a reasonable time, then re-nominate
the issue and the compiler team will find someone else to complete the work.</li>
<li>..or not accepted (e.g. due to insufficient bandwidth, other
critical/high-priority bugs, being unable to find an appropriate contributor,
or the issue lacking feasibility). In this case, the compiler team will reply
to the nomination with an explanation and will remove the nomination label.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="review-policies"><a class="header" href="#review-policies">Review policies</a></h1>
<p>Every PR that lands in the compiler and its associated crates must be
reviewed by at least one person who is knowledgeable with the code in
question.</p>
<p>When a PR is opened, you can request a reviewer by including <code>r? @username</code> in the PR description. If you don't do so, the highfive bot
will automatically assign someone.</p>
<p>It is common to leave a <code>r? @username</code> comment at some later point to
request review from someone else. This will also reassign the PR.</p>
<h2 id="bors"><a class="header" href="#bors">bors</a></h2>
<p>We never merge PRs directly. Instead, we use bors. A qualified
reviewer with bors privileges (e.g., a <a href="compiler/./membership.html">compiler
contributor</a>) will leave a comment like <code>@bors r+</code>.
This indicates that they approve the PR.</p>
<p>People with bors privileges may also leave a <code>@bors r=username</code>
command. This indicates that the PR was already approved by
<code>@username</code>. This is commonly done after rebasing.</p>
<p>Finally, in some cases, PRs can be &quot;delegated&quot; by writing <code>@bors delegate+</code> or <code>@bors delegate=username</code>. This will allow the PR author
to approve the PR by issuing <code>@bors</code> commands like the ones above
(but this privilege is limited to the single PR).</p>
<h2 id="rollups"><a class="header" href="#rollups">Rollups</a></h2>
<p>All reviewers are strongly encouraged to explicitly mark a PR as to whether or
not it should be part of a <a href="compiler/../release/rollups.html">rollup</a> with one of the following:</p>
<ul>
<li><code>rollup=always</code>: These PRs are very unlikely to break tests or have performance
implications. Example scenarios:
<ul>
<li>Changes are limited to documentation, comments, etc. that is highly
unlikely to fail a build.</li>
<li>Changes cannot have performance implications.</li>
<li>Your PR is not landing possibly-breaking or behavior altering changes.
<ul>
<li>Feature stabilization without other changes is likely fine to
rollup, though.</li>
</ul>
</li>
</ul>
</li>
<li><code>rollup=maybe</code>: This is the <strong>default</strong> if you do not specify a rollup
status. Use this if you don't have much confidence that it won't break
tests. This can be used if you aren't sure if it should be one of the other
categories. Since this is the default, there is usually no need to
explicitly specify this, unless you are un-marking the rollup level from a
previous command.</li>
<li><code>rollup=iffy</code>: Use this for mildly risky PRs (more risky than &quot;maybe&quot;).
Example scenarios:
<ul>
<li>The PR is large and non-additive (note: adding 2000 lines of completely
new tests is fine to rollup).</li>
<li>Messes too much with:
<ul>
<li>LLVM or code generation</li>
<li>bootstrap or the build system</li>
<li>build-manifest</li>
</ul>
</li>
<li>Has platform-specific changes that are not checked by the normal PR checks.</li>
<li>May be affected by MIR migrate mode.</li>
</ul>
</li>
<li><code>rollup=never</code>: This should <em>never</em> be included in a rollup (<strong>please</strong>
include a comment explaining why you have chosen this). Example scenarios:
<ul>
<li>May have performance implications.</li>
<li>May cause unclear regressions (we would likely want to bisect to this PR
specifically, as it would be hard to identify as the cause from a
rollup).</li>
<li>Has a high chance of failure.</li>
<li>Is otherwise dangerous to rollup.</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>Note</strong>:<br />
<code>@bors rollup</code> is equivalent to <code>@bors rollup=always</code><br />
<code>@bors rollup-</code> is equivalent to <code>@bors rollup=never</code></p>
</blockquote>
<h2 id="priority"><a class="header" href="#priority">Priority</a></h2>
<p>Reviewers are encouraged to set one of the rollup statuses listed above
instead of setting priority. Bors automatically sorts based on the rollup
status (never is the highest priority, always is the lowest), and also by PR
age. If you do change the priority, please use your best judgment to balance
fairness with other PRs.</p>
<p>The following is some guidance for setting priorities:</p>
<ul>
<li>1-5
<ul>
<li>P-high issue fixes</li>
<li>Toolstate fixes</li>
<li>Beta-nominated PRs</li>
<li>Submodule/Subtree updates</li>
</ul>
</li>
<li>5+
<ul>
<li>P-critical issue fixes</li>
</ul>
</li>
<li>10+
<ul>
<li>Bitrot-prone PRs (particularly very large ones that touch many files)</li>
<li>Urgent PRs</li>
<li>Beta backports</li>
</ul>
</li>
<li>20+
<ul>
<li>High priority that needs to jump ahead of any rollups</li>
<li>Fixes or changes something that has a high risk of being re-broken by
another PR in the queue.</li>
</ul>
</li>
<li>1000
<ul>
<li>Absolutely critical fixes</li>
<li>Release promotions</li>
</ul>
</li>
</ul>
<h2 id="expectations-for-r"><a class="header" href="#expectations-for-r">Expectations for r+</a></h2>
<p>bors privileges are binary: the bot doesn't know which code you are
familiar with and what code you are not. They must therefore be used
with discretion. Do not r+ code that you do not know well -- you can
definitely <strong>review</strong> such code, but try to hand off reviewing to
someone else for the final r+.</p>
<p>Similarly, never issue a <code>r=username</code> command unless that person has
done the review, and the code has not changed substantially since the
review was done.  Rebasing is fine, but changes in functionality
typically require re-review (though it's a good idea to try and
highlight what has changed, to help the reviewer).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="so-you-want-to-add-a-new-stable-option-to-rustc"><a class="header" href="#so-you-want-to-add-a-new-stable-option-to-rustc">So you want to add a new (stable) option to rustc</a></h1>
<p>So you want to add a new command-line flag to rustc. What is the procedure?</p>
<h2 id="is-this-a-perma-unstable-option"><a class="header" href="#is-this-a-perma-unstable-option">Is this a perma-unstable option?</a></h2>
<p>The first question to ask yourself is:</p>
<ul>
<li>Is this a &quot;perma-unstable&quot; option meant only for debugging rustc (e.g., <code>-Ztreat-err-as-bug</code>)?</li>
</ul>
<p>If so, you can just add it in a PR, no check-off is required beyond ordinary review.</p>
<h2 id="other-options"><a class="header" href="#other-options">Other options</a></h2>
<p>If this option is meant to be used by end-users or to be exposed on the stable channel, however, it represents a &quot;public commitment&quot; on the part of rustc that we will have to maintain, and hence there are a few more details to take care of.</p>
<p>There are two main things to take care of, and they can proceed in either order, but both must be completed:</p>
<ul>
<li>Proposal and check-off</li>
<li>Implementation and documentation</li>
</ul>
<p>Finally, some options begin as unstable and only get stabilized over time, in which case you will also need:</p>
<ul>
<li>Tracking issue and stabilization</li>
</ul>
<h3 id="proposal-and-check-off"><a class="header" href="#proposal-and-check-off">Proposal and check-off</a></h3>
<p>The &quot;proposal&quot; part describes the motivation and design of the new option you wish to add. It doesn't necessarily have to be very long. It takes the form of a <a href="https://forge.rust-lang.org/compiler/mcp.html">Major Change Proposal</a>.</p>
<p>The proposal should include the following:</p>
<ul>
<li><strong>Motivation:</strong> what is this flag used for?</li>
<li><strong>Design:</strong> What input does the flag take and what is its observable effect?</li>
<li><strong>Implementation notes:</strong> You don't have to talk about the implementation normally, but if there are any key things to note (i.e., it was very invasive to implement), you night note them here.</li>
<li><strong>Precedent, links, and related material:</strong> Are similar flags available on other compilers/linkers/tools, like clang or lld?</li>
<li><strong>Alternatives, concerns, and key decisions:</strong> Were there any alernatives considered? If so, why did you pick this design?</li>
</ul>
<p>Note that it is fine if you don't have any implementation notes, precedent, or alternatives to discuss.</p>
<p>Also, one good approach to writing the MCP is basically to write the documentation you will have to write anyway to explain to users how the option works, and then add any additional notes on alternatives and so forth that are required.</p>
<p>Once you've written up the proposal, you can <a href="https://github.com/rust-lang/compiler-team/issues/new?assignees=&amp;labels=major-change%2C+T-compiler&amp;template=major_change.md&amp;title=%28My+major+change+proposal%29">open a MCP</a> issue. But note that since this MCP is promoting a permanent change, a full compiler-team FCP is required, and not just a &quot;second&quot;. This can be done by <code>@rfcbot fcp merge</code> by a team member.</p>
<h3 id="implementation-documentation"><a class="header" href="#implementation-documentation">Implementation, documentation</a></h3>
<p>Naturally your new option will also have to be implemented. You can implement the option and open up a PR. Often, this implementation work actually happens <strong>before</strong> the MCP is created, and that's fine -- we'll just ask you to open an MCP with the write-up.</p>
<p>See the <a href="https://rustc-dev-guide.rust-lang.org/cli.html">Command-line Arguments</a> chapter in the rustc dev guide for guidelines on how to name and define a new argument.</p>
<p>A few notes that are sometimes overlooked:</p>
<ul>
<li>Many options begin as &quot;unstable&quot; options, either because they use <code>-Z</code> or because they require <code>-Zunstable-options</code> to use.</li>
<li>You should document the option. Often this documentation can just be copied from the MCP text. Where you add this documentation depends on whether the option is available on stable Rust:
<ul>
<li>If it is unstable, then document the option in the <a href="https://doc.rust-lang.org/nightly/unstable-book/index.html">Unstable Book</a>, whose sources are in <a href="https://github.com/rust-lang/rust/tree/master/src/doc/unstable-book">src/doc/unstable-book</a>.</li>
<li>Once the option is stabilized, it should be documented in the <a href="https://doc.rust-lang.org/rustc/index.html">Rustc book</a>, whose sources as in <a href="https://github.com/rust-lang/rust/tree/master/src/doc/rustc">src/doc/rustc</a>. </li>
</ul>
</li>
</ul>
<h2 id="stabilization-and-tracking-issue"><a class="header" href="#stabilization-and-tracking-issue">Stabilization and tracking issue</a></h2>
<p>Typically options begin as unstable, meaning that they are either used with <code>-Z</code> or require <code>-Zunstable-options</code>.</p>
<p>Once the issue lands we should create a tracking issue that links to the MCP and where stabilization can be proposed.</p>
<p>Stabilization generally proceeds when the option has a seen a bit of use and the implementation seems to be working as expected for its intended purpose.</p>
<p>Remember that when stabilization occurs, documentation should be moved from the Unstable Book to the Rustc Book.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="major-change-proposals"><a class="header" href="#major-change-proposals">Major Change Proposals</a></h1>
<p>Introduced in <a href="https://github.com/rust-lang/rfcs/blob/master/text/2904-compiler-major-change-process.md">RFC 2904</a>, a &quot;major change proposal&quot; is a lightweight
form of RFC that the compiler team uses for architectural changes that
are not end-user facing. (It can also be used for small user-facing
changes like adding new compiler flags, though in that case we also
require an <code>rfcbot fcp</code> to get full approval from the team.) Larger
changes or modifications to the Rust language itself require a full
RFC (the latter fall under the lang team's purview).</p>
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<p>As the compiler grows in complexity, it becomes harder and harder to track what's going on. We don't currently have a clear channel for people to signal their intention to make &quot;major changes&quot; that may impact other developers in a lightweight way (and potentially receive feedback).</p>
<p>Our goal is to create a channel for signaling intentions that lies somewhere between opening a PR (and perhaps cc'ing others on that PR) and creating a compiler team design meeting proposal or RFC.</p>
<h2 id="goals"><a class="header" href="#goals">Goals</a></h2>
<p>Our goals with the MCP are as follows:</p>
<ul>
<li>Encourage people making a major change to write at least a few paragraphs about what they plan to do.</li>
<li>Ensure that folks in the compiler team are aware the change is happening and given a chance to respond.</li>
<li>Ensure that every proposal has a &quot;second&quot;, meaning some expert from the team who thinks it's a good idea.</li>
<li>Ensure that major changes have an assigned and willing reviewer.</li>
<li>Avoid the phenomenon of large, sweeping PRs landing &quot;out of nowhere&quot; onto someone's review queue.</li>
<li>Avoid the phenomenon of PRs living in limbo because it's not clear what level of approval is required for them to land.</li>
</ul>
<h2 id="major-change-proposals-1"><a class="header" href="#major-change-proposals-1">Major Change Proposals</a></h2>
<p>If you would like to make a <a href="compiler/mcp.html#What-constitutes-a-major-change">major change</a> to the compiler, the process is as follows:</p>
<ul>
<li>Open a tracking issue on the <a href="https://github.com/rust-lang/compiler-team">rust-lang/compiler-team</a> repo using the <a href="https://github.com/rust-lang/compiler-team/issues/new?assignees=&amp;labels=major-change%2C+T-compiler&amp;template=major_change.md&amp;title=%28My+major+change+proposal%29">major change template</a>.
<ul>
<li>A Zulip topic in the stream <code>#t-compiler/major changes</code> will automatically be created for you by a bot.</li>
<li>If concerns are raised, you may want to modify the proposal to address those concerns.</li>
<li>Alternatively, you can submit a <a href="https://forge.rust-lang.org/compiler/steering-meeting.html">design meeting proposal</a> to have a longer, focused discussion.</li>
</ul>
</li>
<li>To be accepted, a major change proposal needs three things:
<ul>
<li>One or more <strong>reviewers</strong>, who commit to reviewing the work. This can be the person making the proposal, if they intend to mentor others.</li>
<li>A <strong>second</strong>, a member of the compiler team or a contributor who approves of the idea, but is not the one originating the proposal.</li>
<li>A <strong>final comment period</strong> (a 10 day wait to give people time to comment).
<ul>
<li>The FCP can be skipped if the change is easily reversed and/or further objections are considered unlikely. This often happens if there has been a lot of prior discussion, for example.</li>
</ul>
</li>
</ul>
</li>
<li>Once the FCP completes, if there are no outstanding concerns, PRs can start to land.
<ul>
<li>If those PRs make outward-facing changes that affect stable
code, then either the MCP or the PR(s) must be approved with a
<code>rfcbot fcp merge</code> comment.</li>
</ul>
</li>
</ul>
<h2 id="conditional-acceptance"><a class="header" href="#conditional-acceptance">Conditional acceptance</a></h2>
<p>Some major change proposals will be conditionally accepted. This indicates that we'd like to see the work land, but we'd like to re-evaluate the decision of whether to commit to the design after we've had time to gain experience. We should try to be clear about the things we'd like to evaluate, and ideally a timeline.</p>
<h2 id="deferred-or-not-accepted"><a class="header" href="#deferred-or-not-accepted">Deferred or not accepted</a></h2>
<p>Some proposals will not be accepted. Some of the possible reasons:</p>
<ul>
<li>You may be asked to do some prototyping or experimentation before a final decision is reached</li>
<li>The idea might be reasonable, but there may not be bandwidth to do the reviewing, or there may just be too many other things going on.</li>
<li>The idea may be good, but it may be judged that the resulting code would be too complex to maintain, and not worth the benefits.</li>
<li>There may be flaws in the idea or it may not sufficient benefit.</li>
</ul>
<h2 id="what-happens-if-someone-opens-a-pr-that-seems-like-a-major-change-without-doing-this-process"><a class="header" href="#what-happens-if-someone-opens-a-pr-that-seems-like-a-major-change-without-doing-this-process">What happens if someone opens a PR that seems like a major change <em>without</em> doing this process?</a></h2>
<p>The PR should be closed or marked as blocked, with a request to create
a major change proposal first.</p>
<p>If the PR description already contains suitable text that could serve
as an MCP, then simply copy and paste that into an MCP issue. Using an
issue consistently helps to ensure that the tooling and process works
smoothly.</p>
<h2 id="can-i-work-on-code-experimentally-before-a-mcp-is-accepted"><a class="header" href="#can-i-work-on-code-experimentally-before-a-mcp-is-accepted">Can I work on code experimentally before a MCP is accepted?</a></h2>
<p>Of course!  You are free to work on PRs or write code. But those PRs should be marked as experimental and they should not land, nor should anyone be expected to review them (unless folks want to).</p>
<h2 id="what-constitutes-a-major-change"><a class="header" href="#what-constitutes-a-major-change">What constitutes a major change?</a></h2>
<p>The rough intuition is &quot;something that would require updates to the <a href="https://rustc-dev-guide.rust-lang.org">rustc-dev-guide</a> or the <a href="https://doc.rust-lang.org/rustc/index.html">rustc book</a>&quot;. In other words:</p>
<ul>
<li>Something that alters the architecture of some part(s) of the compiler, since this is what the rustc-dev-guide aims to document.</li>
<li>A simple change that affects a lot of people, such as altering the names of very common types or changing coding conventions.</li>
<li>Adding a compiler flag or other public facing changes, which should be documented (ultimately) in the rustc book. This is only appropriate for &quot;minor&quot; tweaks, however, and not major things that may impact a lot of users. (Also, public facing changes will require a full FCP before landing on stable, but an MCP can be a good way to propose the idea.)</li>
</ul>
<p>Note that, in some cases, the change may be deemed <strong>too big</strong> and a full FCP or RFC may be required to move forward. This could occur with significant public facing change or with sufficiently large changes to the architecture. The compiler team leads can make this call.</p>
<p>Note that whether something is a major change proposal is not necessarily related to the number of lines of code that are affected. Renaming a method can affect a large number of lines, and even require edits to the rustc-dev-guide, but it may not be a major change. At the same time, changing names that are very broadly used could constitute a major change (for example, renaming from the <code>tcx</code> context in the compiler to something else would be a major change).</p>
<h2 id="public-facing-changes-require-rfcbot-fcp"><a class="header" href="#public-facing-changes-require-rfcbot-fcp">Public-facing changes require rfcbot fcp</a></h2>
<p>The MCP &quot;seconding&quot; process is only meant to be used to get agreement
on the technical architecture we plan to use. It is not sufficient to
stabilize new features or make public-facing changes like adding a -C
flag. For that, an <code>rfcbot fcp</code> is required (or perhaps an RFC, if the
change is large enough).</p>
<p>For landing compiler flags in particular, a good approach is to start
with an MCP introducing a <code>-Z</code> flag and then &quot;stabilize&quot; the flag by
moving it to <code>-C</code> in a PR later (which would require <code>rfcbot fcp</code>).</p>
<p>Major change proposals are not sufficient for language changes or
changes that affect cargo.</p>
<h2 id="steps-to-open-a-mcp"><a class="header" href="#steps-to-open-a-mcp">Steps to open a MCP</a></h2>
<ul>
<li>Open a tracking issue on the <a href="https://github.com/rust-lang/compiler-team">rust-lang/compiler-team</a> repo using the
<a href="https://github.com/rust-lang/compiler-team/issues/new?assignees=&amp;labels=major-change%2C+T-compiler&amp;template=major_change.md&amp;title=%28My+major+change+proposal%29">major change template</a>.</li>
<li>Create a Zulip topic in the stream <code>#t-compiler/major changes</code>:
<ul>
<li>The topic should be named something like &quot;modify the whiz-bang
component compiler-team#123&quot;, which describes the change and links
to the tracking issue.</li>
<li>The stream will be used for people to ask questions or propose changes.</li>
</ul>
</li>
</ul>
<h2 id="what-kinds-of-comments-should-go-on-the-tracking-issue-in-compiler-team-repo"><a class="header" href="#what-kinds-of-comments-should-go-on-the-tracking-issue-in-compiler-team-repo">What kinds of comments should go on the tracking issue in compiler-team repo?</a></h2>
<p>Please direct technical conversation to the Zulip stream.</p>
<p>The compiler-team repo issues are intended to be low traffic and used for procedural purposes. Note that to &quot;second&quot; a design or offer to review,  you should be someone who is familiar with the code, typically but not necessarily a compiler team member or contributor. </p>
<ul>
<li>Announcing that you &quot;second&quot; or approve of the design.</li>
<li>Announcing that you would be able to review or mentor the work.</li>
<li>Noting a concern that you don't want to be overlooked.</li>
<li>Announcing that the proposal will be entering FCP or is accepted.</li>
</ul>
<h2 id="how-does-one-register-as-reviewer-register-approval-or-raise-an-objection"><a class="header" href="#how-does-one-register-as-reviewer-register-approval-or-raise-an-objection">How does one register as reviewer, register approval, or raise an objection?</a></h2>
<p>These types of procedural comments can be left on the issue (it's also good to leave a message in Zulip). See the previous section.</p>
<h2 id="who-decides-whether-a-concern-is-unresolved"><a class="header" href="#who-decides-whether-a-concern-is-unresolved">Who decides whether a concern is unresolved?</a></h2>
<p>Usually the experts in the given area will reach a consensus here. But if there is some need for a &quot;tie breaker&quot; vote or judgment call, the compiler-team leads make the final call.</p>
<h2 id="what-are-some-examples-of-major-changes-from-the-past"><a class="header" href="#what-are-some-examples-of-major-changes-from-the-past">What are some examples of major changes from the past?</a></h2>
<p>Here are some examples of changes that were made in the past that would warrant the major change process:</p>
<ul>
<li>overhauling the way we encode crate metadata</li>
<li>merging the gcx, tcx arenas</li>
<li>renaming a widely used, core abstraction, such as the <code>Ty</code> type</li>
<li>introducing cargo pipelining </li>
<li>adding a new <code>-C</code> flag that exposes some minor variant</li>
</ul>
<h2 id="what-are-some-examples-of-things-that-are-too-big-for-the-major-change-process"><a class="header" href="#what-are-some-examples-of-things-that-are-too-big-for-the-major-change-process">What are some examples of things that are too big for the major change process?</a></h2>
<p>Here are some examples of changes that are too big for the major change process, or which at least would require auxiliary design meetings or a more fleshed out design before they can proceed:</p>
<ul>
<li>introducing incremental or the query system</li>
<li>introducing MIR or some new IR</li>
<li>introducing parallel execution</li>
<li>adding ThinLTO support</li>
</ul>
<h2 id="what-are-some-examples-of-things-that-are-too-small-for-the-major-change-process"><a class="header" href="#what-are-some-examples-of-things-that-are-too-small-for-the-major-change-process">What are some examples of things that are too small for the major change process?</a></h2>
<p>Here are some examples of things that don't merit any MCP:</p>
<ul>
<li>adding new information into metadata</li>
<li>fixing an ICE or tweaking diagnostics</li>
<li>renaming &quot;less widely used&quot; methods</li>
</ul>
<h2 id="when-should-major-change-proposals-be-closed"><a class="header" href="#when-should-major-change-proposals-be-closed">When should Major Change Proposals be closed?</a></h2>
<p>Major Change Proposals can be closed:</p>
<ul>
<li>by the author, if they have lost interest in pursuing it.</li>
<li>by a team lead or expert, if there are strong objections from key
members of the team that don't look likely to be overcome.</li>
<li>by folks doing triage, if there have been three months of
inactivity. In this case, people should feel free to re-open the
issue if they would like to &quot;rejuvenate&quot; it.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="membership"><a class="header" href="#membership">Membership</a></h1>
<p>This team discusses membership in the compiler team. There are currently two levels of membership:</p>
<ul>
<li><a href="https://www.rust-lang.org/governance/teams/compiler#compiler-contributors">contributors</a>: regular contributors with r+ rights, bot privileges, and access to <a href="compiler/../infra/index.html">infrastructure</a></li>
<li><a href="https://www.rust-lang.org/governance/teams/compiler">full members</a>: full members who vote on RFCs</li>
</ul>
<h2 id="the-path-to-membership"><a class="header" href="#the-path-to-membership">The path to membership</a></h2>
<p>People who are looking to contribute to the compiler typically start
in one of two ways. They may tackle &quot;one off&quot; issues, or they may get
involved in some kind of existing working group. They don't know much
about the compiler yet and have no particular privileges. They are
assigned to issues using the triagebot and (typically) work with a
mentor or mentoring instructions.</p>
<h2 id="compiler-team-contributors"><a class="header" href="#compiler-team-contributors">Compiler team contributors</a></h2>
<p>Once a working group participant has been contributing regularly for
some time, they can be promoted to the level of a <strong>compiler team
contributor</strong> (see the section on <a href="compiler/membership.html#how-promotion-decisions-are-made">how decisions are made</a>
below). This title indicates that they are someone who contributes
regularly.</p>
<p>It is hard to define the precise conditions when such a promotion is
appropriate. Being promoted to contributor is not just a function of
checking various boxes. But the general sense is that someone is ready
when they have demonstrated three things:</p>
<ul>
<li>&quot;Staying power&quot; -- the person should be contributing on a regular
basis in some way. This might for example mean that they have
completed a few projects.</li>
<li>&quot;Independence and familiarity&quot; -- they should be acting somewhat
independently when taking on tasks, at least within the scope of the
working group. They should plausibly be able to mentor others on simple
PRs.</li>
<li>&quot;Cordiality&quot; -- contributors will be members of the organization and
are held to a higher standard with respect to the <a href="https://www.rust-lang.org/policies/code-of-conduct">Code of
Conduct</a>. They should not only obey the letter of the CoC but
also its spirit.</li>
</ul>
<p>Being promoted to contributor implies a number of privileges:</p>
<ul>
<li>Contributors have r+ privileges and can do reviews (they are
expected to use those powers appropriately, as discussed
previously). They also have access to control perf/rustc-timer and
other similar bots.</li>
<li>Contributors are members of the organization so they can modify
labels and be assigned to issues.</li>
<li>Contributors are a member of the rust-lang/compiler team on GitHub,
so that they receive pings when people are looking to address the
team as a whole.</li>
<li>Contributors are listed on the rust-lang.org web page.</li>
</ul>
<p>It also implies some obligations (in some cases, optional obligations):</p>
<ul>
<li>Contributors will be asked if they wish to be added to highfive rotation.</li>
<li>Contributors are held to a higher standard than ordinary folk when
it comes to the <a href="https://www.rust-lang.org/policies/code-of-conduct">Code of Conduct</a>.</li>
</ul>
<h2 id="full-members"><a class="header" href="#full-members">Full members</a></h2>
<p>As a contributor gains in experience, they may be asked to become a
<strong>compiler team member</strong>. This implies that they are not only a
regular contributor, but are actively helping to shape the direction
of the team or some part of the compiler (or multiple parts).</p>
<ul>
<li>Compiler team members are the ones who select when people should be
promoted to compiler team contributor or to the level of member.</li>
<li>Compiler team members are consulted on FCP decisions (which, in the
compiler team, are relatively rare).</li>
<li>There will be a distinct GitHub team containing only the compiler
team members, but the name of this team is &quot;to be determined&quot;.</li>
<li>Working groups must always include at least one compiler team member
as a lead (though groups may have other leads who are not yet full
members).</li>
</ul>
<h2 id="how-promotion-decisions-are-made"><a class="header" href="#how-promotion-decisions-are-made">How promotion decisions are made</a></h2>
<p>Promotion decisions (from participant to contributor, and from
contributor to member) are made by having an active team member send
an e-mail to the alias <code>compiler-private@rust-lang.org</code>. This e-mail
should include:</p>
<ul>
<li>the name of the person to be promoted</li>
<li>a draft of the public announcement that will be made</li>
</ul>
<p>Compiler-team members should send e-mail giving their explicit assent,
or with objections. Objections should always be resolved before the
decision is made final. E-mails can also include edits or additions for the
public announcement.</p>
<p>To make the final decision:</p>
<ul>
<li>All objections must be resolved.</li>
<li>There should be a &quot;sufficient number&quot; (see below) of explicit
e-mails in favor of addition (including the team lead).</li>
<li>The nominator (or some member of the team) should reach out to the person
in question and check that they wish to join.</li>
</ul>
<p>We do not require all team members to send e-mail, as historically
these decisions are not particularly controversial. For promotion to a
contributor, the only requirement is that the compiler team lead
agrees. For promotion to a full member, more explicit mails in favor
are recommended.</p>
<p>Once we have decided to promote, then the announcement can be posted
to internals, and the person added to the team repository.</p>
<h2 id="not-just-code"><a class="header" href="#not-just-code">Not just code</a></h2>
<p>It is worth emphasizing that becoming a contributor or member of the
compiler team does not necessarily imply writing PRs. There are a wide
variety of tasks that need to be done to support the compiler and
which should make one eligible for membership. Such tasks would
include organizing meetings, participating in meetings, bisecting and
triaging issues, writing documentation, working on the rustc-dev-guide.
The most important criteria for elevation to contributor,
in particular, is <strong>regular and consistent</strong> participation. The most
important criteria for elevation to member is <strong>actively shaping the
direction of the team or compiler</strong>.</p>
<h2 id="alumni-status"><a class="header" href="#alumni-status">Alumni status</a></h2>
<p>If at any time a current contributor or member wishes to take a break
from participating, they can opt to put themselves into alumni status.
When in alumni status, they will be removed from Github aliases and
the like, so that they need not be bothered with pings and messages.
They will also not have r+ privileges. <strong>Alumni members will however
still remain members of the GitHub org overall.</strong></p>
<p>People in alumni status can ask to return to &quot;active&quot; status at any
time. This request would ordinarily be granted automatically barring
extraordinary circumstances.</p>
<p>People in alumni status are still members of the team at the level
they previously attained and they may publicly indicate that, though
they should indicate the time period for which they were active as
well.</p>
<h3 id="changing-back-to-contributor"><a class="header" href="#changing-back-to-contributor">Changing back to contributor</a></h3>
<p>If desired, a team member may also ask to move back to contributor
status. This would indicate a continued desire to be involved in
rustc, but that they do not wish to be involved in some of the
weightier decisions, such as who to add to the team. Like full alumni,
people who were once full team members but who went back to
contributor status may ask to return to full team member status. This
request would ordinarily be granted automatically barring
extraordinary circumstances.</p>
<h3 id="automatic-alumni-status-after-6-months-of-inactivity"><a class="header" href="#automatic-alumni-status-after-6-months-of-inactivity">Automatic alumni status after 6 months of inactivity</a></h3>
<p>If a contributor or a member has been inactive in the compiler for 6
months, then we will ask them if they would like to go to alumni
status. If they respond yes or do not respond, they can be placed on
alumni status.  If they would prefer to remain active, that is also
fine, but they will get asked again periodically if they continue to
be inactive.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prioritization"><a class="header" href="#prioritization">Prioritization</a></h1>
<p>This section documents the processes of the prioritization WG.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prioritization-wg---procedure"><a class="header" href="#prioritization-wg---procedure">Prioritization WG - Procedure</a></h1>
<p>This document details the procedure the WG-prioritization follows to fill the agenda for the weekly meeting of <code>T-compiler</code>.
The working group focuses mainly on triaging <code>T-compiler</code> and <code>T-libs</code> bugs, deciding if bugs are critical (potential release blockers) or not and building the agenda for the most important things <code>T-compiler</code> needs to discuss.</p>
<h2 id="general-issues-review-process"><a class="header" href="#general-issues-review-process">General issues review process</a></h2>
<ul>
<li>Check the status of the issue</li>
<li>Try moving it forward if possible (ex. stimulate further comments from the issue author or a reviewer)</li>
<li>Ask for more info if it's needed</li>
<li>Is there an MCVE for the issue already?</li>
<li>Check if it's a regression and label it accordingly (<code>regression-*</code> labels)</li>
<li>Figure out the area the issue belongs and label it accordingly (<code>A-*</code> labels)</li>
<li><a href="https://rustc-dev-guide.rust-lang.org/notification-groups/about.html">Ping notify groups</a> or relevant teams</li>
<li>Assign if possible</li>
<li>Nominate the issue if it needs to be discussed</li>
</ul>
<h2 id="the-procedure-in-detail"><a class="header" href="#the-procedure-in-detail">The procedure in detail</a></h2>
<p>High level overview:</p>
<ul>
<li><a href="compiler/prioritization/procedure.html#prepare-agenda-content">Prepare agenda content</a>
<ul>
<li>Add <code>T-compiler</code> and <code>T-libs</code> to unlabelled <code>T-compiler</code> and <code>T-libs</code> issues</li>
<li>Assign priority to unprioritized issues with <code>I-prioritize</code> label</li>
<li>Process MCPs/FCPs</li>
</ul>
</li>
<li><a href="compiler/prioritization/procedure.html#generate-agenda">Generate Agenda</a>
<ul>
<li>Run cli to generate agenda</li>
<li>Fill agenda announcements</li>
<li>Add performance logs</li>
</ul>
</li>
<li><a href="compiler/prioritization/procedure.html#notify-the-team-about-the-meeting">Notify the team about the meeting</a>
<ul>
<li>Figure out which WGs need to check-in</li>
<li>Notify @T-compiler/meeting about the meeting on Zulip</li>
</ul>
</li>
<li><a href="compiler/prioritization/procedure.html#add-details-to-the-agenda">Add details to the Agenda</a>
<ul>
<li>Summarize stable/beta nominations</li>
<li>Summarize PR's waiting on team</li>
<li>Summarize <code>P-critical</code> and unassigned <code>P-high</code> regressions</li>
<li>Summarize I-nominated issues</li>
</ul>
</li>
<li><a href="compiler/prioritization/procedure.html#final-reviews">Final reviews</a>
<ul>
<li>Nominate more issues if needed</li>
<li>Re-sync and check the agenda right before the meeting</li>
</ul>
</li>
</ul>
<p>Then, after the meeting (ideally the same day) there are are some <a href="compiler/prioritization/procedure.html#follow-ups-after-meeting">followup
tasks</a>:</p>
<ul>
<li>Remove <code>I-nominated</code> tags of already discussed issues</li>
<li>Accept or decline pull requests nominated for backport (according to the
meeting decisions)</li>
<li>Create the next meeting agenda using the weekly agenda template</li>
</ul>
<h3 id="follow-ups-after-meeting"><a class="header" href="#follow-ups-after-meeting">Follow ups after meeting</a></h3>
<ul>
<li>Remove <a href="https://github.com/rust-lang/compiler-team/issues?q=is%3Aall+label%3Amajor-change+label%3Ato-announce"><code>to-announce</code> MCPs</a>, only the ones that we've added to the agenda and not the ones that may have showed up between we've built the agenda and we execute this step.</li>
<li>Remove <code>to-announce</code> FCPs from <a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Afinished-final-comment-period+label%3Ato-announce">rust repo</a>, <a href="https://github.com/rust-lang/compiler-team/issues?q=is%3Aall+label%3Afinished-final-comment-period+label%3Ato-announce">compiler-team repo</a> and <a href="https://github.com/rust-lang/rust-forge/issues?q=is%3Aall+label%3Afinished-final-comment-period+label%3Ato-announce">forge repo</a>, only the ones that we've added to the agenda and not the ones that may have showed up between we've built the agenda and we execute this step.</li>
<li>Accept <a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Abeta-nominated+-label%3Abeta-accepted"><code>beta nominated</code></a> and <a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Astable-nominated+-label%3Astable-accepted"><code>stable nominated</code></a> backports that have been accepted during the meeting. For more info check <a href="https://forge.rust-lang.org/release/backporting.html">T-release backporting docs</a>
<ul>
<li>To accept, add <code>beta-accepted</code> and keep <code>beta-nominated</code> label for beta backports and add <code>stable-accepted</code> and keep <code>stable-nominated</code> label for stable backports.</li>
</ul>
</li>
<li>Decline <a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Abeta-nominated+-label%3Abeta-accepted"><code>beta nominated</code></a> and <a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Astable-nominated+-label%3Astable-accepted"><code>stable nominated</code></a> backports that have been declined during the meeting.
<ul>
<li>To decline, remove <code>beta-nominated</code> label for beta backports and remove <code>stable-nominated</code> label for stable backports.</li>
</ul>
</li>
<li>Remove <a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AI-nominated+label%3AT-compiler"><code>I-nominated</code></a> tags of already discussed issues. For that check previous week agenda and Zulip meeting</li>
<li>Create an empty agenda using <a href="https://hackmd.io/WQW0yzDDS16YvtBNurmj6A">our template</a>, as soon as our Thursday's weekly meeting ends. After creating the meeting change document permissions to Write -&gt; Owners.</li>
<li>Copy content from last week's agenda that is still pending. The relevant sections are <code>PRs waiting on team</code>, <code>P-critical</code>, <code>P-high regressions</code> and <code>Nominated issues</code>.</li>
<li>Notify WG leads about <a href="https://rust-lang.github.io/compiler-team/about/triage-meeting/">next week's
checkins</a></li>
</ul>
<h3 id="prepare-agenda-content"><a class="header" href="#prepare-agenda-content">Prepare agenda content</a></h3>
<h4 id="add-t-compiler-and-t-libs-labels"><a class="header" href="#add-t-compiler-and-t-libs-labels">Add <code>T-compiler</code> and <code>T-libs</code> labels</a></h4>
<p>Add <code>T-compiler</code> and <code>T-libs</code> labels to corresponding issues that are missing these labels.</p>
<ul>
<li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+is%3Aissue+-label%3AP-critical+-label%3AP-high+-label%3AP-medium+-label%3AP-low+label%3AI-prioritize+-label%3AT-compiler+-label%3AT-cargo+-label%3AT-core+-label%3AT-doc+-label%3AT-infra+-label%3AT-lang+-label%3AT-libs+-label%3AT-libs-api+-label%3AT-libs-api+-label%3AT-release+-label%3AT-rustdoc+-label%3AA-rustdoc+-label%3AA-rustdoc-ui">No team assigned unprioritized I-prioritize</a></li>
<li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Astable-nominated+-label%3Astable-accepted+-label%3AT-compiler+-label%3AT-cargo+-label%3AT-core+-label%3AT-doc+-label%3AT-infra+-label%3AT-lang+-label%3AT-libs+-label%3AT-libs-api+-label%3AT-libs-api+-label%3AT-release+-label%3AT-rustdoc+-label%3AA-rustdoc+-label%3AA-rustdoc-ui">No team assigned stable nominations</a></li>
<li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Abeta-nominated+-label%3Abeta-accepted+-label%3AT-compiler+-label%3AT-cargo+-label%3AT-core+-label%3AT-doc+-label%3AT-infra+-label%3AT-lang+-label%3AT-libs+-label%3AT-libs-api+-label%3AT-libs-api+-label%3AT-release+-label%3AT-rustdoc+-label%3AA-rustdoc+-label%3AA-rustdoc-ui">No team assigned beta nominations</a></li>
<li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AI-nominated+-label%3AT-compiler+-label%3AT-cargo+-label%3AT-core+-label%3AT-doc+-label%3AT-infra+-label%3AT-lang+-label%3AT-libs+-label%3AT-libs-api+-label%3AT-libs-api+-label%3AT-release+-label%3AT-rustdoc+-label%3AA-rustdoc+-label%3AA-rustdoc-ui">No team assigned I-nominated</a></li>
<li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AS-waiting-on-team+-label%3AT-compiler+-label%3AT-cargo+-label%3AT-core+-label%3AT-doc+-label%3AT-infra+-label%3AT-lang+-label%3AT-libs+-label%3AT-libs-api+-label%3AT-libs-api+-label%3AT-release+-label%3AT-rustdoc+-label%3AA-rustdoc+-label%3AA-rustdoc-ui">No team assigned PR's waiting on team</a></li>
</ul>
<h4 id="assign-priority-to-unprioritized-issues-with-i-prioritize-label"><a class="header" href="#assign-priority-to-unprioritized-issues-with-i-prioritize-label">Assign priority to unprioritized issues with <code>I-prioritize</code> label</a></h4>
<p>We need all <a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+is%3Aissue+label%3AT-compiler+-label%3AP-critical+-label%3AP-high+-label%3AP-medium+-label%3AP-low+label%3AI-prioritize"><code>I-prioritize T-compiler</code></a> and all <a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+is%3Aissue+label%3AT-libs+-label%3AP-critical+-label%3AP-high+-label%3AP-medium+-label%3AP-low+label%3AI-prioritize"><code>I-prioritize T-libs</code></a> to be actually prioritized. To do so, we add one of the <code>P-critical</code>, <code>P-high</code>, <code>P-medium</code> or <code>P-low</code> labels and remove <code>I-prioritize</code> and also add a text such as:</p>
<blockquote>
<p>Assigning <code>P-XXX</code> as <a href="compiler/prioritization/link_to_zulip_conversation">discussed as part of the Prioritization Working Group procedure</a> and removing <code>I-prioritize</code>.</p>
</blockquote>
<p>The procedure here follows the <a href="compiler/prioritization/procedure.html#general-issues-review-process">General issues review process</a>.</p>
<p>Note: triagebot automatically creates a topic and notify @<em>WG-prioritization</em> members once an issue is labelled with <code>I-prioritize</code></p>
<p>Note #2: These lists should typically be empty when we are close to the meeting.</p>
<p>Note #3: we should not have unprioritized regressions (<a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3Aregression-from-stable-to-stable+-label%3AP-critical+-label%3AP-high+-label%3AP-medium+-label%3AP-low+-label%3AT-infra+-label%3AT-libs+-label%3AT-release+-label%3AT-rustdoc">stable</a>, <a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3Aregression-from-stable-to-beta+-label%3AP-critical+-label%3AP-high+-label%3AP-medium+-label%3AP-low+-label%3AT-infra+-label%3AT-libs+-label%3AT-release+-label%3AT-rustdoc">beta</a> and <a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3Aregression-from-stable-to-nightly+-label%3AP-critical+-label%3AP-high+-label%3AP-medium+-label%3AP-low+-label%3AT-infra+-label%3AT-libs+-label%3AT-release+-label%3AT-rustdoc">nightly</a>) and ideally regressions should have an assignee.</p>
<h4 id="accept-mcps"><a class="header" href="#accept-mcps">Accept MCPs</a></h4>
<p>Accept all <a href="https://github.com/rust-lang/compiler-team/issues?q=is%3Aissue+is%3Aopen+label%3Amajor-change+label%3Afinal-comment-period">MCPs that have been on <code>final-comment-period</code></a> for 10 or more days. Basically check that <code>final-comment-period</code> label was added more than 10 days ago.
To accept, remove <code>final-comment-period</code>, add <code>major-change-accepted</code> and close the issue.</p>
<h3 id="generate-agenda"><a class="header" href="#generate-agenda">Generate Agenda</a></h3>
<h4 id="run-cli-to-generate-agenda"><a class="header" href="#run-cli-to-generate-agenda">Run cli to generate agenda</a></h4>
<p>Run triagebot's prioritization cli to generate the agenda.
For that you need to clone https://github.com/rust-lang/triagebot if you haven't done so already.
You need to export your <code>GITHUB_API_TOKEN</code> on Linux that's typically done by adding</p>
<p><code>export GITHUB_API_TOKEN=&lt;your key&gt;</code></p>
<p>to your <code>~/.profile</code> file.</p>
<p>And then run:</p>
<pre><code>$ cargo run --bin prioritization-agenda
</code></pre>
<p>Copy the content of the generated agenda into the agenda on HackMD.</p>
<h4 id="fill-agenda-announcements"><a class="header" href="#fill-agenda-announcements">Fill agenda announcements</a></h4>
<p>Check the compiler calendar to see if there's an outstanding event to announce and add it to the agenda.</p>
<h4 id="add-performance-logs"><a class="header" href="#add-performance-logs">Add performance logs</a></h4>
<p>Add <a href="https://github.com/rust-lang/rustc-perf/tree/master/triage#triage-logs">Triage Logs</a> to the agenda.</p>
<h3 id="notify-the-team-about-the-meeting"><a class="header" href="#notify-the-team-about-the-meeting">Notify the team about the meeting</a></h3>
<p>Create <code>[weekly meeting] YYYY-MM-DD #54818</code> topic in <code>#t-compiler/meetings</code> Zulip's stream and send the following messages:</p>
<pre><code class="language-text">Hi @*T-compiler/meeting*; the triage meeting will happen tomorrow at &lt;time:YYYY-MM-DDT14:00:00+00:00&gt;
*WG-prioritization* has done pre-triage in #**t-compiler/wg-prioritization/alerts**
@*WG-prioritization* has prepared the [meeting agenda](link_to_hackmd_agenda)
We will have checkins from *WG-X* and *WG-Y*
@**person1** do you have something you want to share about @*WG-X*?
@**person2** do you have something you want to share about @*WG-Y*?
</code></pre>
<h3 id="add-details-to-the-agenda"><a class="header" href="#add-details-to-the-agenda">Add details to the Agenda</a></h3>
<h4 id="summarize-stablebeta-nominations"><a class="header" href="#summarize-stablebeta-nominations">Summarize stable/beta nominations</a></h4>
<ul>
<li>Add them to the agenda explaining:
<ul>
<li>Who the author of the PR is</li>
<li>Who the assignee is</li>
<li>Which issue fixes, it is a regression? what's the priority?</li>
<li>Why was it nominated</li>
<li>Add other important details</li>
</ul>
</li>
</ul>
<p>Note: triagebot automatically creates a topic and notify @<em>WG-prioritization</em> members requesting addition to the agenda.</p>
<h4 id="summarize-prs-waiting-on-team"><a class="header" href="#summarize-prs-waiting-on-team">Summarize PR's waiting on team</a></h4>
<p>These are PRs waiting for some decision by our team (<code>T-compiler</code> or <code>T-libs</code>).</p>
<p>Try to follow the <a href="compiler/prioritization/procedure.html#general-issues-review-process">General issues review process</a>.</p>
<p>We should:</p>
<ul>
<li>Add them to the agenda explaining:
<ul>
<li>Who the author of the PR is</li>
<li>Who the assignee is</li>
<li>What is the issue waiting for</li>
<li>Add other important details</li>
</ul>
</li>
<li>Explicitly nominate any issue that can be <em>quickly</em> resolved in a triage meeting.</li>
</ul>
<p>Note: triagebot automatically creates a topic and notify @<em>WG-prioritization</em> members requesting addition to the agenda.</p>
<h4 id="summarize-p-critical-and-unassigned-p-high-regressions"><a class="header" href="#summarize-p-critical-and-unassigned-p-high-regressions">Summarize <code>P-critical</code> and unassigned <code>P-high</code> regressions</a></h4>
<p>Try to follow the <a href="compiler/prioritization/procedure.html#general-issues-review-process">General issues review process</a>.</p>
<p>We should:</p>
<ul>
<li>
<p><a href="https://rustc-dev-guide.rust-lang.org/notification-groups/about.html">Notify the appropriate groups</a></p>
</li>
<li>
<p>Push them forward, if possible</p>
</li>
<li>
<p>Assign if possible</p>
</li>
<li>
<p>Add <code>P-critical</code>s and unassigned <code>P-high</code>s to the agenda explaining:</p>
<ul>
<li>If it's assigned or not and to whom</li>
<li>Does it needs MCVE and/or bisection?</li>
<li>Are there identified culprits?</li>
<li>Do already have a PR open that fixes the issue?</li>
<li>Add other important details</li>
</ul>
</li>
</ul>
<p>Note: triagebot automatically creates a topic and notify @<em>WG-prioritization</em> members requesting addition to the agenda.</p>
<h4 id="summarize-i-nominated-issues"><a class="header" href="#summarize-i-nominated-issues">Summarize I-nominated issues</a></h4>
<p>Issues labeled with <code>I-nominated</code> are important issues that we decide deserve discussion during the weekly meeting.</p>
<p>Try to follow the <a href="compiler/prioritization/procedure.html#general-issues-review-process">General issues review process</a>.</p>
<p>We should:</p>
<ul>
<li>Check if these issues were already discussed and in that case remove <code>I-nominated</code> label</li>
<li>Check if each issue is worth being discussed</li>
<li>Add them to the agenda explaining:
<ul>
<li>Who the assignee is</li>
<li>Is this an issue or a PR: if an issue, does it have a PR that fixes it?</li>
<li>Why was it nominated</li>
<li>Add other important details</li>
</ul>
</li>
</ul>
<p>Note: triagebot automatically creates a topic and notify @<em>WG-prioritization</em> members requesting addition to the agenda.</p>
<h3 id="final-reviews"><a class="header" href="#final-reviews">Final reviews</a></h3>
<h4 id="nominate-more-issues-if-needed"><a class="header" href="#nominate-more-issues-if-needed">Nominate more issues if needed</a></h4>
<p>Check how packed the agenda looks like and if there's room for more nominations.</p>
<ul>
<li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+is%3Aissue+label%3AP-critical+-label%3AT-compiler+-label%3AT-libs">Other team's P-critical</a></li>
<li><a href="https://github.com/rust-lang/rust/issues?utf8=%E2%9C%93&amp;q=is%3Aopen+is%3Aissue+label%3AT-compiler+label%3AP-high+">T-compiler P-high</a></li>
<li><a href="https://github.com/rust-lang/rust/issues?utf8=%E2%9C%93&amp;q=is%3Aopen+is%3Aissue+label%3AT-libs+label%3AP-high+">T-libs P-high</a></li>
</ul>
<h4 id="re-sync-and-check-the-agenda-right-before-the-meeting"><a class="header" href="#re-sync-and-check-the-agenda-right-before-the-meeting">Re-sync and check the agenda right before the meeting</a></h4>
<p>Re-run the script and re-synchronize contents of the agenda with new information.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="priority-levels"><a class="header" href="#priority-levels">Priority levels</a></h1>
<p>As the compiler team's resources are limited, the prioritization working group's main goal is to identify the most relevant issues to work on, so that the compiler team can focus on what matters the most.</p>
<h2 id="words-used-in-this-document"><a class="header" href="#words-used-in-this-document">Words used in this document:</a></h2>
<p><code>issue</code> refers to bugs and feature requests that are nominated for prioritization, by flagging the <code>I-prioritize</code> label as described below.</p>
<p>This document will define what each label means, and what strategy for each label will be used.</p>
<h2 id="labels"><a class="header" href="#labels">Labels</a></h2>
<p>Labeling an issue as <code>I-prioritize</code> starts the prioritization process, which will end by removing the <code>I-prioritize</code> label and appending one of the 4 labels we will discuss below:</p>
<ul>
<li>P-critical</li>
<li>P-high</li>
<li>P-medium</li>
<li>P-low</li>
</ul>
<p>Each of these labels defines a strategy the team will adopt regarding:</p>
<ul>
<li>The amount of focus a given issue will receive</li>
<li>How members of the community can get involved</li>
</ul>
<h2 id="p-critical"><a class="header" href="#p-critical">P-critical</a></h2>
<p>A <code>P-critical</code> issue is a potentially blocker issue.</p>
<p>The Working Group will keep track of these issues and will remind the compiler team on a weekly basis during the triage meeting.</p>
<p>Examples of things we typically judge to be “critical” bugs:</p>
<ul>
<li>Regressions where code that used to compile no longer does
<ul>
<li>Mitigating conditions that may lower priority:
<ul>
<li>If the code should never have compiled in the first place (but if the regression affects a large number of crates, this may indicate that we need a warning period)</li>
<li>If the code in question is theoretical and considered unlikely to exist in the wild, or if it only exists in small, unmaintained packages that are not widely used</li>
</ul>
</li>
<li>If a regression has been in stable for a release or two (either because we are still awaiting a fix, or because the bug had laid dormant i.e. undetected), we typically lower the priority as well, because by that time, if the users have not raised a ruckus about the regression, that is a sign that it is inherently not a critical issue. Eg: <a href="https://rust-lang.zulipchat.com/#narrow/stream/227806-t-compiler.2Fwg-prioritization/topic/pre-meeting.20triage.202020-04-09.20.2354818">an issue that would have been P-critical but ended up being P-high</a></li>
</ul>
</li>
<li>Regressions where code still compiles but does something different than it used to do (dynamic semantics have changed)
<ul>
<li>Mitigating conditions that may lower priority:
<ul>
<li>If code uses feature that is explicitly not specified (e.g. <code>std::vec::Vec</code> docs state order in which it drops its elements is subject to change)</li>
</ul>
</li>
</ul>
</li>
<li>Feature-gated features accessible without a feature gate
<ul>
<li>Mitigating conditions that may lower priority:
<ul>
<li>If the pattern is VERY unlikely</li>
</ul>
</li>
</ul>
</li>
<li>Soundness holes with real-world implications
<ul>
<li>Mitigating conditions that may lower priority:
<ul>
<li>Soundness holes that are difficult to trigger</li>
<li>Soundness holes that will not affect stable, e.g. if the hole makes use of a gated unstable feature.</li>
</ul>
</li>
</ul>
</li>
<li>Diagnostic regressions where the diagnostic is very common and the situation very confusing</li>
<li>ICEs for common scenarios or code patterns
<ul>
<li>Mitigating conditions that may lower priority:
<ul>
<li>If the code that triggers the ICE also triggers compilation errors, and those errors are emitted before the ICE</li>
<li>If the code in question makes use of unstable features, particularly if the ICE requires a feature gate</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>A P-critical issue will receive the most attention. It must be assigned one or several people as soon as possible, and the rest of the team should do their best to help them out if/when applicable.</p>
<h2 id="p-high"><a class="header" href="#p-high">P-high</a></h2>
<p><code>P-high</code> issues are issues that need attention from the compiler team, but not to the point that they need to be discussed at every meeting.
They can be <code>P-critical</code> issues that have a mitigating condition as defined above, or important issues that aren't deemed blockers.</p>
<p>Because there are too many <code>P-high</code> issues to fit in every compiler meeting, they should rather be handled asynchronously by the Prioritization WG, in order to help them move forward. They can still occasionally be brought up at meetings when it is deemed necessary.</p>
<p>The effectiveness of the Prioritization WG will be a direct consequence of our ability to draw the line between <code>P-critical</code> and <code>P-high</code> issues. There shouldn't be too many <code>P-critical</code> issues that compiler meetings become unmanageable, but critical issues shouldn't get lost in the list of P-high issues.</p>
<p>P-high issues are issues the teams will mostly work on. We want to make sure they're assigned, and keep an eye on them.</p>
<h2 id="p-medium-and-p-low"><a class="header" href="#p-medium-and-p-low">P-medium and P-low</a></h2>
<p><code>P-medium</code> refer to issues that aren't a priority for the team, and that will be resolved in the long run. Eg issues that will be fixed after a specific feature has landed.
They are issues we would mentor someone interested in fixing. 
They will remain in this state until someone complains, a community member fixes it, or it gets fixed by accident.</p>
<p><code>P-low</code> refer to issues issue that the compiler team doesn't plan to resolve, but are still worth fixing.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="notification-groups"><a class="header" href="#notification-groups">Notification groups</a></h1>
<p>The compiler team has a number of notification groups that we use to
ping people and draw their attention to issues. Notification groups
are setup so that anyone can join them if they want.</p>
<h2 id="creating-a-notification-group"><a class="header" href="#creating-a-notification-group">Creating a notification group</a></h2>
<p>If you'd like to create a notification group, here are the steps.
First, you want to get approval from the compiler team:</p>
<ul>
<li>Propose the group by preparing a <a href="compiler/./mcp.html">Major Change Proposal</a>. If
your group is not analogous to some existing group, it is probably
a good idea to ping compiler team leads before-hand or as part of
the MCP.</li>
<li>The MCP should specify what GitHub label will be associated with the
notification group. Often this is an existing label, such as
<code>O-Windows</code>.</li>
</ul>
<p>Once the MCP is accepted, here are the steps to actually create the group.
In some cases we include an example PR from some other group.</p>
<ul>
<li>File a tracking issue in the <a href="https://github.com/rust-lang/compiler-team">rust-lang/compiler-team</a> repository to collect
your progress.</li>
<li>Create a PR against the <a href="https://github.com/rust-lang/team">rust-lang/team</a> repository adding the notification
group. <a href="https://github.com/rust-lang/team/pull/347">Example PR.</a></li>
<li>Configure the <a href="https://github.com/rust-lang/rust">rust-lang/rust</a> repository to accept triagebot commands
for this group. <a href="https://github.com/rust-lang/rust/pull/72706">Example PR.</a></li>
<li>Create a PR for the rustc-dev-guide amending <a href="https://rustc-dev-guide.rust-lang.org/notification-groups/about.html">the notification group
section</a>
to mention your group.</li>
<li>Create a sample PR for the <a href="https://github.com/rust-lang/team">rust-lang/team</a> repository showing how one can add
oneself. This will be referenced by your blog post to show people how to
join. <a href="https://github.com/rust-lang/team/pull/140">Example PR.</a></li>
<li>Create a Zulip stream for the notification group. If you don't have the permission
to do, you can ask on <a href="https://rust-lang.zulipchat.com/#narrow/stream/185694-t-compiler.2Fwg-meta">#t-compiler/wg-meta</a>.</li>
<li>Write an announcement blog post for Inside Rust and open a PR against
<a href="https://github.com/rust-lang/blog.rust-lang.org">blog.rust-lang.org</a>.
<a href="https://github.com/rust-lang/blog.rust-lang.org/pull/615">Example PR.</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compiler-team-triage-meeting"><a class="header" href="#compiler-team-triage-meeting">Compiler-team Triage Meeting</a></h1>
<h2 id="what-is-it"><a class="header" href="#what-is-it">What is it?</a></h2>
<p>The triage meeting is a weekly meeting where we go over the open
issues, look at regressions, consider beta backports, and other such
business. In the tail end of the meeting, we also do brief check-ins
with active working groups to get an idea what they've been working
on.</p>
<h2 id="when-and-where-is-it"><a class="header" href="#when-and-where-is-it">When and where is it?</a></h2>
<p>See the <a href="https://rust-lang.github.io/compiler-team/#meeting-calendar">compiler team meeting calendar</a> for the canonical date and
time. The meetings take place in the #t-compiler stream on the
<a href="https://rust-lang.github.io/compiler-team/about/chat-platform/">rust-lang Zulip</a>.</p>
<h2 id="where-can-i-lean-more"><a class="header" href="#where-can-i-lean-more">Where can I lean more?</a></h2>
<p>The meeting procedure is documented in <a href="https://github.com/rust-lang/rust/issues/54818">rust-lang/rust#54818</a>.</p>
<p>The working group check-in schedule is available on the <a href="https://rust-lang.github.io/compiler-team/about/triage-meeting/">compiler-team website</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compiler-team-steering-meeting"><a class="header" href="#compiler-team-steering-meeting">Compiler-team Steering Meeting</a></h1>
<h2 id="what-is-it-1"><a class="header" href="#what-is-it-1">What is it?</a></h2>
<p>The &quot;steering meeting&quot; is a weekly meeting dedicated to planning and
high-level discussion. The meeting operates on a repeating schedule:</p>
<ul>
<li>Week 1: Planning</li>
<li>Week 2: Technical or non-technical discussion</li>
<li>Week 3: Technical or non-technical discussion</li>
<li>Week 4: Non-technical discussion</li>
</ul>
<p>The first meeting of the 4-week cycle is used for <strong>planning</strong>. The
primary purpose of this meeting is to <strong>select the topics for the next
three meetings</strong>. The topics are selected from a set of topic
proposals, which must be uploaded and available for perusal before the
meeting starts. The planning meeting is also an opportunity to check
on the &quot;overall balance&quot; of our priorities.</p>
<p>The remaining meetings are used for design or general discussion.
Weeks 2 and 3 can be used for <strong>technical</strong> or <strong>non-technical</strong>
discussion; it is also possible to use both weeks to discuss the same
topic, if that topic is complex. <strong>Week 4 is reserved for
non-technical topics</strong>, so as to ensure that we are keeping an eye on
the overall health and functioning of the team.</p>
<h3 id="where-do-proposals-come-from"><a class="header" href="#where-do-proposals-come-from">Where do proposals come from?</a></h3>
<p>The team accepts proposals via an open submission process,
which is documented on <a href="compiler/steering-meeting/submit.html">its own page</a></p>
<h2 id="announcing-the-schedule"><a class="header" href="#announcing-the-schedule">Announcing the schedule</a></h2>
<p>After each planning meeting, the topics for the next three weeks are
added to the <a href="https://rust-lang.github.io/compiler-team/#meeting-calendar">compiler-team meeting calendar</a> and a blog post is
posted to the <a href="https://blog.rust-lang.org/inside-rust/">Inside Rust blog</a>.</p>
<h2 id="when-and-where-is-it-1"><a class="header" href="#when-and-where-is-it-1">When and where is it?</a></h2>
<p>See the <a href="https://rust-lang.github.io/compiler-team/#meeting-calendar">compiler team meeting calendar</a> for the canonical date and
time. The meetings take place in the #t-compiler stream on the
<a href="https://rust-lang.zulipchat.com">rust-lang Zulip</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="submitting-a-proposal"><a class="header" href="#submitting-a-proposal">Submitting a proposal</a></h1>
<p>If you would like to submit a proposal to the steering meeting for
group discussion, read on! This page has all the details.</p>
<h2 id="tldr"><a class="header" href="#tldr">TL;DR</a></h2>
<p>In short, all you have to do is</p>
<ul>
<li><a href="https://github.com/rust-lang/compiler-team/issues">open an issue on the compiler-team repository</a>
<ul>
<li>use the template for meeting proposals</li>
<li>you only need a few sentences to start, but by the time the meeting
takes place we typically expect a more detailed writeup, e.g.
using <a href="https://github.com/rust-lang/compiler-team/blob/master/templates/steering-meeting-proposal.md">this template</a></li>
</ul>
</li>
</ul>
<p>You don't have to have a lot of details to start: just a few sentences
is enough. But, especially for technical design discussions, we will
typically expect that some form of more detailed overview be made
available by the time the meeting takes place.</p>
<h2 id="examples-of-good-candidates-for-discussing-at-the-steering-meeting"><a class="header" href="#examples-of-good-candidates-for-discussing-at-the-steering-meeting">Examples of good candidates for discussing at the steering meeting</a></h2>
<p>Here are some examples of possible technical topics that would be
suitable for the steering meeting:</p>
<ul>
<li>A working group has an idea to refactor the HIR to make some part of their
job easier. They have sketched out a proposal and would like feedback.</li>
<li>Someone has encountered a problem that is really hard to solve with
the existing data structures. They would like feedback on a good
solution to their problem.</li>
<li>Someone has done major refactoring work on a PR and they would like
to be able to explain the work they did and request review.</li>
</ul>
<p>Steering meetings are also a good place to discuss other kinds of proposals:</p>
<ul>
<li>A proposal to move some part of the compiler into an out-of-tree crate.</li>
<li>A proposal to start a new working group.</li>
</ul>
<p>Note that a steering meeting is <strong>not</strong> required to create a new
working group or an out-of-tree crate, but it can be useful if the
proposal is complex or controversial, and you would like a dedicated
time to talk out the plans in more detail.</p>
<h2 id="criteria-for-selection"><a class="header" href="#criteria-for-selection">Criteria for selection</a></h2>
<p>When deciding the topics for upcoming meetings, we must balance a number of things:</p>
<ul>
<li>We don't want to spend time on design work unless there are known
people who will implement it and support it; this includes not only
the &quot;main coder&quot; but also a suitable reviewer.</li>
<li>We don't want to take on &quot;too many&quot; tasks at once, even if there <em>are</em> people to
implement them.</li>
<li>We also don't want to have active projects that will be &quot;stepping on
each others' toes&quot;, changing the same set of code in deep ways.</li>
</ul>
<h2 id="meetings-are-not-mandatory"><a class="header" href="#meetings-are-not-mandatory">Meetings are not mandatory</a></h2>
<p>It is perfectly acceptable to choose <em>not</em> to schedule a particular
slot. This could happen if (e.g.) there are no proposals available or
if nothing seems important enough to discuss at this moment.  Note
that, to keep the &quot;time expectations&quot; under control, we should
generally stick to the same 4-week cycle and simply opt to skip
meetings, rather than (e.g.) planning things at the last minute.</p>
<h2 id="adding-a-proposal"><a class="header" href="#adding-a-proposal">Adding a proposal</a></h2>
<p>Proposals can be added by opening an issue on the <a href="https://github.com/rust-lang/compiler-team/issues">compiler-team
repository</a>. There is an issue template for meeting
proposals that gives directions. The basic idea is that you open an
issue with a few sentences describing what you would like to talk
about.</p>
<p>Some details that might be useful to include:</p>
<ul>
<li>how complex of a topic you think this is</li>
<li>people in the compiler team that you think should be present for the meeting</li>
</ul>
<h3 id="expectations-for-the-meeting"><a class="header" href="#expectations-for-the-meeting">Expectations for the meeting</a></h3>
<p>By the time the meeting takes place, we generally would prefer to have
a more detailed write-up or proposal. You can find a <a href="https://github.com/rust-lang/compiler-team/blob/master/templates/steering-meeting-proposal.md">template</a> for
such a proposal here. This should be created in the form of a hackmd
document -- usually we will then update this document with the minutes
and consensus from the meeting. The final notes are then stored in the
<a href="https://github.com/rust-lang/compiler-team/tree/master/content/minutes">minutes</a> directory of the compiler-team repository.</p>
<h3 id="expectations-for-a-non-technical-proposal"><a class="header" href="#expectations-for-a-non-technical-proposal">Expectations for a non-technical proposal</a></h3>
<p><strong>The requirements for non-technical proposals are somewhat looser.</strong>  A
few sentences or paragraphs may well suffice, if it is sufficient to
understand the aims of the discussion.</p>
<h2 id="frequently-asked-questions"><a class="header" href="#frequently-asked-questions">Frequently asked questions</a></h2>
<p><strong>What happens if there are not enough proposals?</strong> As noted above,
meetings are not mandatory. If there aren't enough proposals in some
particular iteration, then we can just opt to not discuss anything.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-run-the-planning-meeting"><a class="header" href="#how-to-run-the-planning-meeting">How to run the planning meeting</a></h1>
<h2 id="week-of-the-meeting"><a class="header" href="#week-of-the-meeting">Week of the meeting</a></h2>
<ul>
<li>Announce the meeting in the triage meeting</li>
<li>Skim over the list of proposals and ping people who have open
proposals to get their availability over the next few weeks</li>
</ul>
<h2 id="day-of-the-meeting"><a class="header" href="#day-of-the-meeting">Day of the meeting</a></h2>
<ul>
<li>Create a <code>design meeting YYYY.MM.DD</code> topic
<ul>
<li>Ping <code>@t-compiler/meeting</code>, ideally 1h or so before the meeting actually starts,
to remind people</li>
</ul>
</li>
<li>At the time of the meeting, return to the topic
<ul>
<li>Ping <code>@t-compiler/meeting</code> to let people know the meeting is starting</li>
</ul>
</li>
<li>We typically begin with a 5min announcement period</li>
<li>Visit the <a href="compiler/steering-meeting/XXX">compiler-team</a> repository to get a list of proposed meetings</li>
</ul>
<p>To actually make the final selection, we recommend</p>
<ul>
<li>First, try to identify topics that are clear non-candidates
<ul>
<li>for example, sometimes more investigative work (e.g., data gathering) is needed</li>
<li>try to identify people to do those tasks</li>
<li>other issues may be out of date, or clear non-starters, and they can be closed</li>
</ul>
</li>
<li>Next tackle technical design meetings, then non-technical
<ul>
<li>Typical ratio is 2 technical, 1 non-technical, but this is not set in stone</li>
<li>It's ok to have fewer than 3 meetings</li>
</ul>
</li>
</ul>
<h2 id="announce-the-meetings"><a class="header" href="#announce-the-meetings">Announce the meetings</a></h2>
<p>For each scheduled meeting, create a calendar event:</p>
<ul>
<li>invite key participants to the meeting</li>
<li>set the location to <code>#t-compiler, Zulip</code></li>
<li>include a link to the design meeting issue in the event</li>
</ul>
<p>In the relevant issues, add the <code>meeting-scheduled</code> label and add a
message like:</p>
<pre><code>In today's [planning meeting], we decided to schedule this meeting for **DATE**.

[Calendar event]

[planning meeting]: XXX link to Zulip topic
[Calendar event]: XXX link to calendar event
</code></pre>
<p>You can get the link to the calendar event by clicking on the event in
google calendar and selecting &quot;publish&quot;.</p>
<h2 id="publish-a-blog-post"><a class="header" href="#publish-a-blog-post">Publish a blog post</a></h2>
<p>Add a blog post to the Inside Rust blog using the <a href="https://github.com/rust-lang/compiler-team/blob/master/templates/planning-meeting-blog-post.md">template found on
the compiler-team repository</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-run-the-design-meeting"><a class="header" href="#how-to-run-the-design-meeting">How to run the design meeting</a></h1>
<h2 id="week-of-the-meeting-1"><a class="header" href="#week-of-the-meeting-1">Week of the meeting</a></h2>
<ul>
<li>Announce the meeting in the triage meeting</li>
<li>Skim over the list of proposals and ping people who have open
proposals to get their availability over the next few weeks</li>
<li>Make sure that a write-up is available and nag the meeting person otherwise</li>
</ul>
<h2 id="day-of-the-meeting-1"><a class="header" href="#day-of-the-meeting-1">Day of the meeting</a></h2>
<ul>
<li>Create a <code>design meeting YYYY.MM.DD</code> topic
<ul>
<li>Ping <code>@t-compiler/meeting</code>, ideally 1h or so before the meeting actually starts,
to remind people</li>
<li>Include a link to the design meeting write-up</li>
</ul>
</li>
<li>At the time of the meeting, return to the topic
<ul>
<li>Ping <code>@t-compiler/meeting</code> to let people know the meeting is starting</li>
<li>Include a link to the design meeting write-up</li>
</ul>
</li>
<li>We typically begin with a 5min announcement period</li>
</ul>
<p>To guide the meeting, create a shared hackmd document everyone can
view (or adapt an existing one, if there is a write-up). Use this to
help structure the meeting, document consensus, and take live
notes. Try to ensure that the meeting ends with sort of consensus
statement, even if that consensus is just &quot;here are the problems, here
is a space of solutions and their pros/cons, but we don't have
consensus on which solution to take&quot;.</p>
<h2 id="after-the-meeting"><a class="header" href="#after-the-meeting">After the meeting</a></h2>
<ul>
<li>Post the final contents of the summary hackmd as minutes to the
<a href="https://github.com/rust-lang/compiler-team/tree/master/content/minutes/design-meeting"><code>minutes/design-meeting</code> directory in the compiler-team
repository</a></li>
<li>(Optional) Create an Inside Rust blog post pointing people at the
minutes and maybe giving a few notes</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cratesio"><a class="header" href="#cratesio">crates.io</a></h1>
<p>This section documents the processes of the crates.io team.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="crate-removal-procedure"><a class="header" href="#crate-removal-procedure">Crate removal procedure</a></h1>
<p>If we get a DMCA takedown notice, here's what needs to happen:</p>
<h2 id="contact-legal"><a class="header" href="#contact-legal">Contact Legal</a></h2>
<p>Before removing the crates, get in touch with legal support, currently by
emailing the Core team, and ask an opinion from them on the received request and
whether we have to comply with it.</p>
<h2 id="remove-relevant-versions-andor-entire-crates-from-cratesio"><a class="header" href="#remove-relevant-versions-andor-entire-crates-from-cratesio">Remove relevant version(s) and/or entire crates from crates.io</a></h2>
<ul>
<li>
<p>Remove it from the database:</p>
<pre><code>heroku run -a crates-io -- target/release/crates-admin delete-crate [crate-name]
</code></pre>
<p>or</p>
<pre><code>heroku run -a crates-io -- target/release/crates-admin delete-version [crate-name] [version-number]
</code></pre>
</li>
<li>
<p>Remove the crate or version from the index. To remove an entire crate, remove
the entire crate file. For a version, remove the line corresponding to the
relevant version.</p>
</li>
<li>
<p>Remove the crate archive(s) and readme file(s) from S3.</p>
</li>
<li>
<p>Invalidate the CloudFront cache:</p>
<pre><code>aws cloudfront create-invalidation --distribution-id EJED5RT0WA7HA --paths '/*'
</code></pre>
</li>
</ul>
<h2 id="remove-entire-crates-from-docsrs"><a class="header" href="#remove-entire-crates-from-docsrs">Remove entire crates from docs.rs</a></h2>
<p>The docs.rs application supports deleting all the documentation ever published
of a crate, by running a CLI command. The people who currently have permissions
to access the server and run it are:</p>
<ul>
<li>docs.rs Team:
<ul>
<li><a href="https://github.com/pietroalbini">@pietroalbini</a></li>
<li><a href="https://github.com/jyn514">@jyn514</a></li>
</ul>
</li>
<li>Infrastructure Team:
<ul>
<li><a href="https://github.com/Mark-Simulacrum">@Mark-Simulacrum</a></li>
</ul>
</li>
<li>People with elevated 1password access</li>
</ul>
<p>You can find the documentation on how to run the command <a href="https://forge.rust-lang.org/infra/docs/docs-rs.html#removing-a-crate-from-the-website">here</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="database-maintenance"><a class="header" href="#database-maintenance">Database maintenance</a></h1>
<p>There are times when Heroku needs to perform a maintenance on our database
instances, for example to apply system updates or upgrade to a newer database
server.</p>
<p>We must <strong>not</strong> let Heroku run maintenances during the maintenance window to
avoid disrupting production users (move the maintenance window if necessary).
This page contains the instructions on how to perform the maintenance with the
minimum amount of disruption.</p>
<h1 id="primary-database"><a class="header" href="#primary-database">Primary database</a></h1>
<p>Performing maintenance on the primary database requires us to temporarily put
the application in read-only mode. Heroku performs maintenances by creating a
hidden database follower and switching over to it, so we need to prevent writes
on the primary to let the follower catch up.</p>
<p>Maintenance should take less than 5 minutes of read-only time, but we should
still announce it ahead of time on our status page. This is a sample message we
can use:</p>
<blockquote>
<p>The crates.io team will perform a database maintenance on YYYY-MM-DD from
hh:mm to hh:mm UTC.</p>
<p>We expect this to take less than 5 minutes to complete. During maintenance
crates.io will only be available in read-only mode: downloading crates and
visiting the website will still work, but logging in, publishing crates,
yanking crates or changing owners will not work.</p>
</blockquote>
<h2 id="primary-database-checklist"><a class="header" href="#primary-database-checklist">Primary database checklist</a></h2>
<p><strong>1 hour before the maintenance</strong></p>
<ol>
<li>Go into the Heroku Scheduler and disable the job enqueueing the downloads
count updater. You can &quot;disable&quot; it by changing its schedule not to run
during the maintenance window. The job uses a lot of database resources, and
we should not run it during maintenance.</li>
</ol>
<p><strong>5 minutes before the maintenance</strong></p>
<ol start="2">
<li>
<p>Scale the background worker to 0 instances:</p>
<pre><code>heroku ps:scale -a crates-io background_worker=0
</code></pre>
</li>
</ol>
<p><strong>At the start of the maintenance</strong></p>
<ol start="3">
<li>
<p>Update the status page with this message:</p>
<blockquote>
<p>Scheduled maintenance on our database is starting.</p>
<p>We expect this to take less than 5 minutes to complete. During maintenance
crates.io will only be available in read-only mode: downloading crates and
visiting the website will still work, but logging in, publishing crates,
yanking crates or changing owners will not work.</p>
</blockquote>
</li>
<li>
<p>Configure the application to be in read-only mode without the follower:</p>
<pre><code>heroku config:set -a crates-io READ_ONLY_MODE=1 DB_OFFLINE=follower
</code></pre>
<p>The follower is removed because while Heroku tries to prevent connections to
the primary database from failing during maintenance we observed that the
same does not apply to the follower database, and there could be brief
periods while the follower is not available.</p>
</li>
<li>
<p>Wait for the application to be redeployed with the new configuration:</p>
<pre><code>heroku ps:wait -a crates-io
</code></pre>
</li>
<li>
<p>Run the database maintenance:</p>
<pre><code>heroku pg:maintenance:run --force -a crates-io
</code></pre>
</li>
<li>
<p>Wait for the maintenance to finish:</p>
<pre><code>heroku pg:wait -a crates-io
</code></pre>
</li>
<li>
<p>Confirm all the databases are online:</p>
<pre><code>heroku pg:info -a crates-io
</code></pre>
</li>
<li>
<p>Confirm the primary database fully recovered (should output <code>false</code>):</p>
<pre><code>echo &quot;SELECT pg_is_in_recovery();&quot; | heroku pg:psql -a crates-io DATABASE
</code></pre>
</li>
<li>
<p>Switch off read-only mode:</p>
<pre><code>heroku config:unset -a crates-io READ_ONLY_MODE
</code></pre>
<p><strong>WARNING:</strong> the Heroku Dashboard's UI is misleading when removing an
environment variable. A red badge with a &quot;-&quot; (minus) in it means the
variable was <em>successfully removed</em>, it doesn't mean removing the variable
failed.  Failures are indicated with a red badge with a &quot;x&quot; (cross) in it.</p>
</li>
<li>
<p>Wait for the application to be redeployed with the new configuration:</p>
<pre><code>heroku ps:wait -a crates-io
</code></pre>
</li>
<li>
<p>Update the status page and mark the maintenance as completed with this
message:</p>
<blockquote>
<p>Scheduled maintenance finished successfully.</p>
</blockquote>
<p>The message is posted right now and not at the end because this is when
production users are not impacted by the maintenance anymore.</p>
</li>
<li>
<p>Scale the background worker up again:</p>
<pre><code>heroku ps:scale -a crates-io background_worker=1
</code></pre>
</li>
<li>
<p>Confirm the follower database is available:</p>
<pre><code>echo &quot;SELECT 1;&quot; | heroku pg:psql -a crates-io READ_ONLY_REPLICA
</code></pre>
</li>
<li>
<p>Enable connections to the follower:</p>
<pre><code>heroku config:unset -a crates-io DB_OFFLINE
</code></pre>
</li>
<li>
<p>Re-enable the background job disabled during step 1.</p>
</li>
</ol>
<h1 id="follower-database"><a class="header" href="#follower-database">Follower database</a></h1>
<p>Performing maintenance on the follower database doesn’t require any external
communication nor putting the application in read-only mode, as we can just
redirect all of the follower’s traffic to the primary database. It shouldn’t be
done during peak traffic periods though, as we’ll increase the primary database
load by doing this.</p>
<h2 id="follower-database-checklist"><a class="header" href="#follower-database-checklist">Follower database checklist</a></h2>
<p><strong>At the start of the maintenance</strong></p>
<ol>
<li>
<p>Configure the application to operate without the follower:</p>
<pre><code>heroku config:set -a crates-io DB_OFFLINE=follower
</code></pre>
</li>
<li>
<p>Wait for the application to be redeployed with the new configuration:</p>
<pre><code>heroku ps:wait -a crates-io
</code></pre>
</li>
<li>
<p>Start the database maintenance:</p>
<pre><code>heroku pg:maintenance:run --force -a crates-io READ_ONLY_REPLICA
</code></pre>
</li>
<li>
<p>Wait for the maintenance to finish:</p>
<pre><code>heroku pg:wait -a crates-io READ_ONLY_REPLICA
</code></pre>
</li>
<li>
<p>Confirm the follower database is ready:</p>
<pre><code>heroku pg:info -a crates-io
</code></pre>
</li>
<li>
<p>Confirm the follower database is responding to queries:</p>
<pre><code>echo &quot;SELECT 1;&quot; | heroku pg:psql -a crates-io READ_ONLY_REPLICA
</code></pre>
</li>
<li>
<p>Enable connections to the follower:</p>
<pre><code>heroku config:unset -a crates-io DB_OFFLINE
</code></pre>
</li>
<li>
<p>Wait for the application to be redeployed with the new configuration.</p>
<pre><code>heroku ps:wait -a crates-io
</code></pre>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="docsrs"><a class="header" href="#docsrs">docs.rs</a></h1>
<p><a href="https://docs.rs/">docs.rs</a> is a website that hosts documentation for crates published to <a href="https://crates.io/">crates.io</a>.</p>
<h2 id="external-links-3"><a class="header" href="#external-links-3">External Links</a></h2>
<ul>
<li>Source code: <a href="https://github.com/rust-lang/docs.rs">rust-lang/docs.rs</a></li>
<li>Hosted on: <code>docsrs.infra.rust-lang.org</code> (behind the bastion -- <a href="https://forge.rust-lang.org/infra/docs/bastion.html#logging-into-servers-through-the-bastionmd#logging-into-servers-through-the-bastion">how to connect</a>)</li>
<li>Maintainers: <a href="https://www.rust-lang.org/governance/teams/dev-tools#docs-rs">docs.rs team</a></li>
<li><a href="https://grafana.rust-lang.org/d/rpXrFfKWz/instance-metrics?orgId=1&amp;var-instance=docsrs.infra.rust-lang.org:9100">Instance metrics</a> (only available to infra team members).</li>
<li><a href="https://grafana.rust-lang.org/d/-wWFg2cZz/docs-rs?orgId=1">Application metrics</a> (only available to infra team members).</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="add-a-dependency-to-the-build-environment"><a class="header" href="#add-a-dependency-to-the-build-environment">Add a dependency to the build environment</a></h1>
<p>Rustwide internally uses <code>rustops/crates-build-env</code> as the build environment for the crate. If you want to add a system package for crates to link to, this is place you're looking for.</p>
<h2 id="preconditions"><a class="header" href="#preconditions">Preconditions</a></h2>
<p>Docker and docker-compose must be installed. For example, on Debian or Ubuntu:</p>
<pre><code class="language-sh">sudo apt-get install docker.io docker-compose
</code></pre>
<h2 id="getting-started-2"><a class="header" href="#getting-started-2">Getting started</a></h2>
<p>First, clone the crates-build-env and the docs.rs repos:</p>
<pre><code class="language-sh">git clone https://github.com/rust-lang/crates-build-env
git clone https://github.com/rust-lang/docs.rs
</code></pre>
<p>Set the path to the directory of your crate. This must be an absolute path, not a relative path! On platforms with coreutils, you can instead use <code>$(realpath ../relative/path)</code> (relative to the docs.rs directory).</p>
<pre><code class="language-sh">YOUR_CRATE=/path/to/your/crate
</code></pre>
<h2 id="add-package"><a class="header" href="#add-package">Add package</a></h2>
<p>Next, add the package to <code>crates-build-env/linux/packages.txt</code> in the correct alphabetical order. This should be the name of a package in the <strong>Ubuntu 20.04</strong> Repositories. See <a href="https://packages.ubuntu.com/">the package home page</a> for a full list/search bar, or use <code>apt search</code> locally.</p>
<h2 id="building-the-image"><a class="header" href="#building-the-image">Building the image</a></h2>
<p>Now build the image. This will take a very long time, probably 10-20 minutes.</p>
<pre><code class="language-sh">cd crates-build-env/linux
docker build --tag build-env .
</code></pre>
<h2 id="testing-the-image"><a class="header" href="#testing-the-image">Testing the image</a></h2>
<p>Use the image to build your crate.</p>
<pre><code class="language-sh">cd ../../docs.rs
cp .env.sample .env
docker-compose build
# avoid docker-compose creating the volume if it doesn't exist
if [ -e &quot;$YOUR_CRATE&quot; ]; then
  docker-compose run -e DOCSRS_DOCKER_IMAGE=build-env \
                     -e RUST_BACKTRACE=1 \
                     -v &quot;$YOUR_CRATE&quot;:/opt/rustwide/workdir \
    web build crate --local /opt/rustwide/workdir
else
  echo &quot;$YOUR_CRATE does not exist&quot;;
fi
</code></pre>
<h2 id="making-multiple-changes"><a class="header" href="#making-multiple-changes">Making multiple changes</a></h2>
<p>If your build fails even after your changes, it will be annoying to rebuild the image from scratch just to add a single package. Instead, you can make changes directly to the Dockerfile so that the existing packages are cached. Be sure to move these new packages from the Dockerfile to <code>packages.txt</code> once you are sure they work.</p>
<p>On line 7 of the Dockerfile, add this line: <code>RUN apt-get install -y your_second_package</code>.
Rerun the build and start the container; it should take much less time now:</p>
<pre><code class="language-sh">cd ../crates-build-env/linux
docker build --tag build-env .
cd ../../docs.rs
docker-compose run -e DOCSRS_DOCKER_IMAGE=build-env \
                     -e RUST_BACKTRACE=1 \
                     -v &quot;$YOUR_CRATE&quot;:/opt/rustwide/workdir \
    web build crate --local /opt/rustwide/workdir
</code></pre>
<h2 id="run-the-lint-script"><a class="header" href="#run-the-lint-script">Run the lint script</a></h2>
<p>Before you make a PR, run the shell script <code>lint.sh</code> and make sure it passes. It ensures <code>packages.txt</code> is in order and will tell you exactly what changes you need to make if not.</p>
<pre><code class="language-sh">cd ../crates-build-env
./lint.sh
</code></pre>
<h2 id="make-a-pull-request"><a class="header" href="#make-a-pull-request">Make a pull request</a></h2>
<p>Once you are sure your package builds, you can make a pull request to get it adopted upstream for docs.rs and crater. Go to https://github.com/rust-lang/crates-build-env and click 'Fork' in the top right. Locally, add your fork as a remote in git and push your changes:</p>
<pre><code class="language-sh">git remote add personal https://github.com/&lt;your_username_here&gt;/crates-build-env
git add -u
git commit -m 'add packages necessary for &lt;your_package_here&gt; to compile'
git push personal
</code></pre>
<p>Back on github, make a pull request:</p>
<ol>
<li>Go to https://github.com/rust-lang/crates-build-env/compare</li>
<li>Click 'compare across forks'</li>
<li>Click 'head repository' -&gt; &lt;your_username&gt;/crates-build-env</li>
<li>Click 'Create pull request'</li>
<li>Add a description of what packages you added and what crate they fixed</li>
<li>Click 'Create pull request' again in the bottom right.</li>
</ol>
<p>Hopefully your changes will be merged quickly! After that you can either publish a point release (rebuilds your docs immediately) or request for a member of the docs.rs team to schedule a new build (may take a while depending on their schedules).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="self-hosting-a-docsrs-instance"><a class="header" href="#self-hosting-a-docsrs-instance">Self hosting a docs.rs instance</a></h1>
<p>These are instructions for deploying the server in a production environment. For instructions on developing locally without docker-compose, see <a href="docs-rs/no-docker-compose.html">Developing without docker-compose</a>.</p>
<p>Here is a breakdown of what it takes to turn a regular server into its own version of docs.rs.</p>
<p>Beware: This process is rather rough! Attempts at cleaning it up, automating setup components, etc, would be greatly appreciated!</p>
<h2 id="requirements"><a class="header" href="#requirements">Requirements</a></h2>
<p>The commands and package names on this page will assume an Ubuntu server running systemd, but hopefully the explanatory text should give enough information to adapt to other systems. Note that docs.rs depends on the host being <code>x86_64-unknown-linux-gnu</code>.</p>
<p>Docs.rs has a few basic requirements:</p>
<ul>
<li>Rust (preferably via <code>rustup</code>)</li>
<li>Git</li>
<li>CMake, GCC, G++, and <code>pkg-config</code> (to build dependencies for crates and docs.rs itself)</li>
<li>OpenSSL, zlib, curl, and <code>libmagic</code> (to link against)</li>
<li>PostgreSQL</li>
<li>LXC tools (doc builds run inside an LXC container)</li>
</ul>
<pre><code class="language-console">$ curl https://sh.rustup.rs -sSf | sh -s -- -y --default-toolchain nightly
$ source $HOME/.cargo/env
# apt install build-essential git curl cmake gcc g++ pkg-config libmagic-dev libssl-dev zlib1g-dev postgresql lxc-utils
</code></pre>
<h2 id="the-cratesfyi-user"><a class="header" href="#the-cratesfyi-user">The <code>cratesfyi</code> user</a></h2>
<p>To help things out later on, we can create a new unprivileged user that will run the server process. This user will own all the files required by the docs.rs process. This user will need to be able to run <code>lxc-attach</code> through <code>sudo</code> to be able to run docs builds, so give it a sudoers file at the same time:</p>
<pre><code class="language-console"># adduser --disabled-login --disabled-password --gecos &quot;&quot; cratesfyi
# echo 'cratesfyi  ALL=(ALL) NOPASSWD: /usr/bin/lxc-attach' &gt; /etc/sudoers.d/cratesfyi
</code></pre>
<p>(The name <code>cratesfyi</code> is a historical one: Before the site was called &quot;docs.rs&quot;, it was called &quot;crates.fyi&quot; instead. If you want to update the name of the user, feel free! Just be aware that the name <code>cratesfyi</code> will be used throughout this document.)</p>
<h2 id="the-prefix-directory"><a class="header" href="#the-prefix-directory">The &quot;prefix&quot; directory</a></h2>
<p>In addition to the LXC container, docs.rs also stores several related files in a &quot;prefix&quot; directory. This directory can be stored anywhere, but the <code>cratesfyi</code> user needs to be able to access it:</p>
<pre><code class="language-console"># mkdir /cratesfyi-prefix
# chown cratesfyi:cratesfyi /cratesfyi-prefix
</code></pre>
<p>Now we can set up some required folders. To make sure they all have proper ownership, run them all as <code>cratesfyi</code>:</p>
<pre><code class="language-console">$ sudo -u cratesfyi mkdir -vp /cratesfyi-prefix/documentations /cratesfyi-prefix/public_html /cratesfyi-prefix/sources
$ sudo -u cratesfyi git clone https://github.com/rust-lang/crates.io-index.git /cratesfyi-prefix/crates.io-index
$ sudo -u cratesfyi git --git-dir=/cratesfyi-prefix/crates.io-index/.git branch crates-index-diff_last-seen
</code></pre>
<p>(That last command is used to set up the <code>crates-index-diff</code> crate, so we can start monitoring new crate releases.)</p>
<h2 id="lxc-container"><a class="header" href="#lxc-container">LXC container</a></h2>
<p>To help contain what crates' build scripts can access, documentation builds run inside an LXC container. To create one inside the prefix directory:</p>
<pre><code class="language-console"># LANG=C lxc-create -n cratesfyi-container -P /cratesfyi-prefix -t download -- --dist ubuntu --release bionic --arch amd64
# ln -s /cratesfyi-prefix/cratesfyi-container /var/lib/lxc
# chmod 755 /cratesfyi-prefix/cratesfyi-container
# chmod 755 /var/lib/lxc
</code></pre>
<p>(To make deployment simpler, it's important that the OS the container is using is the same as the host! In this case, the host is assumed to be running 64-bit Ubuntu 18.04. If you make the container use a different release or distribution, you'll need to build docs.rs separately inside the container when deploying.)</p>
<p>You'll also need to configure networking for the container. The following is a sample <code>/etc/default/lxc-net</code> that enables NAT networking for the container:</p>
<pre><code>USE_LXC_BRIDGE=&quot;true&quot;
LXC_BRIDGE=&quot;lxcbr0&quot;
LXC_ADDR=&quot;10.0.3.1&quot;
LXC_NETMASK=&quot;255.255.255.0&quot;
LXC_NETWORK=&quot;10.0.3.0/24&quot;
LXC_DHCP_RANGE=&quot;10.0.3.2,10.0.3.254&quot;
LXC_DHCP_MAX=&quot;253&quot;
LXC_DHCP_CONFILE=&quot;&quot;
LXC_DOMAIN=&quot;&quot;
</code></pre>
<p>In addition, you'll need to set the container's configuration to use this. Add the following lines to <code>/cratesfyi-prefix/cratesfyi-container/config</code>:</p>
<pre><code>lxc.net.0.type = veth
lxc.net.0.link = lxcbr0
</code></pre>
<p>Now you can reload the LXC network configuration, start up the container, and set it up to auto-start when the host boots:</p>
<pre><code class="language-console"># systemctl restart lxc-net
# systemctl enable lxc@cratesfyi-container.service
# systemctl start lxc@cratesfyi-container.service
</code></pre>
<p>Now we need to do some setup <em>inside</em> this container. You can either copy all these commands so that each one attaches on its own, or you can run <code>lxc-console -n cratesfyi-container</code> to open a root shell inside the container and skip the <code>lxc-attach</code> prefix.</p>
<pre><code class="language-console"># lxc-attach -n cratesfyi-container -- apt update
# lxc-attach -n cratesfyi-container -- apt upgrade
# lxc-attach -n cratesfyi-container -- apt install curl ca-certificates binutils gcc libc6-dev libmagic1 pkg-config build-essential
</code></pre>
<p>Inside the container, we also need to set up a <code>cratesfyi</code> user, and install Rust for it. In addition to the base Rust installation, we also need to install all the default targets so that we can build docs for all the Tier 1 platforms. The Rust compiler installed inside the container is the one that builds all the docs, so if you want to use a new Rustdoc feature, this is the compiler to update.</p>
<pre><code class="language-console">lxc-attach -n cratesfyi-container -- adduser --disabled-login --disabled-password --gecos &quot;&quot; cratesfyi
lxc-attach -n cratesfyi-container -- su - cratesfyi -c 'curl https://sh.rustup.rs -sSf | sh -s -- -y --default-toolchain nightly'
lxc-attach -n cratesfyi-container -- su - cratesfyi -c 'rustup target add i686-apple-darwin'
lxc-attach -n cratesfyi-container -- su - cratesfyi -c 'rustup target add i686-pc-windows-msvc'
lxc-attach -n cratesfyi-container -- su - cratesfyi -c 'rustup target add i686-unknown-linux-gnu'
lxc-attach -n cratesfyi-container -- su - cratesfyi -c 'rustup target add x86_64-apple-darwin'
lxc-attach -n cratesfyi-container -- su - cratesfyi -c 'rustup target add x86_64-pc-windows-msvc'
</code></pre>
<p>Now that we have Rust installed inside the container, we can use a trick to give the <code>cratesfyi</code> user on the <em>host</em> the same Rust compiler as the <em>container</em>. By symlinking the following directories into its user directory, we don't need to track a <em>third</em> toolchain.</p>
<pre><code class="language-console">for directory in .cargo .rustup .multirust; do  [[ -h /home/cratesfyi/$directory ]] || sudo -u cratesfyi ln -vs /var/lib/lxc/cratesfyi-container/rootfs/home/cratesfyi/$directory /home/cratesfyi/; done
</code></pre>
<h2 id="environment-for-the-cratesfyi-user"><a class="header" href="#environment-for-the-cratesfyi-user">Environment for the <code>cratesfyi</code> user</a></h2>
<p>To ensure that the docs.rs server is configured properly, we need to set a few environment variables. The primary ones are going into a separate environment file, so we can load them into the systemd service that will manage the server.</p>
<p>Write the following into <code>/home/cratesfyi/.cratesfyi.env</code>. If you have a GitHub access token that the site can use to collect repository information, add it here, but otherwise leave it blank. The variables need to exist, but they can be blank to skip that collection.</p>
<pre><code>CRATESFYI_PREFIX=/cratesfyi-prefix
CRATESFYI_DATABASE_URL=postgresql://cratesfyi:password@localhost
CRATESFYI_CONTAINER_NAME=cratesfyi-container
CRATESFYI_GITHUB_USERNAME=
CRATESFYI_GITHUB_ACCESSTOKEN=
RUST_LOG=cratesfyi
</code></pre>
<p>Now add the following to <code>/home/cratesfyi/.profile</code>:</p>
<pre><code class="language-sh">export $(cat $HOME/.cratesfyi.env | xargs -d '\n')
export PATH=&quot;$HOME/.cargo/bin:$PATH&quot;
export PATH=&quot;$PATH:$HOME/docs.rs/target/release&quot;
</code></pre>
<h2 id="docsrs-build"><a class="header" href="#docsrs-build">Docs.rs build</a></h2>
<p>Now we can actually clone and build the docs.rs source! The location of it doesn't matter much, but again, we want it to be owned by <code>cratesfyi</code> so it can build and run the final executable. In addition, we copy the built <code>cratesfyi</code> binary into the container so that it can be used to arrange builds on the inside.</p>
<pre><code class="language-console">sudo -u cratesfyi git clone https://github.com/rust-lang-nursery/docs.rs.git ~cratesfyi/docs.rs
sudo su - cratesfyi -c 'cd ~/docs.rs &amp;&amp; cargo build --release'
cp -v /home/cratesfyi/docs.rs/target/release/cratesfyi /var/lib/lxc/cratesfyi-container/rootfs/usr/local/bin
</code></pre>
<h2 id="postgresql"><a class="header" href="#postgresql">PostgreSQL</a></h2>
<p>Now that we have the repository built, we can use it to set up the database. Docs.rs uses a Postgres database to store information about crates and their documentation. To set one up, we first need to ask Postgres to create the database, and then run the docs.rs command to create the initial tables and content:</p>
<pre><code class="language-console">sudo -u postgres sh -c &quot;psql -c \&quot;CREATE USER cratesfyi WITH PASSWORD 'password';\&quot;&quot;
sudo -u postgres sh -c &quot;psql -c \&quot;CREATE DATABASE cratesfyi OWNER cratesfyi;\&quot;&quot;
sudo su - cratesfyi -c &quot;cd ~/docs.rs &amp;&amp; cargo run --release -- database init&quot;
sudo su - cratesfyi -c &quot;cd ~/docs.rs &amp;&amp; cargo run --release -- build add-essential-files&quot;
sudo su - cratesfyi -c &quot;cd ~/docs.rs &amp;&amp; cargo run --release -- build crate rand 0.5.5&quot;
sudo su - cratesfyi -c &quot;cd ~/docs.rs &amp;&amp; cargo run --release -- database update-search-index&quot;
sudo su - cratesfyi -c &quot;cd ~/docs.rs &amp;&amp; cargo run --release -- database update-release-activity&quot;
</code></pre>
<h2 id="server-configuration"><a class="header" href="#server-configuration">Server configuration</a></h2>
<p>We're almost there! At this point, we've got all the pieces in place to run the site. Now we can set up a systemd service that will run the daemon that will collect crate information, orchestrate builds, and serve the website. The following systemd service file can be placed in <code>/etc/systemd/system/cratesfyi.service</code>:</p>
<pre><code class="language-systemd">[Unit]
Description=Cratesfyi daemon
After=network.target postgresql.service

[Service]
User=cratesfyi
Group=cratesfyi
Type=forking
PIDFile=/cratesfyi-prefix/cratesfyi.pid
EnvironmentFile=/home/cratesfyi/.cratesfyi.env
ExecStart=/home/cratesfyi/docs.rs/target/release/cratesfyi daemon
WorkingDirectory=/home/cratesfyi/docs.rs

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Enabling and running that will serve the website on <code>http://localhost:3000</code>, so if you want to route public traffic to it, you'll need to set up something like nginx to proxy the connections to it.</p>
<h2 id="updating-rust"><a class="header" href="#updating-rust">Updating Rust</a></h2>
<p>If you want to update the Rust compiler used to build crates (and the Rustdoc that comes with it), you need to make sure you don't interrupt any existing crate builds. The daemon waits for 60 seconds between checking for new crates, so you need to make sure you catch it during that window. Since we hooked the daemon into systemd, the logs will be available in its journal. Running <code>journalctl -efu cratesfyi</code> (it may need to be run as root if nothing appears) will show the latest log output and show new entries as they appear. You're looking for a message like &quot;Finished building new crates, going back to sleep&quot; or &quot;Queue is empty, going back to sleep&quot;, which indicates that the crate-building thread is waiting.</p>
<p>To prevent the queue from building more crates, run the following:</p>
<pre><code class="language-console">sudo su - cratesfyi -c &quot;cd ~/docs.rs &amp;&amp; cargo run --release -- build lock&quot;
</code></pre>
<p>This will create a lock file in the prefix directory that will prevent more crates from being built. At this point, you can update the rustc inside the container and add the rustdoc static files to the database:</p>
<pre><code class="language-console">lxc-attach -n cratesfyi-container -- su - cratesfyi -c 'rustup update'
sudo su - cratesfyi -c &quot;cd ~/docs.rs &amp;&amp; cargo run --release -- build add-essential-files&quot;
</code></pre>
<p>Once this is done, you can unlock the queue to allow crates to build again:</p>
<pre><code class="language-console">sudo su - cratesfyi -c &quot;cd ~/docs.rs &amp;&amp; cargo run --release -- build unlock&quot;
</code></pre>
<p>And we're done! New crates will start being built with the new rustc. If you want to rebuild any existing docs with the new rustdoc, you need to manually build them - there's no automated way to rebuild failed docs or docs from a certain rust version yet.</p>
<h2 id="updating-docsrs"><a class="header" href="#updating-docsrs">Updating docs.rs</a></h2>
<p>To update the code for docs.rs itself, you can follow a similar approach. First, watch the logs so you can stop the daemon from building more crates. (You can replace the lock command with a <code>systemctl stop cratesfyi</code> if you don't mind the web server being down while you build.)</p>
<pre><code class="language-console"># journalctl -efu cratesfyi
(wait for build daemon to sleep)
$ sudo su - cratesfyi -c &quot;cd ~/docs.rs &amp;&amp; cargo run --release -- build lock&quot;
</code></pre>
<p>Once the daemon has stopped, you can start updating the code and rebuilding:</p>
<pre><code class="language-console">$ sudo su - cratesfyi -c &quot;cd ~/docs.rs &amp;&amp; git pull&quot;
$ sudo su - cratesfyi -c &quot;cd ~/docs.rs &amp;&amp; cargo build --release&quot;
</code></pre>
<p>Now that we have a shiny new build, we need to make sure the service is using it:</p>
<pre><code class="language-console"># cp -v /home/cratesfyi/docs.rs/target/release/cratesfyi /var/lib/lxc/cratesfyi-container/rootfs/usr/local/bin
# systemctl restart cratesfyi
</code></pre>
<p>Next, we can unlock the builder so it can start checking new crates:</p>
<pre><code class="language-console">$ sudo su - cratesfyi -c &quot;cd ~/docs.rs &amp;&amp; cargo run --release -- build unlock&quot;
</code></pre>
<p>And we're done! Changes to the site or the build behavior should be visible now.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="common-maintenance-procedures"><a class="header" href="#common-maintenance-procedures">Common maintenance procedures</a></h1>
<h2 id="temporarily-remove-a-crate-from-the-queue"><a class="header" href="#temporarily-remove-a-crate-from-the-queue">Temporarily remove a crate from the queue</a></h2>
<p>It might happen that a crate fails to build repeatedly due to a docs.rs bug,
clogging up the queue and preventing other crates to build. In this case it's
possible to temporarily remove the crate from the queue until the docs.rs's bug
is fixed. To do that, log into the machine and open a PostgreSQL shell with:</p>
<pre><code>$ psql
</code></pre>
<p>Then you can run this SQL query to remove the crate:</p>
<pre><code>UPDATE queue SET attempt = 100 WHERE name = '&lt;CRATE_NAME&gt;';
</code></pre>
<p>To add the crate back in the queue you can run in the PostgreSQL shell this
query:</p>
<pre><code>UPDATE queue SET attempt = 0 WHERE name = '&lt;CRATE_NAME&gt;';
</code></pre>
<h2 id="pinning-a-version-of-nightly"><a class="header" href="#pinning-a-version-of-nightly">Pinning a version of nightly</a></h2>
<p>Sometimes the latest nightly might be broken, causing doc builds to fail. In
those cases it's possible to tell docs.rs to stop updating to the latest
nightly and instead pin a specific release. To do that you need to edit the
<code>/home/cratesfyi/.docs-rs-env</code> file, adding or changing this environment
variable:</p>
<pre><code>CRATESFYI_TOOLCHAIN=nightly-YYYY-MM-DD
</code></pre>
<p>Once the file changed docs.rs needs to be restarted:</p>
<pre><code>systemctl restart docs.rs
</code></pre>
<p>To return to the latest nightly simply remove the environment variable and
restart docs.rs again.</p>
<h2 id="rebuild-a-specific-crate"><a class="header" href="#rebuild-a-specific-crate">Rebuild a specific crate</a></h2>
<p>If a bug was recently fixed, you may want to rebuild a crate so that it builds with the latest version.
From the docs.rs machine:</p>
<pre><code>cratesfyi queue add &lt;crate&gt; &lt;version&gt;
</code></pre>
<p>This will add the crate with a lower priority than new crates by default, you can change the priority with the <code>-p</code> option.</p>
<h2 id="raise-the-limits-for-a-specific-crate"><a class="header" href="#raise-the-limits-for-a-specific-crate">Raise the limits for a specific crate</a></h2>
<p>Occasionally crates will ask for their build limits to be raised.
You can raise them from the docs.rs machine with <code>psql</code>.</p>
<p>Raising a memory limit to 8 GB:</p>
<pre><code class="language-psql"># memory is measured in bytes
cratesfyi=&gt; INSERT INTO sandbox_overrides (crate_name, max_memory_bytes)
  VALUES ('crate name', 8589934592);
</code></pre>
<p>Raising a timeout to 15 minutes:</p>
<pre><code class="language-psql">cratesfyi=&gt; INSERT INTO sandbox_overrides (crate_name, timeout_seconds)
  VALUES ('crate name', 900);
</code></pre>
<p>Raising limits for multiple crates at once:</p>
<pre><code class="language-psql">cratesfyi=&gt; INSERT INTO sandbox_overrides (crate_name, max_memory_bytes)
  VALUES ('stm32f4', 8589934592), ('stm32h7', 8589934592), ('stm32g4', 8589934592);
</code></pre>
<h2 id="set-a-group-of-crates-to-be-automatically-de-prioritized"><a class="header" href="#set-a-group-of-crates-to-be-automatically-de-prioritized">Set a group of crates to be automatically de-prioritized</a></h2>
<p>When many crates from the same project are published at once, they take up a
lot of space in the queue. You can de-prioritize groups of crates at once like
this:</p>
<pre><code class="language-psql">cratesfyi=&gt; INSERT INTO crate_priorities (pattern, priority)
  VALUES ('group-%', 1);
</code></pre>
<p>The <code>pattern</code> should be a <code>LIKE</code> pattern as documented on
<a href="https://www.postgresql.org/docs/current/functions-matching.html">https://www.postgresql.org/docs/current/functions-matching.html</a>.</p>
<p>Note that this only sets the default priority for crates with that name.
If there are crates already in the queue, you'll have to update those manually:</p>
<pre><code class="language-psql">cratesfyi=&gt; UPDATE queue SET priority = 1 WHERE name LIKE 'group-%';
</code></pre>
<h2 id="adding-all-the-crates-failed-after-a-date-back-in-the-queue"><a class="header" href="#adding-all-the-crates-failed-after-a-date-back-in-the-queue">Adding all the crates failed after a date back in the queue</a></h2>
<p>After an outage you might want to add all the failed builds back to the queue.
To do that, log into the machine and open a PostgreSQL shell with:</p>
<pre><code>psql
</code></pre>
<p>Then you can run this SQL query to add all the crates failed after <code>YYYY-MM-DD HH:MM:SS</code> back in the queue:</p>
<pre><code>UPDATE queue SET attempt = 0 WHERE attempt &gt;= 5 AND build_time &gt; 'YYYY-MM-DD HH:MM:SS';
</code></pre>
<h2 id="removing-a-crate-from-the-website"><a class="header" href="#removing-a-crate-from-the-website">Removing a crate from the website</a></h2>
<p>Sometimes it might be needed to remove all the content related to a crate from
docs.rs (for example after receiving a DMCA). To do that, log into the server
and run:</p>
<pre><code>cratesfyi database delete-crate CRATE_NAME
</code></pre>
<p>The command will remove all the data from the database, and then remove the
files from S3.</p>
<h2 id="blacklisting-crates"><a class="header" href="#blacklisting-crates">Blacklisting crates</a></h2>
<p>Occasionally it might be needed to prevent a crate from being built on docs.rs,
for example if we can't legally host the content of those crates. To add a
crate to the blacklist, preventing new builds for it, you can run:</p>
<pre><code>cratesfyi database blacklist add &lt;CRATE_NAME&gt;
</code></pre>
<p>Other operations (such as <code>list</code> and <code>remove</code>) are also supported.</p>
<blockquote>
<p><strong>Warning:</strong> blacklisting a crate doesn't remove existing content from the
website, it just prevents new versions from being built!</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="governance"><a class="header" href="#governance">Governance</a></h1>
<p style="background: #f8d7da; color: #721c24; padding: 5px">
<strong>IMPORTANT</strong> This document is adapted from
<a href="https://rust-lang.github.io/rfcs/1068-rust-governance.html">RFC 1068</a>
and is currently being actively worked on, however there may be large parts of
Rust's governance that are missing, incomplete, or out of date.
</p>
<h2 id="core-team"><a class="header" href="#core-team">Core team</a></h2>
<p><strong>The core team serves as leadership for the Rust project as a whole</strong>. In
particular, it:</p>
<ul>
<li>
<p><strong>Sets the overall direction and vision for the project.</strong> That means setting
the core values that are used when making decisions about technical
tradeoffs. It means steering the project toward specific use cases where Rust
can have a major impact. It means leading the discussion, and writing RFCs
for, <em>major</em> initiatives in the project.</p>
</li>
<li>
<p><strong>Sets the priorities and release schedule.</strong> Design bandwidth is limited, and
it's dangerous to try to grow the language too quickly; the core team makes
some difficult decisions about which areas to prioritize for new design, based
on the core values and target use cases.</p>
</li>
<li>
<p><strong>Focuses on broad, cross-cutting concerns.</strong> The core team is specifically
designed to take a <em>global</em> view of the project, to make sure the pieces are
fitting together in a coherent way.</p>
</li>
<li>
<p><strong>Spins up or shuts down subteams.</strong> Over time, we may want to expand the set
of subteams, and it may make sense to have temporary &quot;strike teams&quot; that focus
on a particular, limited task.</p>
</li>
<li>
<p><strong>Decides whether/when to ungate a feature.</strong> While the subteams make
decisions on RFCs, the core team is responsible for pulling the trigger that
moves a feature from nightly to stable. This provides an extra check that
features have adequately addressed cross-cutting concerns, that the
implementation quality is high enough, and that language/library commitments
are reasonable.</p>
</li>
</ul>
<p>The core team should include both the subteam leaders, and, over time, a diverse
set of other stakeholders that are both actively involved in the Rust community,
and can speak to the needs of major Rust constituencies, to ensure that the
project is addressing real-world needs.</p>
<h2 id="subteams"><a class="header" href="#subteams">Subteams</a></h2>
<p><strong>The primary roles of each subteam are</strong>:</p>
<ul>
<li>
<p>Shepherding RFCs for the subteam area. As always, that means (1) ensuring that
stakeholders are aware of the RFC, (2) working to tease out various design
tradeoffs and alternatives, and (3) helping build consensus.</p>
</li>
<li>
<p>Accepting or rejecting RFCs in the subteam area.</p>
</li>
<li>
<p>Setting policy on what changes in the subteam area require RFCs, and reviewing
direct PRs for changes that do not require an RFC.</p>
</li>
<li>
<p>Delegating <em>reviewer rights</em> for the subteam area. The ability to <code>r+</code> is not
limited to team members, and in fact earning <code>r+</code> rights is a good stepping
stone toward team membership. Each team should set reviewing policy, manage
reviewing rights, and ensure that reviews take place in a timely manner.
(Thanks to Nick Cameron for this suggestion.)</p>
</li>
</ul>
<p>Subteams make it possible to involve a larger, more diverse group in the
decision-making process. In particular, <strong>they should involve a mix of</strong>:</p>
<ul>
<li>
<p>Rust project leadership, in the form of at least one core team member (the
leader of the subteam).</p>
</li>
<li>
<p>Area experts: people who have a lot of interest and expertise in the subteam
area, but who may be far less engaged with other areas of the project.</p>
</li>
<li>
<p>Stakeholders: people who are strongly affected by decisions in the
subteam area, but who may not be experts in the design or
implementation of that area. <em>It is crucial that some people heavily
using Rust for applications/libraries have a seat at the table, to
make sure we are actually addressing real-world needs.</em></p>
</li>
</ul>
<p>Members should have demonstrated a good sense for design and dealing with
tradeoffs, an ability to work within a framework of consensus, and of course
sufficient knowledge about or experience with the subteam area. Leaders should
in addition have demonstrated exceptional communication, design, and people
skills. They must be able to work with a diverse group of people and help lead
it toward consensus and execution.</p>
<p>Each subteam is led by a member of the core team. <strong>The leader is responsible for</strong>:</p>
<ul>
<li>
<p>Setting up the subteam:</p>
<ul>
<li>
<p>Deciding on the initial membership of the subteam (in consultation with
the core team). Once the subteam is up and running.</p>
</li>
<li>
<p>Working with subteam members to determine and publish subteam policies and
mechanics, including the way that subteam members join or leave the team
(which should be based on subteam consensus).</p>
</li>
</ul>
</li>
<li>
<p>Communicating core team vision downward to the subteam.</p>
</li>
<li>
<p>Alerting the core team to subteam RFCs that need global, cross-cutting
attention, and to RFCs that have entered the &quot;final comment period&quot; (see below).</p>
</li>
<li>
<p>Ensuring that RFCs and PRs are progressing at a reasonable rate, re-assigning
shepherds/reviewers as needed.</p>
</li>
<li>
<p>Making final decisions in cases of contentious RFCs that are unable to reach
consensus otherwise (should be rare).</p>
</li>
</ul>
<p>The way that subteams communicate internally and externally is left to each
subteam to decide, but:</p>
<ul>
<li>
<p>Technical discussion should take place as much as possible on public forums,
ideally on RFC/PR threads and tagged discuss posts.</p>
</li>
<li>
<p>Each subteam will have a dedicated
<a href="https://internals.rust-lang.org/">internals forum</a> tag.</p>
</li>
<li>
<p>Subteams should actively seek out discussion and input from stakeholders who
are not members of the team.</p>
</li>
<li>
<p>Subteams should have some kind of regular meeting or other way of making
decisions. The content of this meeting should be summarized with the rationale
for each decision -- and, as explained below, decisions should generally be
about weighting a set of already-known tradeoffs, not discussing or
discovering new rationale.</p>
</li>
<li>
<p>Subteams should regularly publish the status of RFCs, PRs, and other news
related to their area. Ideally, this would be done in part via a dashboard
like <a href="http://buildbot.rust-lang.org/homu/queue/rust">the Homu queue</a>.</p>
</li>
</ul>
<h2 id="decision-making"><a class="header" href="#decision-making">Decision-making</a></h2>
<h3 id="consensus"><a class="header" href="#consensus">Consensus</a></h3>
<p>Rust has long used a form of <a href="https://en.wikipedia.org/wiki/Consensus_decision-making">consensus decision-making</a>. In a
nutshell the premise is that a successful outcome is not where one side of a
debate has &quot;won&quot;, but rather where concerns from <em>all</em> sides have been addressed
in some way. <strong>This emphatically does not entail design by committee, nor
compromised design</strong>. Rather, it's a recognition that</p>
<blockquote>
<p>... every design or implementation choice carries a trade-off and numerous
costs. There is seldom a right answer.</p>
</blockquote>
<p>Breakthrough designs sometimes end up changing the playing field by eliminating
tradeoffs altogether, but more often difficult decisions have to be made. <strong>The
key is to have a clear vision and set of values and priorities</strong>, which is the
core team's responsibility to set and communicate, and the subteam's
responsibility to act upon.</p>
<p>Whenever possible, we seek to reach consensus through discussion and design
revision. Concretely, the steps are:</p>
<ul>
<li>Initial RFC proposed, with initial analysis of tradeoffs.</li>
<li>Comments reveal additional drawbacks, problems, or tradeoffs.</li>
<li>RFC revised to address comments, often by improving the design.</li>
<li>Repeat above until &quot;major objections&quot; are fully addressed, or it's clear that
there is a fundamental choice to be made.</li>
</ul>
<p>Consensus is reached when most people are left with only &quot;minor&quot; objections,
i.e., while they might choose the tradeoffs slightly differently they do not
feel a strong need to <em>actively block</em> the RFC from progressing.</p>
<p>One important question is: consensus among which people, exactly? Of course, the
broader the consensus, the better. But at the very least, <strong>consensus within the
members of the subteam should be the norm for most decisions.</strong> If the core team
has done its job of communicating the values and priorities, it should be
possible to fit the debate about the RFC into that framework and reach a fairly
clear outcome.</p>
<h3 id="lack-of-consensus"><a class="header" href="#lack-of-consensus">Lack of consensus</a></h3>
<p>In some cases, though, consensus cannot be reached. These cases tend to split
into two very different camps:</p>
<ul>
<li>
<p>&quot;Trivial&quot; reasons, e.g., there is not widespread agreement about naming, but
there is consensus about the substance.</p>
</li>
<li>
<p>&quot;Deep&quot; reasons, e.g., the design fundamentally improves one set of concerns at
the expense of another, and people on both sides feel strongly about it.</p>
</li>
</ul>
<p>In either case, an alternative form of decision-making is needed.</p>
<ul>
<li>
<p>For the &quot;trivial&quot; case, usually either the RFC shepherd or subteam leader will
make an executive decision.</p>
</li>
<li>
<p>For the &quot;deep&quot; case, the subteam leader is empowered to make a final decision,
but should consult with the rest of the core team before doing so.</p>
</li>
</ul>
<h3 id="how-and-when-rfc-decisions-are-made-and-the-final-comment-period"><a class="header" href="#how-and-when-rfc-decisions-are-made-and-the-final-comment-period">How and when RFC decisions are made, and the &quot;final comment period&quot;</a></h3>
<p>Each RFC has a shepherd drawn from the relevant subteam. The shepherd is
responsible for driving the consensus process -- working with both the RFC
author and the broader community to dig out problems, alternatives, and improved
design, always working to reach broader consensus.</p>
<p>At some point, the RFC comments will reach a kind of &quot;steady state&quot;, where no
new tradeoffs are being discovered, and either objections have been addressed,
or it's clear that the design has fundamental downsides that need to be weighed.</p>
<p>At that point, the shepherd will announce that the RFC is in a &quot;final comment
period&quot; (which lasts for one week). This is a kind of &quot;last call&quot; for strong
objections to the RFC. <strong>The announcement of the final comment period for an RFC
should be very visible</strong>; it should be included in the subteam's periodic
communications.</p>
<blockquote>
<p>Note that the final comment period is in part intended to help keep RFCs
moving. Historically, RFCs sometimes stall out at a point where discussion has
died down but a decision isn't needed urgently. In this proposed model, the
RFC author could ask the shepherd to move to the final comment period (and
hence toward a decision).</p>
</blockquote>
<p>After the final comment period, the subteam can make a decision on the RFC. The
role of the subteam at that point is <em>not</em> to reveal any new technical issues or
arguments; if these come up during discussion, they should be added as comments
to the RFC, and it should undergo another final comment period.</p>
<p>Instead, the subteam decision is based on <strong>weighing the already-revealed
tradeoffs against the project's priorities and values</strong> (which the core team is
responsible for setting, globally). In the end, these decisions are about how to
weight tradeoffs. The decision should be communicated in these terms, pointing
out the tradeoffs that were raised and explaining how they were weighted, and
<strong>never introducing new arguments</strong>.</p>
<h2 id="keeping-things-lightweight"><a class="header" href="#keeping-things-lightweight">Keeping things lightweight</a></h2>
<p>In addition to the &quot;final comment period&quot; proposed above, this RFC proposes some
further adjustments to the RFC process to keep it lightweight.</p>
<p>A key observation is that, thanks to the stability system and nightly/stable
distinction, <strong>it's easy to experiment with features without commitment</strong>.</p>
<h3 id="clarifying-what-needs-an-rfc"><a class="header" href="#clarifying-what-needs-an-rfc">Clarifying what needs an RFC</a></h3>
<p>Over time, we've been drifting toward requiring an RFC for essentially any
user-facing change, which sometimes means that very minor changes get stuck
awaiting an RFC decision. While subteams + final comment period should help keep
the pipeline flowing a bit better, it would also be good to allow &quot;minor&quot;
changes to go through without an RFC, provided there is sufficient review in
some other way. (And in the end, the core team ungates features, which ensures
at least a final review.)</p>
<p>This RFC does not attempt to answer the question &quot;What needs an RFC&quot;, because
that question will vary for each subteam. However, this RFC stipulates that each
subteam should set an explicit policy about:</p>
<ol>
<li>What requires an RFC for the subteam's area, and</li>
<li>What the non-RFC review process is.</li>
</ol>
<p>These guidelines should try to keep the process lightweight for minor changes.</p>
<h3 id="clarifying-the-finality-of-rfcs"><a class="header" href="#clarifying-the-finality-of-rfcs">Clarifying the &quot;finality&quot; of RFCs</a></h3>
<p>While RFCs are very important, they do not represent the final state of a
design. Often new issues or improvements arise during implementation, or after
gaining some experience with a feature. <strong>The nightly/stable distinction exists
in part to allow for such design iteration.</strong></p>
<p>Thus RFCs do not need to be &quot;perfect&quot; before acceptance. If consensus is reached
on major points, the minor details can be left to implementation and revision.</p>
<p>Later, if an implementation differs from the RFC in <em>substantial</em> ways, the
subteam should be alerted, and may ask for an explicit amendment RFC. Otherwise,
the changes should just be explained in the commit/PR.</p>
<h2 id="the-teams"><a class="header" href="#the-teams">The teams</a></h2>
<p>With all of that out of the way, what subteams should we start with? This RFC
proposes the following initial set:</p>
<ul>
<li>Language design</li>
<li>Libraries</li>
<li>Compiler</li>
<li>Tooling and infrastructure</li>
<li>Moderation</li>
</ul>
<p>In the long run, we will likely also want teams for documentation and for
community events, but these can be spun up once there is a more clear need (and
available resources).</p>
<h3 id="language-design-team"><a class="header" href="#language-design-team">Language design team</a></h3>
<p>Focuses on the <em>design</em> of language-level features; not all team members need to
have extensive implementation experience.</p>
<p>Some example RFCs that fall into this area:</p>
<ul>
<li><a href="https://github.com/rust-lang/rfcs/pull/195">Associated types and multidispatch</a></li>
<li><a href="https://github.com/rust-lang/rfcs/pull/982">DST coercions</a></li>
<li><a href="https://github.com/rust-lang/rfcs/pull/243">Trait-based exception handling</a></li>
<li><a href="https://github.com/rust-lang/rfcs/pull/1023">Rebalancing coherence</a></li>
<li><a href="https://github.com/rust-lang/rfcs/pull/560">Integer overflow</a> (this has high
overlap with the library subteam)</li>
<li><a href="https://github.com/rust-lang/rfcs/pull/769">Sound generic drop</a></li>
</ul>
<h3 id="library-team"><a class="header" href="#library-team">Library team</a></h3>
<p>Oversees both <code>std</code> and, ultimately, other crates in the <code>rust-lang</code> github
organization. The focus up to this point has been the standard library, but we
will want &quot;official&quot; libraries that aren't quite <code>std</code> territory but are still
vital for Rust. (The precise plan here, as well as the long-term plan for <code>std</code>,
is one of the first important areas of debate for the subteam.) Also includes
API conventions.</p>
<p>Some example RFCs that fall into this area:</p>
<ul>
<li><a href="https://github.com/rust-lang/rfcs/pull/235">Collections reform</a></li>
<li><a href="https://github.com/rust-lang/rfcs/pull/517/">IO reform</a></li>
<li><a href="https://github.com/rust-lang/rfcs/pull/640">Debug improvements</a></li>
<li><a href="https://github.com/rust-lang/rfcs/pull/823">Simplifying std::hash</a></li>
<li><a href="https://github.com/rust-lang/rfcs/pull/199">Conventions for ownership variants</a></li>
</ul>
<h3 id="compiler-team"><a class="header" href="#compiler-team">Compiler team</a></h3>
<p>Focuses on compiler internals, including implementation of language
features. This broad category includes work in codegen, factoring of compiler
data structures, type inference, borrowck, and so on.</p>
<p>There is a more limited set of example RFCs for this subteam, in part because we
haven't generally required RFCs for this kind of internals work, but here are two:</p>
<ul>
<li><a href="https://github.com/rust-lang/rfcs/pull/320">Non-zeroing dynamic drops</a> (this
has high overlap with language design)</li>
<li><a href="https://github.com/rust-lang/rfcs/pull/594">Incremental compilation</a></li>
</ul>
<h3 id="tooling-and-infrastructure-team"><a class="header" href="#tooling-and-infrastructure-team">Tooling and infrastructure team</a></h3>
<p>Even more broad is the &quot;tooling&quot; subteam, which at inception is planned to
encompass every &quot;official&quot; (rust-lang managed) non-<code>rustc</code> tool:</p>
<ul>
<li>rustdoc</li>
<li>rustfmt</li>
<li>Cargo</li>
<li>crates.io</li>
<li>CI infrastructure</li>
<li>Debugging tools</li>
<li>Profiling tools</li>
<li>Editor/IDE integration</li>
<li>Refactoring tools</li>
</ul>
<p>It's not presently clear exactly what tools will end up under this umbrella, nor
which should be prioritized.</p>
<h3 id="moderation-team"><a class="header" href="#moderation-team">Moderation team</a></h3>
<p>Finally, the moderation team is responsible for dealing with CoC violations.</p>
<p>One key difference from the other subteams is that the moderation team does not
have a leader. Its members are chosen directly by the core team, and should be
community members who have demonstrated the highest standard of discourse and
maturity. To limit conflicts of interest, <strong>the moderation subteam should not
include any core team members</strong>. However, the subteam is free to consult with
the core team as it deems appropriate.</p>
<p>The moderation team will have a public email address that can be used to raise
complaints about CoC violations (forwards to all active moderators).</p>
<h4 id="initial-plan-for-moderation"><a class="header" href="#initial-plan-for-moderation">Initial plan for moderation</a></h4>
<p>What follows is an initial proposal for the mechanics of moderation. The
moderation subteam may choose to revise this proposal by drafting an RFC, which
will be approved by the core team.</p>
<p>Moderation begins whenever a moderator becomes aware of a CoC problem, either
through a complaint or by observing it directly. In general, the enforcement
steps are as follows:</p>
<blockquote>
<p><strong>These steps are adapted from text written by Manish Goregaokar, who helped
articulate them from experience as a Stack Exchange moderator.</strong></p>
</blockquote>
<ul>
<li>
<p>Except for extreme cases (see below), try first to address the problem with a
light public comment on thread, aimed to de-escalate the situation. These
comments should strive for as much empathy as possible. Moderators should
emphasize that dissenting opinions are valued, and strive to ensure that the
technical points are heard even as they work to cool things down.</p>
<p>When a discussion has just gotten a bit heated, the comment can just be a
reminder to be respectful and that there is rarely a clear &quot;right&quot; answer. In
cases that are more clearly over the line into personal attacks, it can
directly call out a problematic comment.</p>
</li>
<li>
<p>If the problem persists on thread, or if a particular person repeatedly comes
close to or steps over the line of a CoC violation, moderators then email the
offender privately. The message should include relevant portions of the CoC
together with the offending comments. Again, the goal is to de-escalate, and
the email should be written in a dispassionate and empathetic way. However,
the message should also make clear that continued violations may result in a
ban.</p>
</li>
<li>
<p>If problems still persist, the moderators can ban the offender. Banning should
occur for progressively longer periods, for example starting at 1 day, then 1
week, then permanent. The moderation subteam will determine the precise
guidelines here.</p>
</li>
</ul>
<p>In general, moderators can and should unilaterally take the first step, but
steps beyond that (particularly banning) should be done via consensus with the
other moderators. Permanent bans require core team approval.</p>
<p>Some situations call for more immediate, drastic measures: deeply inappropriate
comments, harassment, or comments that make people feel unsafe. (See the
<a href="http://www.rust-lang.org/conduct.html">code of conduct</a> for some more details
about this kind of comment). In these cases, an individual moderator is free to
take immediate, unilateral steps including redacting or removing comments, or
instituting a short-term ban until the subteam can convene to deal with the
situation.</p>
<p>The moderation team is responsible for interpreting the CoC. Drastic measures
like bans should only be used in cases of clear, repeated violations.</p>
<p>Moderators themselves are held to a very high standard of behavior, and should
strive for professional and impersonal interactions when dealing with a CoC
violation. They should always push to <em>de-escalate</em>. And they should recuse
themselves from moderation in threads where they are actively participating in
the technical debate or otherwise have a conflict of interest. Moderators who
fail to keep up this standard, or who abuse the moderation process, may be
removed by the core team.</p>
<p>Subteam, and especially core team members are <em>also</em> held to a high standard of
behavior. Part of the reason to separate the moderation subteam is to ensure
that CoC violations by Rust's leadership be addressed through the same
independent body of moderators.</p>
<p>Moderation covers all rust-lang venues, which currently include github
repos, IRC channels (#rust, #rust-internals, #rustc, #rust-libs), and
the two discourse forums. (The subreddit already has its own
moderation structure, and isn't directly associated with the rust-lang
organization.)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="infrastructure"><a class="header" href="#infrastructure">Infrastructure</a></h1>
<p>This section documents Rust's infrastructure, and how it is maintained.</p>
<h3 id="external-links-4"><a class="header" href="#external-links-4">External Links</a></h3>
<ul>
<li><a href="https://rust-lang-nursery.github.io/rust-toolstate/">rust-toolstate</a> records build and test status of external tools bundled
with the Rust repository.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="other-rust-installation-methods"><a class="header" href="#other-rust-installation-methods">Other Rust Installation Methods</a></h1>
<ul>
<li><a href="infra/other-installation-methods.html#which">Which installer should you use?</a></li>
<li><a href="infra/other-installation-methods.html#rustup">Other ways to install <code>rustup</code></a></li>
<li><a href="infra/other-installation-methods.html#standalone">Standalone installers</a></li>
<li><a href="infra/other-installation-methods.html#source-code">Source code</a></li>
</ul>
<h2 id="which-installer-should-you-use"><a class="header" href="#which-installer-should-you-use">Which installer should you use?</a></h2>
<p><span id="which"></span></p>
<p>Rust runs on many platforms, and there are many ways to install Rust. If you
want to install Rust in the most straightforward, recommended way, then follow
the instructions on the main <a href="https://www.rust-lang.org/tools/install">installation page</a>.</p>
<p>That page describes installation via <a href="https://github.com/rust-lang/rustup.rs"><code>rustup</code></a>, a tool that manages multiple
Rust toolchains in a consistent way across all platforms Rust supports. Why
might one <em>not</em> want to install using those instructions?</p>
<ul>
<li>Offline installation. <code>rustup</code> downloads components from the internet on
demand. If you need to install Rust without access to the internet, <code>rustup</code>
is not suitable.</li>
<li>Preference for the system package manager. On Linux in particular, but also on
macOS with <a href="http://brew.sh/">Homebrew</a>, <a href="https://www.macports.org/">MacPorts</a> or <a href="https://pkgsrc.joyent.com/install-on-osx/">pkgsrc</a>, and Windows with <a href="http://chocolatey.org/">Chocolatey</a>
or <a href="https://scoop.sh/">Scoop</a>, developers sometimes prefer to install Rust with their platform's
package manager.</li>
<li>Preference against <code>curl | sh</code>. On Unix, we usually install <code>rustup</code> by
running a shell script via <code>curl</code>. Some have concerns about the security of
this arrangement and would prefer to download and run the installer
themselves.</li>
<li>Validating signatures. Although <code>rustup</code> performs its downloads over HTTPS,
the only way to verify the signatures of Rust installers today is to do so
manually with the standalone installers.</li>
<li>GUI installation and integration with &quot;Add/Remove Programs&quot; on Windows.
<code>rustup</code> runs in the console and does not register its installation like
typical Windows programs. If you prefer a more typical GUI installation on
Windows there are standalone <code>.msi</code> installers. In the future <code>rustup</code> will
also have a GUI installer on Windows.</li>
</ul>
<p>Rust's platform support is defined in <a href="https://doc.rust-lang.org/nightly/rustc/platform-support.html">three tiers</a>, which correspond closely
with the installation methods available: in general, the Rust project provides
binary builds for all tier 1 and tier 2 platforms, and they are all installable
via <code>rustup</code>. Some tier 2 platforms though have only the standard library
available, not the compiler itself; that is, they are cross-compilation targets
only; Rust code can run on those platforms, but they do not run the compiler
itself. Such targets can be installed with the <code>rustup target add</code> command.</p>
<h2 id="other-ways-to-install-rustup"><a class="header" href="#other-ways-to-install-rustup">Other ways to install <code>rustup</code></a></h2>
<p><span id="rustup"></span></p>
<p>The way to install <code>rustup</code> differs by platform:</p>
<ul>
<li>On Unix, run <code>curl https://sh.rustup.rs -sSf | sh</code> in your shell. This
downloads and runs <a href="https://static.rust-lang.org/rustup/rustup-init.sh"><code>rustup-init.sh</code></a>, which in turn downloads and runs the
correct version of the <code>rustup-init</code> executable for your platform.</li>
<li>On Windows, download and run <a href="https://static.rust-lang.org/rustup/dist/i686-pc-windows-gnu/rustup-init.exe"><code>rustup-init.exe</code></a>.</li>
</ul>
<p><code>rustup-init</code> can be configured interactively, and all options can additionally
be controlled by command-line arguments, which can be passed through the shell
script. Pass <code>--help</code> to <code>rustup-init</code> as follows to display the arguments
<code>rustup-init</code> accepts:</p>
<pre><code>curl https://sh.rustup.rs -sSf | sh -s -- --help
</code></pre>
<p>If you prefer not to use the shell script, you may directly download
<code>rustup-init</code> for the platform of your choice:</p>
<!-- `- [aarch64-linux-android](https://static.rust-lang.org/rustup/dist/aarch64-linux-android/rustup-init)
- [aarch64-unknown-linux-gnu](https://static.rust-lang.org/rustup/dist/aarch64-unknown-linux-gnu/rustup-init)
- [aarch64-unknown-linux-musl](https://static.rust-lang.org/rustup/dist/aarch64-unknown-linux-musl/rustup-init)
- [arm-linux-androideabi](https://static.rust-lang.org/rustup/dist/arm-linux-androideabi/rustup-init)
- [arm-unknown-linux-gnueabi](https://static.rust-lang.org/rustup/dist/arm-unknown-linux-gnueabi/rustup-init)
- [arm-unknown-linux-gnueabihf](https://static.rust-lang.org/rustup/dist/arm-unknown-linux-gnueabihf/rustup-init)
- [armv7-linux-androideabi](https://static.rust-lang.org/rustup/dist/armv7-linux-androideabi/rustup-init)
- [armv7-unknown-linux-gnueabihf](https://static.rust-lang.org/rustup/dist/armv7-unknown-linux-gnueabihf/rustup-init)
- [i686-apple-darwin](https://static.rust-lang.org/rustup/dist/i686-apple-darwin/rustup-init)
- [i686-linux-android](https://static.rust-lang.org/rustup/dist/i686-linux-android/rustup-init)
- [i686-pc-windows-gnu](https://static.rust-lang.org/rustup/dist/i686-pc-windows-gnu/rustup-init.exe)
- [i686-pc-windows-msvc](https://static.rust-lang.org/rustup/dist/i686-pc-windows-msvc/rustup-init.exe)
- [i686-unknown-linux-gnu](https://static.rust-lang.org/rustup/dist/i686-unknown-linux-gnu/rustup-init)
- [mips-unknown-linux-gnu](https://static.rust-lang.org/rustup/dist/mips-unknown-linux-gnu/rustup-init)
- [mips64-unknown-linux-gnuabi64](https://static.rust-lang.org/rustup/dist/mips64-unknown-linux-gnuabi64/rustup-init)
- [mips64el-unknown-linux-gnuabi64](https://static.rust-lang.org/rustup/dist/mips64el-unknown-linux-gnuabi64/rustup-init)
- [mipsel-unknown-linux-gnu](https://static.rust-lang.org/rustup/dist/mipsel-unknown-linux-gnu/rustup-init)
- [powerpc-unknown-linux-gnu](https://static.rust-lang.org/rustup/dist/powerpc-unknown-linux-gnu/rustup-init)
- [powerpc64-unknown-linux-gnu](https://static.rust-lang.org/rustup/dist/powerpc64-unknown-linux-gnu/rustup-init)
- [powerpc64le-unknown-linux-gnu](https://static.rust-lang.org/rustup/dist/powerpc64le-unknown-linux-gnu/rustup-init)
- [s390x-unknown-linux-gnu](https://static.rust-lang.org/rustup/dist/s390x-unknown-linux-gnu/rustup-init)
- [x86_64-apple-darwin](https://static.rust-lang.org/rustup/dist/x86_64-apple-darwin/rustup-init)
- [x86_64-linux-android](https://static.rust-lang.org/rustup/dist/x86_64-linux-android/rustup-init)
- [x86_64-pc-windows-gnu](https://static.rust-lang.org/rustup/dist/x86_64-pc-windows-gnu/rustup-init.exe)
- [x86_64-pc-windows-msvc](https://static.rust-lang.org/rustup/dist/x86_64-pc-windows-msvc/rustup-init.exe)
- [x86_64-unknown-freebsd](https://static.rust-lang.org/rustup/dist/x86_64-unknown-freebsd/rustup-init)
- [x86_64-unknown-illumos](https://static.rust-lang.org/rustup/dist/x86_64-unknown-illumos/rustup-init)
- [x86_64-unknown-linux-gnu](https://static.rust-lang.org/rustup/dist/x86_64-unknown-linux-gnu/rustup-init)
- [x86_64-unknown-linux-musl](https://static.rust-lang.org/rustup/dist/x86_64-unknown-linux-musl/rustup-init)
- [x86_64-unknown-netbsd](https://static.rust-lang.org/rustup/dist/x86_64-unknown-netbsd/rustup-init)
`, `platform | stable (1.64.0) | beta | nightly
---------|--------|------|--------
`aarch64-apple-darwin` | [pkg](https://static.rust-lang.org/dist/rust-1.64.0-aarch64-apple-darwin.pkg) <br> [pkg.asc](https://static.rust-lang.org/dist/rust-1.64.0-aarch64-apple-darwin.pkg.asc) | [pkg](https://static.rust-lang.org/dist/rust-beta-aarch64-apple-darwin.pkg) <br> [pkg.asc](https://static.rust-lang.org/dist/rust-beta-aarch64-apple-darwin.pkg.asc) | [pkg](https://static.rust-lang.org/dist/rust-nightly-aarch64-apple-darwin.pkg) <br> [pkg.asc](https://static.rust-lang.org/dist/rust-nightly-aarch64-apple-darwin.pkg.asc)
`aarch64-pc-windows-msvc` | [msi](https://static.rust-lang.org/dist/rust-1.64.0-aarch64-pc-windows-msvc.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-1.64.0-aarch64-pc-windows-msvc.msi.asc) | [msi](https://static.rust-lang.org/dist/rust-beta-aarch64-pc-windows-msvc.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-beta-aarch64-pc-windows-msvc.msi.asc) | [msi](https://static.rust-lang.org/dist/rust-nightly-aarch64-pc-windows-msvc.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-nightly-aarch64-pc-windows-msvc.msi.asc)
`aarch64-unknown-linux-gnu` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-aarch64-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-aarch64-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-aarch64-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-aarch64-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-aarch64-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-aarch64-unknown-linux-gnu.tar.gz.asc)
`aarch64-unknown-linux-musl` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-aarch64-unknown-linux-musl.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-aarch64-unknown-linux-musl.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-aarch64-unknown-linux-musl.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-aarch64-unknown-linux-musl.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-aarch64-unknown-linux-musl.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-aarch64-unknown-linux-musl.tar.gz.asc)
`arm-unknown-linux-gnueabi` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-arm-unknown-linux-gnueabi.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-arm-unknown-linux-gnueabi.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-arm-unknown-linux-gnueabi.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-arm-unknown-linux-gnueabi.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-arm-unknown-linux-gnueabi.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-arm-unknown-linux-gnueabi.tar.gz.asc)
`arm-unknown-linux-gnueabihf` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-arm-unknown-linux-gnueabihf.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-arm-unknown-linux-gnueabihf.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-arm-unknown-linux-gnueabihf.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-arm-unknown-linux-gnueabihf.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-arm-unknown-linux-gnueabihf.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-arm-unknown-linux-gnueabihf.tar.gz.asc)
`armv7-unknown-linux-gnueabihf` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-armv7-unknown-linux-gnueabihf.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-armv7-unknown-linux-gnueabihf.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-armv7-unknown-linux-gnueabihf.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-armv7-unknown-linux-gnueabihf.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-armv7-unknown-linux-gnueabihf.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-armv7-unknown-linux-gnueabihf.tar.gz.asc)
`i686-pc-windows-gnu` | [msi](https://static.rust-lang.org/dist/rust-1.64.0-i686-pc-windows-gnu.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-1.64.0-i686-pc-windows-gnu.msi.asc) | [msi](https://static.rust-lang.org/dist/rust-beta-i686-pc-windows-gnu.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-beta-i686-pc-windows-gnu.msi.asc) | [msi](https://static.rust-lang.org/dist/rust-nightly-i686-pc-windows-gnu.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-nightly-i686-pc-windows-gnu.msi.asc)
`i686-pc-windows-msvc` | [msi](https://static.rust-lang.org/dist/rust-1.64.0-i686-pc-windows-msvc.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-1.64.0-i686-pc-windows-msvc.msi.asc) | [msi](https://static.rust-lang.org/dist/rust-beta-i686-pc-windows-msvc.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-beta-i686-pc-windows-msvc.msi.asc) | [msi](https://static.rust-lang.org/dist/rust-nightly-i686-pc-windows-msvc.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-nightly-i686-pc-windows-msvc.msi.asc)
`i686-unknown-linux-gnu` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-i686-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-i686-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-i686-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-i686-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-i686-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-i686-unknown-linux-gnu.tar.gz.asc)
`mips-unknown-linux-gnu` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-mips-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-mips-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-mips-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-mips-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-mips-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-mips-unknown-linux-gnu.tar.gz.asc)
`mips64-unknown-linux-gnuabi64` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-mips64-unknown-linux-gnuabi64.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-mips64-unknown-linux-gnuabi64.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-mips64-unknown-linux-gnuabi64.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-mips64-unknown-linux-gnuabi64.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-mips64-unknown-linux-gnuabi64.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-mips64-unknown-linux-gnuabi64.tar.gz.asc)
`mips64el-unknown-linux-gnuabi64` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-mips64el-unknown-linux-gnuabi64.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-mips64el-unknown-linux-gnuabi64.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-mips64el-unknown-linux-gnuabi64.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-mips64el-unknown-linux-gnuabi64.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-mips64el-unknown-linux-gnuabi64.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-mips64el-unknown-linux-gnuabi64.tar.gz.asc)
`mipsel-unknown-linux-gnu` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-mipsel-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-mipsel-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-mipsel-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-mipsel-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-mipsel-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-mipsel-unknown-linux-gnu.tar.gz.asc)
`powerpc-unknown-linux-gnu` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-powerpc-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-powerpc-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-powerpc-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-powerpc-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-powerpc-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-powerpc-unknown-linux-gnu.tar.gz.asc)
`powerpc64-unknown-linux-gnu` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-powerpc64-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-powerpc64-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-powerpc64-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-powerpc64-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-powerpc64-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-powerpc64-unknown-linux-gnu.tar.gz.asc)
`powerpc64le-unknown-linux-gnu` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-powerpc64le-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-powerpc64le-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-powerpc64le-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-powerpc64le-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-powerpc64le-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-powerpc64le-unknown-linux-gnu.tar.gz.asc)
`riscv64gc-unknown-linux-gnu` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-riscv64gc-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-riscv64gc-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-riscv64gc-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-riscv64gc-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-riscv64gc-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-riscv64gc-unknown-linux-gnu.tar.gz.asc)
`s390x-unknown-linux-gnu` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-s390x-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-s390x-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-s390x-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-s390x-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-s390x-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-s390x-unknown-linux-gnu.tar.gz.asc)
`x86_64-apple-darwin` | [pkg](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-apple-darwin.pkg) <br> [pkg.asc](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-apple-darwin.pkg.asc) | [pkg](https://static.rust-lang.org/dist/rust-beta-x86_64-apple-darwin.pkg) <br> [pkg.asc](https://static.rust-lang.org/dist/rust-beta-x86_64-apple-darwin.pkg.asc) | [pkg](https://static.rust-lang.org/dist/rust-nightly-x86_64-apple-darwin.pkg) <br> [pkg.asc](https://static.rust-lang.org/dist/rust-nightly-x86_64-apple-darwin.pkg.asc)
`x86_64-pc-windows-gnu` | [msi](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-pc-windows-gnu.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-pc-windows-gnu.msi.asc) | [msi](https://static.rust-lang.org/dist/rust-beta-x86_64-pc-windows-gnu.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-beta-x86_64-pc-windows-gnu.msi.asc) | [msi](https://static.rust-lang.org/dist/rust-nightly-x86_64-pc-windows-gnu.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-nightly-x86_64-pc-windows-gnu.msi.asc)
`x86_64-pc-windows-msvc` | [msi](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-pc-windows-msvc.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-pc-windows-msvc.msi.asc) | [msi](https://static.rust-lang.org/dist/rust-beta-x86_64-pc-windows-msvc.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-beta-x86_64-pc-windows-msvc.msi.asc) | [msi](https://static.rust-lang.org/dist/rust-nightly-x86_64-pc-windows-msvc.msi) <br> [msi.asc](https://static.rust-lang.org/dist/rust-nightly-x86_64-pc-windows-msvc.msi.asc)
`x86_64-unknown-freebsd` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-freebsd.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-freebsd.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-freebsd.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-freebsd.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-freebsd.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-freebsd.tar.gz.asc)
`x86_64-unknown-illumos` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-illumos.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-illumos.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-illumos.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-illumos.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-illumos.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-illumos.tar.gz.asc)
`x86_64-unknown-linux-gnu` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-linux-gnu.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-linux-gnu.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-linux-gnu.tar.gz.asc)
`x86_64-unknown-linux-musl` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-linux-musl.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-linux-musl.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-linux-musl.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-linux-musl.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-linux-musl.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-linux-musl.tar.gz.asc)
`x86_64-unknown-netbsd` | [tar.gz](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-netbsd.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-netbsd.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-netbsd.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-netbsd.tar.gz.asc) | [tar.gz](https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-netbsd.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-netbsd.tar.gz.asc)
`, and `Channel | Archives + Signatures
--------|----------------------
stable (1.64.0) | [tar.gz](https://static.rust-lang.org/dist/rustc-1.64.0-src.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rustc-1.64.0-src.tar.gz.asc)
beta | [tar.gz](https://static.rust-lang.org/dist/rustc-beta-src.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rustc-beta-src.tar.gz.asc)
nightly | [tar.gz](https://static.rust-lang.org/dist/rustc-nightly-src.tar.gz) <br> [tar.gz.asc](https://static.rust-lang.org/dist/rustc-nightly-src.tar.gz.asc)
`
are generated at build time. Please refer to the `blacksmith` preprocessor for
what they each specifically generate.
-->
<ul>
<li><a href="https://static.rust-lang.org/rustup/dist/aarch64-linux-android/rustup-init">aarch64-linux-android</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/aarch64-unknown-linux-gnu/rustup-init">aarch64-unknown-linux-gnu</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/aarch64-unknown-linux-musl/rustup-init">aarch64-unknown-linux-musl</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/arm-linux-androideabi/rustup-init">arm-linux-androideabi</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/arm-unknown-linux-gnueabi/rustup-init">arm-unknown-linux-gnueabi</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/arm-unknown-linux-gnueabihf/rustup-init">arm-unknown-linux-gnueabihf</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/armv7-linux-androideabi/rustup-init">armv7-linux-androideabi</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/armv7-unknown-linux-gnueabihf/rustup-init">armv7-unknown-linux-gnueabihf</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/i686-apple-darwin/rustup-init">i686-apple-darwin</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/i686-linux-android/rustup-init">i686-linux-android</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/i686-pc-windows-gnu/rustup-init.exe">i686-pc-windows-gnu</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/i686-pc-windows-msvc/rustup-init.exe">i686-pc-windows-msvc</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/i686-unknown-linux-gnu/rustup-init">i686-unknown-linux-gnu</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/mips-unknown-linux-gnu/rustup-init">mips-unknown-linux-gnu</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/mips64-unknown-linux-gnuabi64/rustup-init">mips64-unknown-linux-gnuabi64</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/mips64el-unknown-linux-gnuabi64/rustup-init">mips64el-unknown-linux-gnuabi64</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/mipsel-unknown-linux-gnu/rustup-init">mipsel-unknown-linux-gnu</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/powerpc-unknown-linux-gnu/rustup-init">powerpc-unknown-linux-gnu</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/powerpc64-unknown-linux-gnu/rustup-init">powerpc64-unknown-linux-gnu</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/powerpc64le-unknown-linux-gnu/rustup-init">powerpc64le-unknown-linux-gnu</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/s390x-unknown-linux-gnu/rustup-init">s390x-unknown-linux-gnu</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/x86_64-apple-darwin/rustup-init">x86_64-apple-darwin</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/x86_64-linux-android/rustup-init">x86_64-linux-android</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/x86_64-pc-windows-gnu/rustup-init.exe">x86_64-pc-windows-gnu</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/x86_64-pc-windows-msvc/rustup-init.exe">x86_64-pc-windows-msvc</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/x86_64-unknown-freebsd/rustup-init">x86_64-unknown-freebsd</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/x86_64-unknown-illumos/rustup-init">x86_64-unknown-illumos</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/x86_64-unknown-linux-gnu/rustup-init">x86_64-unknown-linux-gnu</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/x86_64-unknown-linux-musl/rustup-init">x86_64-unknown-linux-musl</a></li>
<li><a href="https://static.rust-lang.org/rustup/dist/x86_64-unknown-netbsd/rustup-init">x86_64-unknown-netbsd</a></li>
</ul>
<h2 id="standalone-installers"><a class="header" href="#standalone-installers">Standalone installers</a></h2>
<p><span id="standalone"></span></p>
<p>The official Rust standalone installers contain a single release of Rust, and
are suitable for offline installation. They come in three forms: tarballs
(extension <code>.tar.gz</code>), that work in any Unix-like environment, Windows
installers (<code>.msi</code>), and Mac installers (<code>.pkg</code>). These installers come with
<code>rustc</code>, <code>cargo</code>, <code>rustdoc</code>, the standard library, and the standard
documentation, but do not provide access to additional cross-targets like
<code>rustup</code> does.</p>
<p>The most common reasons to use these are:</p>
<ul>
<li>Offline installation</li>
<li>Preferring a more platform-integrated, graphical installer on Windows</li>
</ul>
<p>Each of these binaries is signed with the <a href="https://static.rust-lang.org/rust-key.gpg.ascii">Rust signing key</a>, which is
<a href="https://keybase.io/rust">available on keybase.io</a>, by the Rust build infrastructure, with <a href="https://gnupg.org/">GPG</a>. In the
tables below, the <code>.asc</code> files are the signatures.</p>
<!-- FIXME: Show this sentence again once we've found a quick way to display the archives.
Past releases can be found in [the archives].
-->
<div class="table-wrapper"><table><thead><tr><th>platform</th><th>stable (1.64.0)</th><th>beta</th><th>nightly</th></tr></thead><tbody>
<tr><td><code>aarch64-apple-darwin</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-aarch64-apple-darwin.pkg">pkg</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-aarch64-apple-darwin.pkg.asc">pkg.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-aarch64-apple-darwin.pkg">pkg</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-aarch64-apple-darwin.pkg.asc">pkg.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-aarch64-apple-darwin.pkg">pkg</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-aarch64-apple-darwin.pkg.asc">pkg.asc</a></td></tr>
<tr><td><code>aarch64-pc-windows-msvc</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-aarch64-pc-windows-msvc.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-aarch64-pc-windows-msvc.msi.asc">msi.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-aarch64-pc-windows-msvc.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-aarch64-pc-windows-msvc.msi.asc">msi.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-aarch64-pc-windows-msvc.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-aarch64-pc-windows-msvc.msi.asc">msi.asc</a></td></tr>
<tr><td><code>aarch64-unknown-linux-gnu</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-aarch64-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-aarch64-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-aarch64-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-aarch64-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-aarch64-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-aarch64-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>aarch64-unknown-linux-musl</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-aarch64-unknown-linux-musl.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-aarch64-unknown-linux-musl.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-aarch64-unknown-linux-musl.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-aarch64-unknown-linux-musl.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-aarch64-unknown-linux-musl.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-aarch64-unknown-linux-musl.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>arm-unknown-linux-gnueabi</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-arm-unknown-linux-gnueabi.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-arm-unknown-linux-gnueabi.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-arm-unknown-linux-gnueabi.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-arm-unknown-linux-gnueabi.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-arm-unknown-linux-gnueabi.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-arm-unknown-linux-gnueabi.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>arm-unknown-linux-gnueabihf</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-arm-unknown-linux-gnueabihf.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-arm-unknown-linux-gnueabihf.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-arm-unknown-linux-gnueabihf.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-arm-unknown-linux-gnueabihf.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-arm-unknown-linux-gnueabihf.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-arm-unknown-linux-gnueabihf.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>armv7-unknown-linux-gnueabihf</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-armv7-unknown-linux-gnueabihf.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-armv7-unknown-linux-gnueabihf.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-armv7-unknown-linux-gnueabihf.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-armv7-unknown-linux-gnueabihf.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-armv7-unknown-linux-gnueabihf.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-armv7-unknown-linux-gnueabihf.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>i686-pc-windows-gnu</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-i686-pc-windows-gnu.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-i686-pc-windows-gnu.msi.asc">msi.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-i686-pc-windows-gnu.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-i686-pc-windows-gnu.msi.asc">msi.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-i686-pc-windows-gnu.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-i686-pc-windows-gnu.msi.asc">msi.asc</a></td></tr>
<tr><td><code>i686-pc-windows-msvc</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-i686-pc-windows-msvc.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-i686-pc-windows-msvc.msi.asc">msi.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-i686-pc-windows-msvc.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-i686-pc-windows-msvc.msi.asc">msi.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-i686-pc-windows-msvc.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-i686-pc-windows-msvc.msi.asc">msi.asc</a></td></tr>
<tr><td><code>i686-unknown-linux-gnu</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-i686-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-i686-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-i686-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-i686-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-i686-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-i686-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>mips-unknown-linux-gnu</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-mips-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-mips-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-mips-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-mips-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-mips-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-mips-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>mips64-unknown-linux-gnuabi64</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-mips64-unknown-linux-gnuabi64.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-mips64-unknown-linux-gnuabi64.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-mips64-unknown-linux-gnuabi64.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-mips64-unknown-linux-gnuabi64.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-mips64-unknown-linux-gnuabi64.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-mips64-unknown-linux-gnuabi64.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>mips64el-unknown-linux-gnuabi64</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-mips64el-unknown-linux-gnuabi64.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-mips64el-unknown-linux-gnuabi64.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-mips64el-unknown-linux-gnuabi64.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-mips64el-unknown-linux-gnuabi64.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-mips64el-unknown-linux-gnuabi64.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-mips64el-unknown-linux-gnuabi64.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>mipsel-unknown-linux-gnu</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-mipsel-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-mipsel-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-mipsel-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-mipsel-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-mipsel-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-mipsel-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>powerpc-unknown-linux-gnu</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-powerpc-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-powerpc-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-powerpc-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-powerpc-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-powerpc-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-powerpc-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>powerpc64-unknown-linux-gnu</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-powerpc64-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-powerpc64-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-powerpc64-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-powerpc64-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-powerpc64-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-powerpc64-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>powerpc64le-unknown-linux-gnu</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-powerpc64le-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-powerpc64le-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-powerpc64le-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-powerpc64le-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-powerpc64le-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-powerpc64le-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>riscv64gc-unknown-linux-gnu</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-riscv64gc-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-riscv64gc-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-riscv64gc-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-riscv64gc-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-riscv64gc-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-riscv64gc-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>s390x-unknown-linux-gnu</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-s390x-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-s390x-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-s390x-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-s390x-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-s390x-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-s390x-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>x86_64-apple-darwin</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-apple-darwin.pkg">pkg</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-apple-darwin.pkg.asc">pkg.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-x86_64-apple-darwin.pkg">pkg</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-x86_64-apple-darwin.pkg.asc">pkg.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-apple-darwin.pkg">pkg</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-apple-darwin.pkg.asc">pkg.asc</a></td></tr>
<tr><td><code>x86_64-pc-windows-gnu</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-pc-windows-gnu.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-pc-windows-gnu.msi.asc">msi.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-x86_64-pc-windows-gnu.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-x86_64-pc-windows-gnu.msi.asc">msi.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-pc-windows-gnu.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-pc-windows-gnu.msi.asc">msi.asc</a></td></tr>
<tr><td><code>x86_64-pc-windows-msvc</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-pc-windows-msvc.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-pc-windows-msvc.msi.asc">msi.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-x86_64-pc-windows-msvc.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-x86_64-pc-windows-msvc.msi.asc">msi.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-pc-windows-msvc.msi">msi</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-pc-windows-msvc.msi.asc">msi.asc</a></td></tr>
<tr><td><code>x86_64-unknown-freebsd</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-freebsd.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-freebsd.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-freebsd.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-freebsd.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-freebsd.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-freebsd.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>x86_64-unknown-illumos</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-illumos.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-illumos.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-illumos.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-illumos.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-illumos.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-illumos.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>x86_64-unknown-linux-gnu</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-linux-gnu.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-linux-gnu.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>x86_64-unknown-linux-musl</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-linux-musl.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-linux-musl.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-linux-musl.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-linux-musl.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-linux-musl.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-linux-musl.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td><code>x86_64-unknown-netbsd</code></td><td><a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-netbsd.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-1.64.0-x86_64-unknown-netbsd.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-netbsd.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-beta-x86_64-unknown-netbsd.tar.gz.asc">tar.gz.asc</a></td><td><a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-netbsd.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-netbsd.tar.gz.asc">tar.gz.asc</a></td></tr>
</tbody></table>
</div>
<h2 id="source-code"><a class="header" href="#source-code">Source code</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Channel</th><th>Archives + Signatures</th></tr></thead><tbody>
<tr><td>stable (1.64.0)</td><td><a href="https://static.rust-lang.org/dist/rustc-1.64.0-src.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rustc-1.64.0-src.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td>beta</td><td><a href="https://static.rust-lang.org/dist/rustc-beta-src.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rustc-beta-src.tar.gz.asc">tar.gz.asc</a></td></tr>
<tr><td>nightly</td><td><a href="https://static.rust-lang.org/dist/rustc-nightly-src.tar.gz">tar.gz</a> <br> <a href="https://static.rust-lang.org/dist/rustc-nightly-src.tar.gz.asc">tar.gz.asc</a></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="the-rust-release-channel-layout"><a class="header" href="#the-rust-release-channel-layout">The Rust Release Channel Layout</a></h1>
<p><strong>NOTE</strong> This document should be considered incomplete and descriptive rather
than normative. Do not rely on anything described herein to be fully correct or
a definition of how things <em>should</em> be done.</p>
<p>A lot of the content herein is derived from
<a href="https://internals.rust-lang.org/t/future-updates-to-the-rustup-distribution-format/4196#the-static-rust-lang-org-layout">a posting made to the Rust internals forum by Brian Anderson back in 2016</a>.</p>
<p>Rust releases are deployed onto <code>static.rust-lang.org</code> where they are served via
<code>https</code>. There are several parts to a release channel (<code>stable</code>, <code>beta</code>,
<code>nightly</code>) but they all key off a manifest file and then go from there.</p>
<h2 id="channel-manifests"><a class="header" href="#channel-manifests">Channel manifests</a></h2>
<p>There is a top level directory <code>/dist/</code> which contains the channel manifests.
The manifests are named <code>channel-rust-[channelname].toml</code>. Each channel manifest
is accompanied by a <code>.sha256</code> file which is a checksum of the manifest file and
can be used to check integrity of the downloaded data. In addition each
channel's manifest is also accompanied by a <code>.asc</code> file which is a detached GPG
signature which can be used to check not only the integrity but also the
authenticity of the channel manifest.</p>
<p>In addition to the <code>stable</code>, <code>beta</code>, and <code>nightly</code> channels, there is also a
manifest for each release which will be called <code>channel-rust-x.yy.z.toml</code> with
its associated <code>.sha256</code> and <code>.asc</code> files.</p>
<p>To support date-based channels, there is an archive folder for each day
(labelled <code>YYYY-MM-DD</code>) which contains copies of the requisite channel files on
that day. So, for example, if you installed <code>nightly-2019-02-16</code> then the
channel file would be
<a href="https://static.rust-lang.org/dist/2019-02-16/channel-rust-nightly.toml">https://static.rust-lang.org/dist/2019-02-16/channel-rust-nightly.toml</a>.</p>
<h3 id="content-of-channel-manifests"><a class="header" href="#content-of-channel-manifests">Content of channel manifests</a></h3>
<p>Channel manifests are <code>toml</code> files. These are known as <em>v2</em> manifests. The <em>v1</em>
manifests are simply lists of the files associated with a release and are not
generated for every channel all of the time. Currently it is recommended to work
only with the <em>v2</em> manifests and these are the topic of this section.</p>
<p>The top level of the <code>.toml</code> file consists of two important key/value pairs.
Firstly the <code>manifest-version</code> which is, at this time, <code>&quot;2&quot;</code>, and secondly the
date of the manifest (<code>date</code>) whose value is of the form <code>&quot;YYYY-MM-DD&quot;</code>.</p>
<p>There are then a number of top level sections (tables) which are:</p>
<ul>
<li>
<p><code>pkg</code> - This contains the bulk of the manifest and lists the packages which
are part of the release. Typically this will be things like <code>rust</code>, <code>rustc</code>,
<code>cargo</code> etc. The <code>rust</code> package is semi-special and currently is used to
specify the subset of other packages which will be installed by default.</p>
<p>Within packages are <code>components</code> and <code>extensions</code>. Currently <code>components</code> are
installed by default by <code>rustup</code>, <code>extensions</code> are optional components and are
available via <code>rustup component add</code> and friends.</p>
</li>
<li>
<p><code>renames</code> - This contains a set of package renames which can be used to
determine the correct package to fetch when the user enters an alias for it.</p>
<p>Typically renames are used when a package leaves its preview state and is
considered to be release quality. For example, the actual package for
<code>rustfmt</code> is called <code>rustfmt-preview</code> but since its release there has been a
<code>renames.rustfmt</code> table whose <code>to</code> field is <code>rustfmt-preview</code>. When the user runs
<code>rustup component add rustfmt</code> the name is automatically translated to
<code>rustfmt-preview</code> and when the user runs <code>rustup component list</code> then
<code>rustfmt-preview</code> is automatically renamed back to <code>rustfmt</code> for display to
the user.</p>
</li>
<li>
<p><code>profiles</code> - This is part of the future setup for deciding the default
component set to install. Instead of choosing the <code>components</code> of <code>pkg.rust</code>
instead <code>rustup</code> will honor one of the entries in the <code>profiles</code> table.
Usually this will be the <code>default</code> entry which <em>essentially</em> (though not
exactly) boils down to
<code>[&quot;rustc&quot;, &quot;cargo&quot;, &quot;rust-std&quot;, &quot;rust-docs&quot;, &quot;rustfmt&quot;, &quot;clippy&quot;]</code>.</p>
<p>Other profiles include <code>minimal</code> (<code>[&quot;rustc&quot;, &quot;cargo&quot;, &quot;rust-std&quot;]</code>) and
<code>complete</code> which adds in additional things such as a copy of the
standard library source (<code>rust-src</code>), <code>miri</code>, <code>lldb</code>, <code>llvm-tools</code>, and
<code>rust-analysis</code>.</p>
</li>
</ul>
<h3 id="package-entries-in-the-channel-manifest"><a class="header" href="#package-entries-in-the-channel-manifest">Package entries in the channel manifest</a></h3>
<p>As stated above, packages list their components and extensions (mostly just the
<code>rust</code> package) and they can provide per-target tarball and sha256 data.</p>
<p>For example, a package might be:</p>
<pre><code class="language-toml">[pkg.cargo.target.powerpc64-unknown-linux-gnu]
available = true
url = &quot;https://static.rust-lang.org/dist/2019-05-23/cargo-0.36.0-powerpc64-unknown-linux-gnu.tar.gz&quot;
hash = &quot;279f3a84f40e3547a8532c64643f38068accb91c21f04cd16e46579c893f5a06&quot;
xz_url = &quot;https://static.rust-lang.org/dist/2019-05-23/cargo-0.36.0-powerpc64-unknown-linux-gnu.tar.xz&quot;
xz_hash = &quot;cf93b387508f4aea4e64f8b4887d70cc07a00906b981dc0c143e92e918682e4a&quot;
</code></pre>
<p>Here you can see that this is for the <code>cargo</code> package, and for the
<code>powerpc64-unknown-linux-gnu</code> target. The <code>url</code>/<code>hash</code> combo is for a <code>.tar.gz</code>
and the <code>xz_url</code>/<code>xz_hash</code> pair for the same tarball compressed with <code>xz</code>.
Either pair of url and hash could be present, both may be present, but it is not
useful for neither to be present unless <code>available</code> is set to <code>false</code> to
indicate that that particular combination of package and target is unavailable
in this channel at this time.</p>
<p>In addition, there will be a single entry providing the version for a package in
the form:</p>
<pre><code class="language-toml">[pkg.cargo]
version = &quot;0.36.0 (6f3e9c367 2019-04-04)&quot;
</code></pre>
<p>Here <code>version</code> will be effectively the <code>$tool --version</code> output, minus the
tool's name.</p>
<h2 id="targets"><a class="header" href="#targets">Targets</a></h2>
<p>Targets are the same triples you might use when building something with
<code>cargo build --target=$target</code> and you can add them to your installation using
<code>rustup target add $target</code>. When you do that, what <code>rustup</code> actually does is to
find the <code>rust-std</code> package for the target in question and installs that.
Essentially like an imaginary <code>rustup component add rust-std.$target</code>.</p>
<p>If a <code>rust-std</code> package for a target is not <code>available = true</code> then that target
cannot be installed via <code>rustup</code>. This can happen for lower tier targets from
time to time.</p>
<p>Since components and extensions are target-specific in the <code>pkg</code> tables, you
will be able to see that <code>rust-std</code> for every target is specified in every
<code>rust</code> target's extensions. This allows for cross-compilation by installation of
any <code>rust-std</code> on any build system.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service-infrastructure"><a class="header" href="#service-infrastructure">Service Infrastructure</a></h1>
<p>Most services in the Rust Infrastructure are deployed via
<a href="https://github.com/rust-lang/rust-central-station">rust-central-station</a>. Questions about infrastructure, including current
status, should go to the <a href="https://rust-lang.zulipchat.com/#narrow/stream/242791-t-infra">#t-infra Zulip stream</a>.</p>
<p><strong>Our stability guarantees</strong>: many of our services rely on publicly-accessible
storage and APIs, but not all of these are intended for public consumption. At
the moment, <strong>only the resources behind <code>static.rust-lang.org</code> are considered
stable</strong>, meaning that those resources will not change without (at least) prior
notice. If you are relying on other parts of the Rust project infrastructure for
your own work, please let the infrastructure team know.</p>
<h2 id="highfive"><a class="header" href="#highfive">Highfive</a></h2>
<p><a href="https://github.com/rust-lang/highfive">Highfive</a> is a bot
(<a href="https://github.com/rust-highfive">bot user account</a>) which welcomes newcomers
and assigns reviewers.</p>
<h2 id="rust-log-analyzer"><a class="header" href="#rust-log-analyzer">Rust Log Analyzer</a></h2>
<p>The <a href="https://github.com/rust-lang/rust-log-analyzer">Rust Log Analyzer</a>
analyzes CI build logs to extract error messages and posts them to the pull
request. It is run by <a href="https://github.com/TimNN">TimNN</a>.</p>
<h2 id="homu--bors"><a class="header" href="#homu--bors">Homu / bors</a></h2>
<p><a href="https://github.com/rust-lang/homu/">Homu</a> is a bot which manages pull
requests. It is often referred to as &quot;bors&quot; due to the name of its
<a href="https://github.com/bors">bot user account</a>.
Approved pull requests are placed in
<a href="http://bors.rust-lang.org/queue/rust">a queue</a> from which tests are
run.</p>
<p>Documentation on homu commands can be found
<a href="http://bors.rust-lang.org/">here</a>.</p>
<p>Please contact <a href="https://github.com/alexcrichton">Alex Crichton</a> if something
goes wrong with the bot.</p>
<h2 id="rfcbot"><a class="header" href="#rfcbot">rfcbot</a></h2>
<p><a href="https://github.com/rust-lang/rfcbot-rs">rfcbot</a> is a bot
(<a href="https://github.com/rfcbot">bot user account</a>) which helps manage async
decision making on issues and PRs (typically RFCs). Team members can view any
pending requests for review on <a href="https://rfcbot.rs/">the FCP dashboard</a>.</p>
<p>Documentation on rfcbot commands can be found
<a href="https://github.com/rust-lang/rfcbot-rs">in the rfcbot repository</a>.</p>
<h2 id="rustbot"><a class="header" href="#rustbot">rustbot</a></h2>
<p><a href="https://github.com/rust-lang/triagebot">rustbot</a> is a bot (<a href="https://github.com/rustbot">bot user
account</a>) to assist with managing issues and PRs
to allow users to label and assign without GitHub permissions. See <a href="https://github.com/rust-lang/triagebot/wiki">the
wiki</a> for more information.</p>
<h2 id="dxr"><a class="header" href="#dxr">DXR</a></h2>
<p><a href="https://dxr.mozilla.org/rust/source/">DXR</a> is a cross-referenced source index
for Rust, allowing the Rust source tree to be navigated and searched with ease.
It is generated by <a href="https://github.com/nrc/rust-dxr">rust-dxr</a></p>
<h2 id="perf--rust-timer"><a class="header" href="#perf--rust-timer">perf / rust-timer</a></h2>
<p><a href="https://github.com/rust-lang-nursery/rustc-perf">perf</a> offers information
about the performance of <code>rustc</code> over time, and a bot for on-demand benchmarking.</p>
<p>It is split into a data <a href="https://github.com/rust-lang-nursery/rustc-perf/tree/master/collector">collector</a> and a <a href="https://github.com/rust-lang-nursery/rustc-perf/tree/master/site">web frontend + bot</a>. The raw performance
data is available <a href="https://github.com/rust-lang-nursery/rustc-timing">here</a>
and can be browsed on the <a href="https://perf.rust-lang.org">perf website</a>.</p>
<p>One-off performance runs can done by addressing the
<a href="https://github.com/rust-lang-nursery/rustc-perf/blob/master/site/src/github.rs">rust-timer bot</a>
(<a href="https://github.com/rust-timer">bot user account</a>). You can trigger the
necessary try-build and queue a perf run by saying</p>
<pre><code>@bors try @rust-timer queue
</code></pre>
<p>(Technically, the requirement is that the <code>queue</code> command finishes executing prior
to the try build completing successfully.)</p>
<p>See the <a href="https://github.com/rust-lang/rustc-perf/tree/master/collector#benchmarking">documentation</a>
for further bot commands.</p>
<h2 id="rust-playground"><a class="header" href="#rust-playground">Rust Playground</a></h2>
<p><a href="https://github.com/integer32llc/rust-playground">Rust Playground</a> allows you
to experiment with Rust before you install it locally, or in any other case
where you might not have the compiler available. The Rust playground can be
accessed <a href="https://play.rust-lang.org">here</a>.</p>
<h2 id="crater"><a class="header" href="#crater">Crater</a></h2>
<p><a href="https://github.com/rust-lang/crater">Crater</a> is a tool to run
experiments across the whole Rust ecosystem. Its primary purpose is to detect
regressions in the Rust compiler, and it does this by building large number of
crates, running their test suites and comparing the results between two
versions of the Rust compiler.</p>
<p>Crates comes with a <a href="https://github.com/rust-lang/crater/blob/master/docs/bot-usage.md">bot to trigger experiments</a>.</p>
<h2 id="docsrs-1"><a class="header" href="#docsrs-1">docs.rs</a></h2>
<p><a href="https://docs.rs/">docs.rs</a> builds and serves the rustdoc documentation for
all crates on <a href="https://crates.io/">crates.io</a>. Issues may be filed on the <a href="https://github.com/rust-lang/docs.rs">docs.rs
repository</a>. See the #docs-rs channel on
Discord for discussion or urgent issues.</p>
<h2 id="toolstate"><a class="header" href="#toolstate">Toolstate</a></h2>
<p>The state of tools included with Rust are tracked on the <a href="https://rust-lang-nursery.github.io/rust-toolstate/">toolstate
page</a>. When each PR is
merged via CI, the status of each tool is recorded in a JSON file and stored
in the <a href="https://github.com/rust-lang-nursery/rust-toolstate">toolstate repo</a>.
For further information, see the <a href="infra/toolstate.html">toolstate system documentation</a>.</p>
<h2 id="rustup-components-history"><a class="header" href="#rustup-components-history">Rustup components history</a></h2>
<p>The <a href="https://rust-lang.github.io/rustup-components-history/">rustup components
history</a> tracks the
status of every rustup component for every platform over time. See <a href="https://github.com/rust-lang/rustup-components-history">the
repository</a> for more
information.</p>
<h2 id="ci-timing-tracker"><a class="header" href="#ci-timing-tracker">CI Timing Tracker</a></h2>
<p>The <a href="https://alexcrichton.github.io/rust-ci-timing-tracker/">CI Timing
Tracker</a> tracks and
compares how long CI jobs take over time. It is run by <a href="https://github.com/alexcrichton/rust-ci-timing-tracker">Alex
Crichton</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="team-maintenance"><a class="header" href="#team-maintenance">Team Maintenance</a></h1>
<p>The roster of the Rust teams is always in flux. From time to time, new people
are added, but also people sometimes opt to into &quot;alumni status&quot;, meaning that
they are not currently an active part of the decision-making process.
Unfortunately, whenever a new person is added or someone goes into alumni
status, there are a number of disparate places that need to be updated. This
page aims to document that list. If you have any questions, or need someone with
more privileges to make a change for you, a good place to ask is <code>#infra</code> on
Discord.</p>
<h3 id="team-repo"><a class="header" href="#team-repo">Team repo</a></h3>
<p>Membership of teams is primarily driven by the config files in the
<a href="https://github.com/rust-lang/team/tree/master/teams">rust-lang/team repo</a>. Several systems use the team repo data to
control access:</p>
<ul>
<li>the <a href="https://www.rust-lang.org/governance">team website</a></li>
<li>bors r+ rights</li>
<li>rfcbot interaction</li>
<li>Mailgun email lists</li>
</ul>
<p>Team membership is duplicated in a few other places listed below, but the
long-term goal is to centralize on the team repo.</p>
<h3 id="full-team-membership"><a class="header" href="#full-team-membership">Full team membership</a></h3>
<p>To make a full team member, the following places need to be modified:</p>
<ul>
<li>the <a href="https://github.com/rust-lang/team/tree/master/teams">team repo</a></li>
<li>the <a href="https://github.com/orgs/rust-lang/teams">rust-lang/TEAM</a> and (in some cases)
<a href="https://github.com/orgs/rust-lang-nursery/teams">rust-lang-nursery/TEAM</a> teams on github must be updated</li>
<li>the
<a href="https://internals.rust-lang.org/admin/groups/custom">internals discussion board has per-team groups</a></li>
<li>the list of reviewers highfive uses is set in <a href="https://github.com/rust-lang/highfive/tree/master/highfive/configs">rust-lang/highfive</a>
<ul>
<li>the configs are set per-repo; some teams are listed in <code>rust.json</code>, whereas
those that span multiple repos are set in <code>_global.json</code></li>
</ul>
</li>
</ul>
<h3 id="team-member-departure"><a class="header" href="#team-member-departure">Team member departure</a></h3>
<p>Remove the team member from any and all places:</p>
<ul>
<li><a href="https://github.com/rust-lang/highfive/tree/master/highfive/configs">highfive</a></li>
<li>1password</li>
<li>The <a href="https://github.com/orgs/rust-lang/teams">GitHub team</a>, <a href="https://github.com/orgs/rust-lang-nursery/teams">GitHub nursery team</a></li>
<li><a href="https://github.com/rust-lang/team/tree/master/teams">team repo</a></li>
<li><a href="https://github.com/rust-lang/rust/blob/master/src/tools/publish_toolstate.py">toolstate notifications</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="handling-of-tools-embedded-in-the-rustc-repo-toolstate"><a class="header" href="#handling-of-tools-embedded-in-the-rustc-repo-toolstate">Handling of tools embedded in the rustc repo (&quot;toolstate&quot;)</a></h1>
<p>The Rust repository contains several external tools and documents as git
submodules (e.g. miri, the <a href="https://doc.rust-lang.org/book/">Book</a>, the <a href="https://doc.rust-lang.org/reference/">Reference</a>). Some of those are
very tightly coupled to the compiler and depend on internal APIs that change all
the time, but they are not actually essential to get the compiler itself to
work. To make API changes less painful, these tools are allowed to &quot;break&quot;
temporarily. PRs can still land and nightlies still get released even when some
tools are broken. Their current status is managed by the
<a href="https://rust-lang-nursery.github.io/rust-toolstate/">toolstate system</a>. (Cargo is not subject to the toolstate system and
instead just has to always work.)</p>
<p>The three possible states of a &quot;tool&quot; (this includes the documentation managed
by the toolstate system, where we run doctests) are: <code>test-pass</code>, <code>test-fail</code>,
<code>build-fail</code>.</p>
<p>This page gives a rough overview how the toolstate system works, and what the
rules are for when which tools are (not) allowed to break.</p>
<h2 id="toolstate-rules"><a class="header" href="#toolstate-rules">Toolstate Rules</a></h2>
<ul>
<li>
<p>For all tools, if a PR changes that tool (if it changes the commit used by the
submodule), the tool has to be in <code>test-pass</code> after this PR or else CI will
fail.</p>
</li>
<li>
<p>For all tools except for &quot;nightly only&quot; tools, the following extra rules are applied:</p>
<ul>
<li>If a PR lands on the <code>beta</code> or <code>stable</code> branch, the tool has to be <code>test-pass</code>.</li>
<li>If a PR lands on <code>master</code> in the week before the beta is cut, and that PR
regresses the tool (if it makes the state &quot;worse&quot;), CI fails. This is to
help make sure all these tools become <code>test-pass</code> so that a beta can be
cut. (See the <a href="infra/../index.html">Forge index</a> for when the next beta cutoff is
happening.)</li>
</ul>
<p>At the time of writing, the following tools are &quot;nightly only&quot;:
miri, embedded-book.</p>
</li>
</ul>
<h2 id="updating-the-toolstate-repository"><a class="header" href="#updating-the-toolstate-repository">Updating the toolstate repository</a></h2>
<p>Updating the <a href="https://github.com/rust-lang-nursery/rust-toolstate/">toolstate repository</a> happens in two steps: when CI
runs on the <code>auto</code> branch (where bors moves a PR to test if it is good for
integration), the &quot;tool&quot; runners for the individual platforms (at the time of
writing, Linux and Windows) each submit a JSON file to the repository recording
the state of each tool for the commit they are testing. Later, if that commit
actually entirely passed CI and bors moves it to the <code>master</code> branch, the
&quot;current tool status&quot; in the toolstate repository is updated appropriately.</p>
<p>These scripts also automatically ping some people and create issues when tools
break.</p>
<p>For further details, see the comments in the involved files: <a href="https://github.com/rust-lang/rust/blob/master/src/ci/docker/x86_64-gnu-tools/checktools.sh"><code>checktools.sh</code></a>,
<a href="https://github.com/rust-lang/rust/blob/master/src/tools/publish_toolstate.py"><code>publish_toolstate.py</code></a> as well as the other files mentioned there.</p>
<h2 id="updating-tools"><a class="header" href="#updating-tools">Updating tools</a></h2>
<p>Tools can be updated by updating the submodule to the proper commit.</p>
<p>Run <code>git submodule update --remote path/to/submodule</code>, add the updates, make
sure the tests pass, commit, and send a pull request. The path is from the
root of the rust repository, so for example, the reference is
<code>src/doc/reference</code> and miri is <code>src/tools/miri</code>.</p>
<p>While not required, <a href="https://github.com/ehuss/subup">subup</a> may assist you with this.</p>
<h2 id="adding-a-tool"><a class="header" href="#adding-a-tool">Adding a tool</a></h2>
<p><strong>NOTE</strong>: We are trying to switch away from submodules and toolstate over time.
Consider adding a subtree instead of a submodule: <a href="https://github.com/rust-lang/rust/issues/70651">#70651</a></p>
<p>To add a new tool to be tracked, the following steps must be taken:</p>
<ol>
<li>Create a PR to rust-lang/rust that adds the submodule along with any
necessary build system / bootstrap updates. Be careful that the tests
properly support <code>./x.py --no-fail-fast</code> to avoid
<a href="https://github.com/rust-lang/rust/pull/63089">issues like this</a>.</li>
<li>Include changes to <a href="https://github.com/rust-lang/rust/blob/master/src/ci/docker/x86_64-gnu-tools/checktools.sh"><code>checktools.sh</code></a>:
<ul>
<li>Build the tool at the top. This is the step that actually generates the
JSON status for the tool. When <code>save-toolstates</code> is set in
<code>config.toml</code>, the rust build system will write a JSON file with the
status of each test.</li>
<li>Add the tool to <code>status_check</code> with whether it should be a beta blocker
or not.</li>
</ul>
</li>
<li>Update <a href="https://github.com/rust-lang/rust/blob/master/src/tools/publish_toolstate.py"><code>publish_toolstate.py</code></a> to add the tool. This includes a list of
people to ping if the tool is broken, and its source repo. (Note: At the
time of this writing, these users must have permissions to be assignable on
rust-lang/rust GitHub.)</li>
<li>Submit a PR to the <a href="https://github.com/rust-lang-nursery/rust-toolstate/">toolstate repository</a> to manually add the tool to the
<a href="https://github.com/rust-lang-nursery/rust-toolstate/blob/master/_data/latest.json"><code>latest.json</code></a> file.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="policies-of-the-infrastructure-team"><a class="header" href="#policies-of-the-infrastructure-team">Policies of the infrastructure team</a></h1>
<p>This section documents the policies created by the infrastructure team.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="policy-on-broken-nightlies"><a class="header" href="#policy-on-broken-nightlies">Policy on broken nightlies</a></h1>
<p>Sometimes the nightlies released automatically by our CI ends up being broken
for some people or even everyone. This policy defines what the infra team
response will be in those cases.</p>
<h2 id="which-nightly-will-be-rolled-back"><a class="header" href="#which-nightly-will-be-rolled-back">Which nightly will be rolled back</a></h2>
<p>A nightly can only be rolled back in the following cases:</p>
<ul>
<li>If it contains destructive code, for example if the included compiler deletes
all the users files.</li>
<li>If an infra problem caused it to be broken for a big percentage of users on
any Tier 1 platform. Issues affecting only lower tier platforms are not
worthy of a roll back, since we don't guarantee working builds for those
platforms anyway.</li>
</ul>
<p>A nightly will <strong>not</strong> be rolled back if it's broken by a critical compiler
bug: those bugs are supposed to be caught by CI, and nightly can have compiler
regressions anyway. There are no exceptions, even if big projects are broken
because of this.</p>
<h2 id="what-are-we-going-to-fix"><a class="header" href="#what-are-we-going-to-fix">What are we going to fix</a></h2>
<p>Once any member of the infra team decides to roll back a nightly under this
policy we will roll back to the most recent working nightly. The roll back has
to fix installing the nightly with rustup:</p>
<pre><code>$ rustup toolchain install nightly
</code></pre>
<p>It's not required to roll back other things like the documentation or the
manually downloadable artifacts. After the nightly is rolled back we have to
announce the roll back on the <code>@rustlang</code> twitter account and on the status
page.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="infrastructure-guidelines"><a class="header" href="#infrastructure-guidelines">Infrastructure guidelines</a></h1>
<p>This section contains the guidelines written by the infrastructure team for
other teams who want to use the project's infrastructure.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-infrastructure-hosting-for-static-websites"><a class="header" href="#rust-infrastructure-hosting-for-static-websites">Rust Infrastructure hosting for static websites</a></h1>
<p>The Rust Infrastructure team provides hosting for static websites available for
all Rust teams. This document explains the requirements a website needs to meet
and how to setup one.</p>
<h2 id="requirements-for-hosting-websites"><a class="header" href="#requirements-for-hosting-websites">Requirements for hosting websites</a></h2>
<ul>
<li><strong>The website must be managed by a Rust team, or be officially affiliated with
the project.</strong><br />
The infrastructure team has finite resources and we can't offer hosting for
community projects.</li>
<li><strong>The website’s content and build tooling must be hosted on a GitHub
repository in either the <a href="https://github.com/rust-lang">rust-lang</a> or
<a href="https://github.com/rust-lang-nursery">rust-lang-nursery</a> organizations.</strong><br />
The infrastructure team must be able to rebuild the website content at any
time (for example if we need to switch hosting), and having it hosted on a
GitHub repository inside infra-managed organizations is the best way for us
to ensure that. Even though we'd prefer for all the repositories to be public
it's not a requirement.</li>
<li><strong>The website must be built and deployed with a CI service.</strong><br />
We have custom tooling built around hosting static websites on our infra, and
at the moment they work with Travis CI and Azure Pipelines. If you need
different CI services ask us in advance and we'll adapt the tooling to your
provider of choice.</li>
<li><strong>The website must reach an A+ grade on the
<a href="https://observatory.mozilla.org/">Mozilla Observatory</a>.</strong><br />
Browsers have multiple security features toggleable only through HTTP
response headers, and those features enhance users' privacy and prevent
exploits from working. An A+ grade on the Observatory indicates all the
important headers are correctly set.</li>
<li><strong>The website must be hosted on platforms vetted by the infra team.</strong><br />
We recommend either GitHub Pages or Amazon S3 (in the rust-lang AWS account)
as the hosting and CloudFront as the CDN, but if you need other platforms
that's good as long as we consider them secure and reliable.</li>
</ul>
<h2 id="static-websites-configuration"><a class="header" href="#static-websites-configuration">Static websites configuration</a></h2>
<p>To avoid limitations of some hosting providers we have setup CloudFront to
enable additional, custom behaviors. These behaviors are configured through a
file named <code>website_config.json</code> at the root of the generated website content.</p>
<h3 id="adding-custom-headers"><a class="header" href="#adding-custom-headers">Adding custom headers</a></h3>
<p>One of the requirements for having a static website hosted by the
infrastructure team is to reach an A+ grade on the <a href="https://observatory.mozilla.org/">Mozilla
Observatory</a>, and that requires custom
headers to be set. To setup custom headers you need to add an <code>headers</code> section
to <code>website_config.json</code>. This example content includes all the headers
needed to reach grade B on the Observatory (to reach grade A+ a Content
Security Policy is required):</p>
<pre><code class="language-json">{
    &quot;headers&quot;: {
        &quot;Strict-Transport-Security&quot;: &quot;max-age=63072000&quot;,
        &quot;X-Content-Type-Options&quot;: &quot;nosniff&quot;,
        &quot;X-Frame-Options&quot;: &quot;DENY&quot;,
        &quot;X-XSS-Protection&quot;: &quot;1; mode=block&quot;,
        &quot;Referrer-Policy&quot;: &quot;no-referrer, strict-origin-when-cross-origin&quot;
    }
}
</code></pre>
<h3 id="fixing-github-pages-redirects"><a class="header" href="#fixing-github-pages-redirects">Fixing GitHub Pages redirects</a></h3>
<p>GitHub Pages behaves weirdly when it sits behind CloudFront and it needs to
issue redirects: since it doesn't know the real domain name it will use
<code>http://org-name.github.io/repo-name</code> as the base of the redirect instead of
the correct protocol and domain. To prevent this behavior the
<code>github_pages_origin</code> key needs to be added to <code>website_config.json</code>
with the origin base url as the value (excluding the protocol):</p>
<pre><code class="language-json">{
    &quot;github_pages_origin&quot;: &quot;org-name.github.io/repo-name&quot;
}
</code></pre>
<h2 id="deployment-guide"><a class="header" href="#deployment-guide">Deployment guide</a></h2>
<p>These deployments steps are meant to be executed by a member of the
infrastructure team since they require access to our AWS account.</p>
<h3 id="configuring-aws"><a class="header" href="#configuring-aws">Configuring AWS</a></h3>
<p>Create a CloudFront web distribution and set the following properties:</p>
<ul>
<li><strong>Origin Domain Name:</strong> rust-lang.github.io/repo-name</li>
<li><strong>Origin Protocol Policy:</strong> HTTPS Only</li>
<li><strong>Viewer Protocol Policy:</strong> Redirect HTTP to HTTPS</li>
<li><strong>Lambda Function Association:</strong>
<ul>
<li><strong>Viewer Response:</strong> arn:aws:lambda:us-east-1:890664054962:function:static-websites:4</li>
</ul>
</li>
<li><strong>Alternate Domain Names:</strong> your-subdomain-name.rust-lang.org</li>
<li><strong>SSL Certificate:</strong> Custom SSL Certificate
<ul>
<li>You will need to request the certificate for that subdomain name through
ACM (please use the DNS challenge to validate the certificate)</li>
</ul>
</li>
<li><strong>Comment:</strong> your-subdomain-name.rust-lang.org</li>
</ul>
<p>Wait until the distribution is propagated and take note of its
<code>.cloudfront.net</code> domain name.</p>
<p>Head over to the domain’s Route 53 hosted zone and create a new record set:</p>
<ul>
<li><strong>Name:</strong> your-subdomain-name</li>
<li><strong>Type:</strong> CNAME</li>
<li><strong>Value:</strong> the <code>.cloudfront.net</code> domain name you saw earlier</li>
</ul>
<p>Create an AWS IAM user to allow the CI provider used to deploy website changes
to perform whitelisted automatic actions. Use <code>ci--ORG-NAME--REPO-NAME</code> (for
example <code>ci--rust-lang--rust</code>) as the user name, allow programmatic access to
it and add it to the <code>ci-static-websites</code> IAM group. Then take note of the
access key id and the secret access key since you’ll need those later.</p>
<h3 id="adding-deploy-keys"><a class="header" href="#adding-deploy-keys">Adding deploy keys</a></h3>
<p>To deploy websites we don’t use GitHub tokens (since they don’t have granular
access scoping) but a deploy key with write access unique for each repository.
To setup the deploy key you need to be an administrator on the repository,
clone the <a href="https://github.com/rust-lang/simpleinfra">simpleinfra</a> repository
and run this command:</p>
<pre><code>$ cargo run --bin setup-deploy-keys rust-lang/repo-name
</code></pre>
<p>The command requires the <code>GITHUB_TOKEN</code> (<a href="https://github.com/settings/tokens">you can generate one
here</a>) and the <code>TRAVIS_TOKEN</code> (<a href="https://travis-ci.com/account/preferences">you can see
yours here</a>) to be present. It will
generate a brand new key, upload it to GitHub and configure Travis CI to use
it if the repo is active there.</p>
<h3 id="configuring-travis-ci"><a class="header" href="#configuring-travis-ci">Configuring Travis CI</a></h3>
<p>To actually deploy the website, this snippet needs to be added to your
<code>.travis.yml</code> (please replace the contents of <code>RUSTINFRA_DEPLOY_DIR</code> and
<code>RUSTINFRA_CLOUDFRONT_DISTRIBUTION</code>):</p>
<pre><code class="language-yaml">env:
  RUSTINFRA_DEPLOY_DIR: path/to/be/deployed
  RUSTINFRA_CLOUDFRONT_DISTRIBUTION: ABCDEFGHIJKLMN
import:
  - rust-lang/simpleinfra:travis-configs/static-websites.yml
</code></pre>
<p>You will also need to set the contents of the <code>AWS_ACCESS_KEY_ID</code> and
<code>AWS_SECRET_ACCESS_KEY</code> environment variables on the Travis CI web UI with the
credentials of the IAM user you created earlier. The secret access key <strong>must</strong>
be hidden from the build log, while the access key id should be publicly
visible.</p>
<h3 id="configuring-azure-pipelines"><a class="header" href="#configuring-azure-pipelines">Configuring Azure Pipelines</a></h3>
<p>To actually deploy the website, this snippet needs to be added at the top of
your pipeline's YAML file:</p>
<pre><code class="language-yaml">resources:
  repositories:
    - repository: rustinfra
      type: github
      name: rust-lang/simpleinfra
      endpoint: rust-lang
</code></pre>
<p>Then you can add this steps when you want to execute the deploy (please replace
the contents of <code>deploy_dir</code> and <code>cloudfront_distribution</code>):</p>
<pre><code class="language-yaml">- template: azure-configs/static-websites.yml@rustinfra
  parameters:
    deploy_dir: path/to/output
    # Optional, only needed if GitHub pages is behind CloudFront
    cloudfront_distribution: AAAAAAAAAAAAAA
</code></pre>
<p>You will also need to set the following environment variables in the pipeline:</p>
<ul>
<li><code>GITHUB_DEPLOY_KEY</code>: value outputted when adding the deploy key earlier
(<strong>secret</strong>)</li>
<li><code>AWS_ACCESS_KEY_ID</code>: access key ID of the IAM user allowed to invalidate
CloudFront (public)</li>
<li><code>AWS_SECRET_ACCESS_KEY</code>: access key of the IAM user allowed to invalidate
CloudFront (<strong>secret</strong>)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="infrastructure-team-documentation"><a class="header" href="#infrastructure-team-documentation">Infrastructure team documentation</a></h1>
<p>This section contains the documentation about the services hosted and managed
by the Rust Infrastructure Team. Most of the linked resources and instructions
are only available to infra team members though.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="aws-access-for-team-members"><a class="header" href="#aws-access-for-team-members">AWS access for team members</a></h1>
<p>Selected members of the Rust Team have access to the AWS account of the
project. This includes both members of the Infrastructure Team and members of
teams with services hosted on AWS.</p>
<p>This document explains how to access our AWS account, and how to interact with
it. If you're a infrastructure team member and you need to setup or revoke
access for another person, read the <a href="infra/docs/./aws-access-management.html">&quot;AWS access
management&quot;</a> page.</p>
<h2 id="setting-up-your-user-after-receiving-the-credentials"><a class="header" href="#setting-up-your-user-after-receiving-the-credentials">Setting up your user after receiving the credentials</a></h2>
<p>The first thing you need to do after receiving your credentials is changing the
password and enabling 2-factor authentication: until you do these things,
access will be restricted automatically to just the permissions needed to
configure 2FA.</p>
<p><a href="https://rust-lang.signin.aws.amazon.com/console">Sign into the console</a> with the temporary credentials given to
you by the infrastructure team member who created the user. You'll be prompted
to change the temporary password: change it and log in again. Then, go to the
&quot;My Security Credentials&quot; page, located in the dropdown at the top:</p>
<p><img src="infra/docs/aws-security-credentials.png" alt="Location of the &quot;My Security Credentials&quot; page" /></p>
<p>Scroll down and click the &quot;Assign MFA device&quot; button. Choose &quot;Virtual MFA
device&quot; (which is classic TOTP) and configure it with your authenticator app.
Once you're done, log out of the console and log in again to gain access to the
resources you're authorized to use.</p>
<p>Do not choose &quot;U2F security key&quot;, even if you own one: due to limitations of
the AWS API, that would prevent you from using the CLI, restricting your access
to the console alone.</p>
<h2 id="using-the-aws-console"><a class="header" href="#using-the-aws-console">Using the AWS console</a></h2>
<p>The AWS console provides a visual interface to most of the resources in our AWS
account.</p>
<center>
<p><a href="https://rust-lang.signin.aws.amazon.com/console">Sign into the console.</a></p>
</center>
<h2 id="using-the-aws-cli"><a class="header" href="#using-the-aws-cli">Using the AWS CLI</a></h2>
<p>The <a href="https://aws.amazon.com/cli/">AWS CLI</a> allows you to interact with our AWS
account from a terminal or a script. To set it up the first time, follow
Amazon's documentation to <a href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv1.html">install it</a> and <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html">configure your
credentials</a>. The CLI doesn't use your console password to
authenticate: you'll need to create an access key from the &quot;My Security
Credentials&quot; page on the console.</p>
<h3 id="2-factor-authentication"><a class="header" href="#2-factor-authentication">2-factor authentication</a></h3>
<p>To ensure the security of our AWS account, 2-factor authentication is required
to interact with the CLI. The Infrastructure Team developed <a href="https://github.com/rust-lang/simpleinfra/blob/master/aws-creds.py">a
script</a> that eases the authentication process by creating a
temporary session validated with 2FA for the current shell. The session expires
in 12 hours, and it's valid for an unlimited number of invocations.</p>
<p>To use the script, clone the <a href="https://github.com/rust-lang/simpleinfra">rust-lang/simpleinfra</a> repository in
a directory. Then, every time you need to use the AWS CLI run this command in
your shell:</p>
<pre><code>eval $(~/PATH/TO/SIMPLEINFRA/aws-creds.py)
</code></pre>
<p>That command will prompt you for your 2FA code, and it will set a few
environment variables in the current shell with the temporary credentials.
You'll need to run the command again after 12 hours, or if you want the
credentials on another shell.</p>
<h3 id="plaintext-credentials"><a class="header" href="#plaintext-credentials">Plaintext credentials</a></h3>
<p>By default, AWS CLI stores your credentials (including the secret key) in the
<code>~/.aws/credentials</code> file, without any kind of encryption. While the danger of
having plaintext credentials stored in your home directory is partially
mitigated by the 2FA requirement, it'd be best not to store them anyway.</p>
<p>If you use a password manager with a CLI interface, an approach you can take to
avoid the problem is to store your credentials in the password manager, and
configure the CLI to <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sourcing-external.html">call your password manager</a> to fetch
the credentials when needed.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="aws-access-management"><a class="header" href="#aws-access-management">AWS access management</a></h1>
<p>This document explains how to setup and manage AWS access for Rust team
members. If you're a team member and you need to access AWS with your existing
credentials, or you have received your credentials for the first time, check
out the <a href="infra/docs/./aws-access.html">&quot;AWS access for team members&quot;</a> page.</p>
<h2 id="granting-access"><a class="header" href="#granting-access">Granting access</a></h2>
<p>To grant access to a person, go to <a href="https://github.com/rust-lang/simpleinfra/blob/master/terraform/team-members-access/_users.tf"><code>team-members-access/_users.tf</code></a> in the
Terraform configuration and add the new user to it, specifying which teams they
should be a member of. The user will be created as soon as you apply the
configuration.</p>
<p>By default, there will be no credentials attached to the user. To allow the
user to log in, go to the <a href="https://console.aws.amazon.com/iam/home#/users">IAM console</a>, open the security
credentials page of the user you just created, and enable a console password.
Let AWS generate a random one, and require the password to be changed on first
login.</p>
<p>Finally communicate to the user that they can join with the generated password,
and to follow the <a href="infra/docs/./aws-access.html">&quot;AWS access for team members&quot;</a> page to
learn how to enable 2FA and gain access to their account.</p>
<h2 id="revoking-access"><a class="header" href="#revoking-access">Revoking access</a></h2>
<p>To revoke access from a person, log into the <a href="https://console.aws.amazon.com/iam/home#/users">IAM console</a>,
open the security credentials page of the user you want to delete, and:</p>
<ul>
<li>Disable console access by clicking &quot;Manage&quot; on the console password</li>
<li>Disable 2-factor authentication by clicking &quot;Manage&quot; on the assigned MFA
device</li>
<li>Remove all the access keys, including inactive ones, by clicking the &quot;x&quot;.</li>
</ul>
<p>Once all the access was removed from the console, go to
<a href="https://github.com/rust-lang/simpleinfra/blob/master/terraform/team-members-access/_users.tf"><code>team-members-access/_users.tf</code></a> in the Terraform configuration, remove
the user and apply the configuration.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bastion-server"><a class="header" href="#bastion-server">Bastion server</a></h1>
<ul>
<li>FQDN: <code>bastion.infra.rust-lang.org</code></li>
<li><a href="https://github.com/rust-lang/simpleinfra/blob/master/ansible/playbooks/bastion.yml">Ansible playbook</a> to deploy this server.</li>
<li><a href="https://github.com/rust-lang/simpleinfra/tree/master/terraform/bastion">Terraform configuration</a> to create AWS resources.</li>
<li><a href="https://grafana.rust-lang.org/d/rpXrFfKWz/instance-metrics?orgId=1&amp;var-instance=bastion.infra.rust-lang.org:9100">Instance metrics</a> (only available to infra team members).</li>
</ul>
<h2 id="logging-into-servers-through-the-bastion"><a class="header" href="#logging-into-servers-through-the-bastion">Logging into servers through the bastion</a></h2>
<p>To improve the security of our infrastructure it's not possible to connect
directly to a production server with SSH. Instead, all connections must come
from a small server called the &quot;bastion&quot;, which only allows connections from a
few whitelisted networks and logs any connection attempt.</p>
<p>To log into a server through the bastion you can use SSH's <code>-J</code> flag:</p>
<pre><code>ssh -J bastion.infra.rust-lang.org servername.infra.rust-lang.org
</code></pre>
<p>It's also possible to configure SSH to always jump through the bastion when
connecting to a host. Add this snippet to your SSH configuration file (usually
located in <code>~/.ssh/config</code>):</p>
<pre><code>Host servername.infra.rust-lang.org
    ProxyJump bastion.infra.rust-lang.org
</code></pre>
<p>Please remember the bastion server only allows connections from a small list of
IP addresses. Infra team members with AWS access can change the whitelist, but
it's good practice to either have your own bastion server or a static IP
address.</p>
<p>The SSH keys authorized to log into each account are stored in the <a href="https://github.com/rust-lang/simpleinfra/tree/master/ansible/roles/common/files/ssh-keys">simpleinfra
repository</a>. Additionally, people with sensitive 1password access can use
the master key stored in the vault to log into every account, provided their
connection comes from any whitelisted IP.</p>
<h2 id="common-maintenance-procedures-1"><a class="header" href="#common-maintenance-procedures-1">Common maintenance procedures</a></h2>
<h3 id="adding-a-new-user-to-the-bastion-server"><a class="header" href="#adding-a-new-user-to-the-bastion-server">Adding a new user to the bastion server</a></h3>
<p>To add a new user to the bastion you need to add its key to a file named
<code>&lt;username&gt;.pub</code> in <a href="https://github.com/rust-lang/simpleinfra/tree/master/ansible/roles/common/files/ssh-keys"><code>ansible/roles/common/files/ssh-keys</code></a>, and change
the <a href="https://github.com/rust-lang/simpleinfra/blob/master/ansible/playbooks/bastion.yml">Ansible playbook</a> adding the user to the list of unprivileged
users. Please leave a comment clarifying which servers the user will have
access to.</p>
<p>Once that's done <a href="https://github.com/rust-lang/simpleinfra/blob/master/ansible/README.md#executing-a-playbook">apply the playbook</a> and <a href="infra/docs/bastion.html#adding-a-whitelisted-ip">add a new whitelisted
IP address</a>.</p>
<h3 id="adding-a-whitelisted-ip"><a class="header" href="#adding-a-whitelisted-ip">Adding a whitelisted IP</a></h3>
<p>Due to privacy reasons, all the static IP addresses of team members with access
to the bastion are stored on <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html">AWS SSM Parameter Store</a> instead of public
git repositories. To add an IP address you can run this command (taking care of
replacing <code>USERNAME</code> and <code>IP_ADDRESS</code> with the proper values):</p>
<pre><code>aws ssm put-parameter --type String --name &quot;/prod/bastion/allowed-ips/USERNAME&quot; --value &quot;IP_ADDRESS/32&quot;
</code></pre>
<p>You'll also need to add the username to the list in
<a href="https://github.com/rust-lang/simpleinfra/blob/master/terraform/bastion/firewall.tf"><code>terraform/bastion/firewall.tf</code></a> (local variable
<code>allowed_users</code>). Once you made all the needed changes you wanted you need to
<a href="https://github.com/rust-lang/simpleinfra/tree/master/terraform#applying-the-configuration">apply the Terraform configuration</a>.</p>
<h3 id="updating-a-whitelisted-ip"><a class="header" href="#updating-a-whitelisted-ip">Updating a whitelisted IP</a></h3>
<p>Due to privacy reasons, all the static IP addresses of team members with access
to the bastion are stored on <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html">AWS SSM Parameter Store</a> instead of public
git repositories. To update an IP address you can run this command (taking care
of replacing <code>USERNAME</code> and <code>IP_ADDRESS</code> with the proper values):</p>
<pre><code>aws ssm put-parameter --overwrite --type String --name &quot;/prod/bastion/allowed-ips/USERNAME&quot; --value &quot;IP_ADDRESS/32&quot;
</code></pre>
<p>Once you made all the needed changes you wanted you need to <a href="https://github.com/rust-lang/simpleinfra/tree/master/terraform#applying-the-configuration">apply the
Terraform configuration</a>.</p>
<h3 id="removing-a-whitelisted-ip"><a class="header" href="#removing-a-whitelisted-ip">Removing a whitelisted IP</a></h3>
<p>Due to privacy reasons, all the static IP addresses of team members with access
to the bastion are stored on <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html">AWS SSM Parameter Store</a> instead of public
git repositories. To remove an IP address you can run this command (taking care
of replacing <code>USERNAME</code> with the proper value):</p>
<pre><code>aws ssm delete-parameter --name &quot;/prod/bastion/allowed-ips/USERNAME&quot;
</code></pre>
<p>You'll also need to remove the username from the list in
<a href="https://github.com/rust-lang/simpleinfra/blob/master/terraform/bastion/firewall.tf"><code>terraform/bastion/firewall.tf</code></a> (local variable
<code>allowed_users</code>). Once you made all the needed changes you wanted you need to
<a href="https://github.com/rust-lang/simpleinfra/tree/master/terraform#applying-the-configuration">apply the Terraform configuration</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bors-1"><a class="header" href="#bors-1">Bors</a></h1>
<p>The infrastructure team manages an instance of <a href="https://github.com/rust-lang/homu">Homu</a> called &quot;Bors&quot;, to be used
by repositories inside the <code>rust-lang</code> organization. The instance is available
at <a href="https://bors.rust-lang.org">bors.rust-lang.org</a>, and is backed by the <a href="https://github.com/bors">@bors</a> GitHub account.</p>
<p>The service is configured <a href="https://github.com/rust-lang/simpleinfra/tree/master/terraform/bors/">with Terraform</a>, and it's automatically deployed
from the <a href="https://github.com/rust-lang/homu">rust-lang/homu</a> repository onto our <a href="infra/docs/./ecs-service.html">ECS cluster</a>.</p>
<h2 id="maintenance-procedures"><a class="header" href="#maintenance-procedures">Maintenance procedures</a></h2>
<h3 id="fixing-inconsistencies-in-the-queue"><a class="header" href="#fixing-inconsistencies-in-the-queue">Fixing inconsistencies in the queue</a></h3>
<p>Homu is quite buggy, and it might happen that the queue doesn't reflect the
actual state in the repositories. This can be fixed by pressing the
&quot;Synchronize&quot; button in the queue page. Note that the synchronization process
itself is a bit buggy, and it might happen that PRs which were approved but
failed are re-approved again on their own.</p>
<h3 id="adding-a-new-repository-to-bors"><a class="header" href="#adding-a-new-repository-to-bors">Adding a new repository to bors</a></h3>
<p>There are multiple steps needed to add a repository to our Bors instance:</p>
<ol>
<li>
<p>The <a href="https://github.com/bors">@bors</a> GitHub account needs to be granted write access to the
repository.</p>
</li>
<li>
<p>Each CI provider needs to have a single GitHub Check Run to gate on. This is
not provided by default on GitHub Actions, but it can be simulated with
these two jobs, which will generate a <code>bors build finished</code> check:</p>
<pre><code class="language-yaml">end-success:
  name: bors build finished
  if: success()
  runs-on: ubuntu-latest
  needs: [ALL, OTHER, JOBS]
  steps:
    - name: Mark the job as successful
      run: exit 0

end-failure:
  name: bors build finished
  if: &quot;!success()&quot;
  runs-on: ubuntu-latest
  needs: [ALL, OTHER, JOBS]
  steps:
    - name: Mark the job as a failure
      run: exit 1
</code></pre>
<p>Make sure to replace <code>[ALL, OTHER, JOBS]</code> with a list of all the jobs you
want to gate on.</p>
<p>These jobs need to run on specific branches (<code>auto</code> and <code>try</code>) so it's necessary
to add those branches to the list of branches tested by the CI provider. For GitHub
Actions that looks like this:</p>
<pre><code class="language-yaml">on:
   push:
       branches: [ 
         auto,   # Added for bors
         try     # Added for bors
      ]
</code></pre>
</li>
<li>
<p>Add the repository name to the bors permissions array in the <a href="https://github.com/rust-lang/team/blob/52b4370214e1c8eabe483f3a26f22733d94b326f/config.toml#L18-L37">team
repository</a>, and grant the <code>bors.REPOSITORY.review</code>
permission to the right teams or people. You can see an example of adding
bors permissions to a team <a href="https://github.com/rust-lang/team/blob/a1532ec2b08c9d40c0a2c7643ffe72de9671e265/teams/wg-compiler-performance.toml#L25-L26">here</a>.</p>
</li>
<li>
<p>Add the repository to the <code>repositories</code> map in <a href="https://github.com/rust-lang/simpleinfra/blob/master/terraform/bors/_config.auto.tfvars">the Terraform configuration
file</a>. This will create a webhook and inject its secret key in the
bors execution environment.</p>
</li>
<li>
<p>Add the repository to the <a href="https://github.com/rust-lang/homu/blob/master/cfg.production.toml">Bors configuration</a>, taking
inspiration from other repositories. Note that the environment variables used
in that config will be set automatically as long as you completed step 3 above.</p>
</li>
<li>
<p>Give it a test by commenting <code>@bors ping</code> in any PR. If you get a response back,
you can then try to approve the PR with <code>@bors r+</code>.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="crater-agents"><a class="header" href="#crater-agents">Crater agents</a></h1>
<ul>
<li>Source code: <a href="https://github.com/rust-lang/docs.rs">rust-lang/crater</a></li>
<li>Hosted on:
<ul>
<li><code>crater-aws-1.infra.rust-lang.org</code> (behind the bastion -- <a href="https://github.com/rust-lang/infra-team/blob/master/docs/hosts/bastion.md#logging-into-servers-through-the-bastion">how to connect</a>)</li>
<li><code>crater-azure-1.infra.rust-lang.org</code> (behind the bastion -- <a href="https://github.com/rust-lang/infra-team/blob/master/docs/hosts/bastion.md#logging-into-servers-through-the-bastion">how to connect</a>)</li>
</ul>
</li>
<li>Maintainers: <a href="https://github.com/pietroalbini">pietroalbini</a></li>
<li><a href="https://grafana.rust-lang.org/d/WLeJySTZz/crater?orgId=1">Application metrics</a> (only available to infra team members).</li>
<li>Instance metrics (only available to infra team members):
<ul>
<li><a href="https://grafana.rust-lang.org/d/rpXrFfKWz/instance-metrics?orgId=1&amp;var-instance=crater-aws-1.infra.rust-lang.org:9100"><code>crater-aws-1.infra.rust-lang.org</code></a></li>
<li><a href="https://grafana.rust-lang.org/d/rpXrFfKWz/instance-metrics?orgId=1&amp;var-instance=crater-azure-1.infra.rust-lang.org:9100"><code>crater-azure-1.infra.rust-lang.org</code></a></li>
</ul>
</li>
</ul>
<h2 id="service-configuration"><a class="header" href="#service-configuration">Service configuration</a></h2>
<p>Crater agents are servers with our standard configuration running a Docker
container hosting the agent. A timer checks for updates every 5 minutes, and if
a newer Docker image is present the container will automatically be updated and
restarted. This service is <a href="https://github.com/rust-lang/simpleinfra/blob/master/ansible/playbooks/crater.yml">managed with Ansible</a>.</p>
<h2 id="common-maintenance-procedures-2"><a class="header" href="#common-maintenance-procedures-2">Common maintenance procedures</a></h2>
<h3 id="starting-and-stopping-the-agent"><a class="header" href="#starting-and-stopping-the-agent">Starting and stopping the agent</a></h3>
<p>The agent is managed by the <code>container-crater-agent.service</code> systemd unit. That
means it's possible to start, stop and restart it with the usual systemctl
commands:</p>
<pre><code>systemctl stop container-crater-agent.service
systemctl start container-crater-agent.service
systemctl restart container-crater-agent.service
</code></pre>
<h3 id="inspecting-the-logs-of-the-agent"><a class="header" href="#inspecting-the-logs-of-the-agent">Inspecting the logs of the agent</a></h3>
<p>Logs of the agents are forwarded and collected by journald. To see them you can
use journalctl:</p>
<pre><code>journalctl -u container-crater-agent.service
</code></pre>
<h3 id="manually-updating-the-container-image"><a class="header" href="#manually-updating-the-container-image">Manually updating the container image</a></h3>
<p>The container is updated automatically every 5 minutes (provided a newer image
is present). If you need to update them sooner you can manually start the
updater service by running this command:</p>
<pre><code>systemctl start docker-images-update.service
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="custom-github-actions-runners"><a class="header" href="#custom-github-actions-runners">Custom GitHub Actions runners</a></h1>
<p>The Infrastructure Team manages a pool of self-hosted GitHub Actions runners,
meant to be used by whitelisted repositories that need to run tests on
platforms not supported by the GitHub-hosted runners. We're currently running
the following machines:</p>
<ul>
<li><code>ci-arm-1.infra.rust-lang.org</code>: AArch64 runners, hosted on <a href="https://www.packet.com">packet</a>
(<a href="https://github.com/rust-lang/simpleinfra/blob/master/ansible/envs/prod/host_vars/ci-arm-1.infra.rust-lang.org.yml">configuration</a>).</li>
</ul>
<p>The server configuration for the runners is managed with Ansible (<a href="https://github.com/rust-lang/simpleinfra/blob/master/ansible/playbooks/gha-self-hosted.yml">playbook</a>,
<a href="https://github.com/rust-lang/simpleinfra/blob/master/ansible/playbooks/gha-self-hosted.yml">role</a>), and the source code for the tooling run on the server is in the
<a href="https://github.com/rust-lang/gha-self-hosted">gha-self-hosted</a> repository.</p>
<p>Please get in touch with the Infrastructure Team if you need to run builds on
this pool for your project in the <code>rust-lang</code> organization.</p>
<h2 id="maintenance-procedures-1"><a class="header" href="#maintenance-procedures-1">Maintenance procedures</a></h2>
<h3 id="updating-the-github-actions-runner-version"><a class="header" href="#updating-the-github-actions-runner-version">Updating the GitHub Actions runner version</a></h3>
<p>Our self-hosted CI runs on a <a href="https://github.com/rust-lang/gha-runner">custom fork of the GitHub Actions
runner</a>, which improves the security of the setup. The
fork needs to be manually rebased every time a new version comes out though,
and that needs to be done relatively quickly to prevent CI from
stopping<sup class="footnote-reference"><a href="#self-updates">1</a></sup>.</p>
<p>Once a new release of <a href="https://github.com/actions/runner">actions/runner</a> is out, clone <a href="https://github.com/rust-lang/gha-runner">rust-lang/gha-runner</a> and
fetch the new tag pushed to the upstream repository. Then, rebase the changes
on top of the latest tag:</p>
<pre><code class="language-bash">git rebase --onto ${NEW_TAG} ${OLD_TAG} ${OLD_TAG}-rust${N}
</code></pre>
<p>For example, if the new tag is <code>v2.275.0</code>, the old tag is <code>v2.274.2</code> and there
were two releases of our fork, the command to execute would be:</p>
<pre><code class="language-bash">git rebase --onto v2.275.0 v2.274.2 v2.274.2-rust2
</code></pre>
<p>The last commit to rebase <em>will</em> conflict, as that commit updates the version
number and the release notes. Add the <code>-rust1</code> suffix to the new version number
and remove the description of the changes from the changelog (keeping the
<em>&quot;Fork of the GitHub Actions runner used by the Rust Infrastructure Team.&quot;</em>
sentence). Once the rebase is complete force-push the commits to <code>main</code>.</p>
<p>After you force-push the new commits to <code>main</code> you're done! CI will create a
tag, build the release, upload it to GitHub Releases, and automatically push a
commit to <a href="https://github.com/rust-lang/gha-self-hosted">rust-lang/gha-self-hosted</a> bumping the pinned
runner version to download in the images. The servers will then shortly pull
the latest changes, rebuild the images and restart idle VMs.</p>
<div class="footnote-definition" id="self-updates"><sup class="footnote-definition-label">1</sup>
<p>The GitHub Actions runner really wants to self-update when a
new release is out, but such updates would prevent our security mitigations.
Because of that, one of the patches in our fork disable self-updates, but
that means the runner just stops working until it's updated.</p>
</div>
<h3 id="changing-the-instances-configuration"><a class="header" href="#changing-the-instances-configuration">Changing the instances configuration</a></h3>
<p>The set of instances available in each host is configured through the
Ansible configuration located in the <a href="https://github.com/rust-lang/simpleinfra">simpleinfra repo</a>:</p>
<pre><code>ansible/envs/prod/host_vars/{hostname}.yml
</code></pre>
<p>You'll be able to add, remove and resize instances by changing that file and
applying the changes:</p>
<pre><code>ansible/apply prod gha-self-hosted
</code></pre>
<h3 id="forcing-an-update-of-the-source-code"><a class="header" href="#forcing-an-update-of-the-source-code">Forcing an update of the source code</a></h3>
<p>The server checks for source code updates every 15 minutes, but it's possible
to start such check in advance. You need to log into the machine you want to
act on, and run the following command:</p>
<pre><code>sudo systemctl start gha-self-hosted-update
</code></pre>
<p>If the contents of the <code>images/</code> directory were changed, an image rebuild will
also be started. The new image will be used by each VM after they finish
processing the current job.</p>
<h3 id="forcing-a-rebuild-of-the-images"><a class="header" href="#forcing-a-rebuild-of-the-images">Forcing a rebuild of the images</a></h3>
<p>The server automatically rebuilds the images every week, but it's possible to
rebuild them in advance. You need to log into the machine you want to act on,
and run the following command:</p>
<pre><code>sudo systemctl start gha-self-hosted-rebuild-image
</code></pre>
<h3 id="managing-the-lifecycle-of-virtual-machines"><a class="header" href="#managing-the-lifecycle-of-virtual-machines">Managing the lifecycle of virtual machines</a></h3>
<p>Each virtual machine is assigned a name and its own systemd unit, called
<code>gha-vm-{name}.service</code>. For example, the <code>arm-1-1</code> VM is managed by the
<code>gha-vm-arm-1-1.service</code> systemd unit. You can stop, start and restart the
virtual machine by stopping, starting and restarting the systemd unit.</p>
<p>Virtual machines are configured to restart after each build finishes.</p>
<h3 id="logging-into-the-virtual-machines"><a class="header" href="#logging-into-the-virtual-machines">Logging into the virtual machines</a></h3>
<p>It's possible to log into the virtual machines from localhost to debug builds.
This should be used as the last resort. Each VM binds SSH on a custom port on
the host (configured in the host Ansible configuration), and allows access to
the <code>manage</code> user (with password <code>password</code>). For example, to log into the VM
with port <code>2201</code> you can run:</p>
<pre><code>ssh manage@localhost -p 2201
</code></pre>
<p>Note that the VM image regenerates its own host key every time it boots, so
you'll likely get host key mismatch errors when connecting to a freshly booted
VM.</p>
<h3 id="accessing-the-out-of-band-console-for-packet-servers"><a class="header" href="#accessing-the-out-of-band-console-for-packet-servers">Accessing the out-of-band console for Packet servers</a></h3>
<p>In the event that a bare metal server hosted on Packet becomes unreachable but
is still marked as online, it's possible to access the out-of-band console over
the serial port to get a root shell.</p>
<p>To access it, retrieve the root password configured on the server with:</p>
<pre><code>aws ssm get-parameter --name /prod/ansible/HOSTNAME/root-password --with-decryption --query 'Parameter.Value' --output text
</code></pre>
<p>For example, to get the root password of <code>ci-arm-1</code>, run:</p>
<pre><code>aws ssm get-parameter --name /prod/ansible/ci-arm-1/root-password --with-decryption --query 'Parameter.Value' --output text
</code></pre>
<p>Then, log into the <a href="https://app.packet.net">packet console</a>, navigate to the server
page and click the &quot;out-of-band console&quot; button at the top right: the SSH
command to use will be shown. Once you run the command you will be asked to
login on the server: use <code>root</code> as the username and the password you fetched
earlier as the password.</p>
<p>To exit the out-of-band console, type a new line followed by <code>~.</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dev-desktops"><a class="header" href="#dev-desktops">Dev Desktops</a></h1>
<p>The dev desktops provide maintainers and contributors to the Rust Project with
free access to high-powered cloud compute. They are part of the
<a href="https://foundation.rust-lang.org/news/2021-11-16-news-announcing-cloud-compute-initiative/">Cloud Compute Program</a> by the <a href="https://foundation.rust-lang.org/">Rust Foundation</a>.</p>
<div class="table-wrapper"><table><thead><tr><th>Machine</th><th>Architecture</th><th>Perf enabled</th><th>Location</th></tr></thead><tbody>
<tr><td><code>dev-desktop-eu-1</code></td><td><code>aarch64</code></td><td>Yes</td><td>Germany</td></tr>
<tr><td><code>dev-desktop-us-1</code></td><td><code>aarch64</code></td><td>Yes</td><td>East Coast, US</td></tr>
</tbody></table>
</div>
<h2 id="how-to-apply-to-the-program"><a class="header" href="#how-to-apply-to-the-program">How to apply to the program</a></h2>
<p>At this time, access to the program and the compute instances is limited to
maintainers and core contributors of the Rust Project. While the program is
under development, it is invite-only.</p>
<p>If you feel like your work on the Rust project would be significantly improved
by access to a powerful build machine, reach out to <a href="mailto:infra@rust-lang.org">infra@rust-lang.org</a> with
the following information:</p>
<ul>
<li>Your GitHub handle</li>
<li>A short description of how you would use and benefit from the dev desktops</li>
</ul>
<h2 id="how-to-connect-to-a-dev-desktop"><a class="header" href="#how-to-connect-to-a-dev-desktop">How to connect to a dev desktop</a></h2>
<p>Each user has their own account on the dev desktops. The account is named after
the user’s GitHub handle, with <code>gh-</code> as a prefix. For example, a user with the
GitHub handle <code>user</code> will have a user account with the name <code>gh-user</code> on the dev
desktop.</p>
<p>Users can connect to the dev desktop with SSH. The dev desktops use public key
authentication, and automatically fetch the user’s public keys from GitHub.</p>
<p>You can connect to the instance with the following command:</p>
<pre><code class="language-shell">ssh &lt;your-username&gt;@&lt;instance&gt;
</code></pre>
<p>If you don’t have a public key on GitHub, read the following guides that explain
how to create an SSH key and add it to your GitHub account. It might take a few
minutes after the key has been added before the dev desktops get updated.</p>
<ul>
<li><a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">Generating a new SSH key and adding it to the ssh-agent</a></li>
<li><a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account">Adding a new SSH key to your GitHub account</a></li>
</ul>
<h2 id="how-to-set-up-your-account"><a class="header" href="#how-to-set-up-your-account">How to set up your account</a></h2>
<p>When connecting to the machine for the first time, there are a few things you
might want to do.</p>
<p>First, check that your Git username and email are configured correctly.</p>
<pre><code class="language-shell">git config -l --global
</code></pre>
<p>You can configure your username and email address with:</p>
<pre><code class="language-shell">git config --global user.name &quot;Your name&quot;
git config --global user.email &quot;your-email&quot;
</code></pre>
<h2 id="how-to-install-a-rust-toolchain"><a class="header" href="#how-to-install-a-rust-toolchain">How to install a Rust toolchain</a></h2>
<p>The dev desktops don’t have Rust pre-installed, but instead make it easy to
install a specific toolchain from a local repository or worktree.</p>
<p>First, you want to run the following command to install <code>rustup</code>:</p>
<pre><code class="language-shell">/usr/local/bin/init.sh
</code></pre>
<p>If you don't want or need to work with your own version of Rust, you can skip
the next section and start working.</p>
<p>If you haven't done so yet, open the <a href="https://github.com/rust-lang/rust">rust-lang/rust</a> repository on GitHub and
create a fork in your personal account. Then connect to the dev desktop and run
the following script:</p>
<pre><code class="language-shell">/usr/local/bin/setup_rust.sh
</code></pre>
<p>The script will clone your personal fork to the dev desktop, check out the
latest version from <a href="https://github.com/rust-lang/rust">rust-lang/rust</a>, and compile it. Once that's done, it will
link the stages so that you can work with them locally.</p>
<p>The directory contains more scripts to manage worktrees and Rust versions. Run
<code>help.sh</code> to get a list and a short description of them.</p>
<h2 id="how-to-interact-with-github"><a class="header" href="#how-to-interact-with-github">How to interact with GitHub</a></h2>
<p>The dev desktops are designed to work with repositories on GitHub that belong to
your user account. A GitHub App is used to protect your credentials and give you
granular control over the repositories that the dev desktops can access.</p>
<p>First, go to <a href="https://github.com/apps/rust-cloud-vms">https://github.com/apps/rust-cloud-vms</a> to give the app access to
your repositories. It's recommended to only grant access to the repositories
that you want to use on the dev desktop, e.g. your fork of <code>rust-lang/rust</code>.</p>
<p>Then connect to the dev desktop and clone the repository that you want to work
on with HTTPS. From there, you can work with the repository like you would
normally do.</p>
<p>Under the hood, the GitHub App acts as a credentials helper for Git and
generates temporary access tokens that are scoped to the permissions that you
have granted the application. If you get an error, review the permissions and
ensure that the app is allowed to access your repository.</p>
<h2 id="how-to-set-up-remote-development-in-visual-studio-code"><a class="header" href="#how-to-set-up-remote-development-in-visual-studio-code">How to set up remote development in Visual Studio Code</a></h2>
<p>Most modern code editors provide support for remote development via SSH. This
can be used to write code locally, but execute it inside the dev desktop. While
the configuration will differ slightly, the following example for
<a href="https://code.visualstudio.com/">Visual Studio Code</a> should be applicable to other editors as well.</p>
<p>Setting up remote development with VS Code is pretty straightforward, and is
described in detail in VS Code’s documentation: <a href="https://code.visualstudio.com/docs/remote/ssh">Remote Development using SSH</a>.
In summary:</p>
<ol>
<li>SSH into the dev desktop and clone the repository that you want to work on to
a local folder</li>
<li>Then open VS Code on your machine and install
the <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack">Remote Development Extension Pack</a></li>
<li>Open the command palette and search for “Remote-SS: Connect to host”</li>
<li>Enter your username and the instance name (<code>&lt;your-username&gt;@&lt;instance&gt;</code>)</li>
<li>Select the path for the cloned repository from step 1</li>
<li>Install any extensions that you want to run on the server (e.g.
rust-analyzer)</li>
<li>Use VS Code to run or debug the code remotely</li>
</ol>
<h2 id="how-to-give-feedback-and-report-issues"><a class="header" href="#how-to-give-feedback-and-report-issues">How to give feedback and report issues</a></h2>
<p>If you experience any problems with the dev desktops, or have feedback and
suggestions, get in touch with the <a href="https://www.rust-lang.org/governance/teams/infra">infrastructure team</a>:</p>
<p><a href="https://rust-lang.zulipchat.com/#narrow/stream/t-infra">#t-infra on Zulip</a></p>
<p>We might ask you to create an issue in the <a href="https://github.com/rust-lang/simpleinfra">rust-lang/simpleinfra</a> repository.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="github-app-for-pushing-to-github-from-the-dev-desktops"><a class="header" href="#github-app-for-pushing-to-github-from-the-dev-desktops">Github App for pushing to github from the dev-desktops</a></h1>
<p>These instructions are for server-side setup and debugging of the dev-desktop github app.
The user only needs to be directed to the app installation URL
and everything should just work for them.</p>
<p>We're using the python github library for all github operations.
You can find the docs at https://pygithub.readthedocs.io/en/latest/introduction.html</p>
<h2 id="how-to-setup-an-app"><a class="header" href="#how-to-setup-an-app">How to setup an App</a></h2>
<ol>
<li>Go to https://github.com/settings/apps</li>
<li>New Github App</li>
<li>Fill out metadata (name and url)</li>
<li>disable WebHook checkbox</li>
<li>Set <code>Contents - Repository contents, commits, branches, downloads, releases, and merges.</code> to read/write</li>
<li>Set <code>Workflows - Update GitHub Action workflow files.</code> to read/write</li>
<li>Set to &quot;enable on any account&quot;</li>
<li>Create App</li>
<li>Go to https://github.com/settings/apps/{your_app_name_here} and copy the <code>App ID</code> into <code>app_id.txt</code> (same folder as <code>gen_temp_access_token.py</code>)</li>
</ol>
<h3 id="how-to-generate-a-pem-file-for-your-app"><a class="header" href="#how-to-generate-a-pem-file-for-your-app">How to generate a .pem file for your App</a></h3>
<ol>
<li>Go to https://github.com/settings/apps/{your_app_name_here}#private-key and generate a private key</li>
<li>Download starts, save it to somewhere private.</li>
<li>copy the .pem file into the same folder as the <code>gen_temp_access_token.py</code> and name it <code>dev-desktop.private-key.pem</code></li>
</ol>
<h3 id="how-to-install-the-app-for-a-user"><a class="header" href="#how-to-install-the-app-for-a-user">How to install the app for a user</a></h3>
<ol>
<li>direct the user to https://github.com/settings/apps/{your_app_name_here}/installations</li>
<li>let them install it on the org/user they want to and restrict to the repositories they want to use</li>
</ol>
<h3 id="how-to-generate-a-temporary-access-token-for-a-specific-user"><a class="header" href="#how-to-generate-a-temporary-access-token-for-a-specific-user">How to generate a temporary access token for a specific user</a></h3>
<ol>
<li>invoke <code>gen_temp_access_token.py &lt;github_username&gt; &lt;github_repository_name&gt;</code></li>
</ol>
<h2 id="integration-into-git-command-line"><a class="header" href="#integration-into-git-command-line">Integration into git command line</a></h2>
<p>We're using <a href="https://git-scm.com/docs/gitcredentials#Documentation/gitcredentials.txt">credential-helpers</a>.
For debugging a credential helper, have it in userspace and invoke it with</p>
<p><code>git -c credential.helper -c credential.UseHttpPath=true /path/to/helper push origin branch</code></p>
<p>Note that this does not work for remotes that are registered with ssh urls. You must use https!</p>
<p>The first command line argument is <code>get</code>, <code>store</code> or <code>remove</code>.
In our case, we just abort (<code>exit(0)</code>) for everything but <code>get</code>, as we regenerate credentials on every invocation anyway.</p>
<p>The actual arguments are passed via stdin and usually look like</p>
<pre><code>protocol=https
host=github.com
path=your_repo.git
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="discord-moderation-bot"><a class="header" href="#discord-moderation-bot">Discord moderation bot</a></h1>
<ul>
<li>Source code: <a href="https://github.com/rust-lang/discord-mods-bot">rust-lang/discord-mods-bot</a></li>
<li>Hosted on: <a href="infra/docs/ecs-services.html"><code>rust-ecs-prod</code> ECS cluster</a></li>
<li>Maintainers: <a href="https://github.com/technetos">technetos</a></li>
</ul>
<p>The bot is hosted on the <code>rust-ecs-prod</code> ECS cluster, on the project's AWS
account, with the <code>discord-mods-bot</code> service name. Its container image is
stored in a ECR repository with the same name, and its data is stored in the
<code>shared</code> RDS PostgreSQL instance.</p>
<p>Automatic deploys are setup from the <a href="https://github.com/rust-lang/discord-mods-bot">rust-lang/discord-mods-bot</a> GitHub
repository.</p>
<p>The Discord bot account is <a href="https://discordapp.com/developers/applications/615806512790503424"><code>rustbot#4299</code></a>. <a href="https://github.com/pietroalbini">pietroalbini</a>,
<a href="https://github.com/Mark-Simulacrum">Mark-Simulacrum</a>, <a href="https://github.com/alexcrichton">alexcrichton</a> and <a href="https://github.com/aidanhs">aidanhs</a> have access to the developer
portal.</p>
<h2 id="common-maintenance-procedures-3"><a class="header" href="#common-maintenance-procedures-3">Common maintenance procedures</a></h2>
<p><a href="infra/docs/ecs-services.html">Instructions on how to manage ECS services are available here.</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="domain-names-and-dns"><a class="header" href="#domain-names-and-dns">Domain names and DNS</a></h1>
<p>All the DNS records of the domains owned by the Rust Infrastructure team are
hosted on <a href="https://aws.amazon.com/route53/">AWS Route 53</a>, and can be tweaked by members of the team. This
document contains instructions for them on how to make changes.</p>
<ul>
<li><a href="infra/docs/dns.html#changing-dns-records-of-a-domain-managed-with-terraform">Changing DNS records of a domain managed with Terraform</a></li>
<li><a href="infra/docs/dns.html#managing-dns-for-a-new-domain-with-terraform">Managing DNS for a new domain with Terraform</a></li>
<li><a href="infra/docs/dns.html#adding-subdomain-redirects">Adding subdomain redirects</a></li>
<li><a href="infra/docs/dns.html#transferring-domain-names-to-rust">Transferring domain names to Rust</a></li>
</ul>
<h2 id="changing-dns-records-of-a-domain-managed-with-terraform"><a class="header" href="#changing-dns-records-of-a-domain-managed-with-terraform">Changing DNS records of a domain managed with Terraform</a></h2>
<blockquote>
<p><strong>Warning:</strong> not all domain names are yet managed with Terraform. In the
<a href="https://console.aws.amazon.com/route53/home#hosted-zones:">console</a>, if a zone's comment doesn't start with <code>[terraform]</code>
you'll need to make changes manually from the UI. Work is underway to migrate
every domain to Terraform though.</p>
</blockquote>
<blockquote>
<p><strong>Warning:</strong> <a href="https://github.com/rust-lang/simpleinfra/tree/master/terraform/services/dns/"><code>terraform/services/dns</code></a> only contains the definition
of DNS records pointing to resources managed outside of Terraform. When
Terraform manages a resource it will automatically add the required records
on its own. See the service's documentation to learn where its Terraform
configuration lives.</p>
</blockquote>
<p>DNS records are managed in the <a href="https://github.com/rust-lang/simpleinfra/tree/master/terraform/services/dns/"><code>terraform/services/dns</code></a> directory of
our Terraform configuration. A file named after the domain name, ending in
<code>.tf</code>, exists for each managed domain, and it contains some basic information
plus its records.</p>
<p>The configuration supports adding A, CNAME, MX and TXT records. Inside the
module definition contained in the domain's file, each record type has its own
map: the map keys are the names of the records, while the values are a list of
record values.</p>
<p>For example, to add a <code>pages.rust-lang.org</code> CNAME pointing to
<code>rust-lang.github.io</code> you'll need to add this to
<code>terraform/services/dns/rust-lang.org</code>:</p>
<pre><code class="language-terraform">module &quot;rust_lang_org&quot; {
  # ...

  CNAME = {
    &quot;pages.rust-lang.org.&quot; = [&quot;rust-lang.github.io&quot;],
    # ...
  }
}
</code></pre>
<p>Once you made all the changes you can apply them with:</p>
<pre><code>terraform apply
</code></pre>
<h2 id="managing-dns-for-a-new-domain-with-terraform"><a class="header" href="#managing-dns-for-a-new-domain-with-terraform">Managing DNS for a new domain with Terraform</a></h2>
<p>Setting up Terraform to manage the DNS records of a new domain name involves a
few steps. First of all you need to decide the identifier used inside
Terraform for that domain. By convention, the identifier is the domain name
itself with <code>.</code> and <code>-</code> replaced with <code>_</code>. For example <code>rust-lang.org</code> becomes
<code>rust_lang_org</code>.</p>
<p>Then you can create a file in <a href="https://github.com/rust-lang/simpleinfra/tree/master/terraform/services/dns/"><code>terraform/services/dns</code></a> named after
the domain name, ending in <code>.tf</code>, with this content (take care of replacing the
placeholders):</p>
<pre><code class="language-terraform">module &quot;&lt;IDENTIFIER&gt;&quot; {
  source = &quot;./domain&quot;

  domain = &quot;&lt;DOMAIN-NAME&gt;&quot;
  comment = &quot;&lt;COMMENT-FOR-THE-DOMAIN&gt;&quot;
  ttl = 300
}
</code></pre>
<p>Finally you need to output the ID of the Route53 zone, allowing other parts of
our Terraform configuration to add records. Add this snippet to
<a href="https://github.com/rust-lang/simpleinfra/blob/master/terraform/services/dns/outputs.tf"><code>terraform/services/dns/outputs.tf</code></a>:</p>
<pre><code class="language-terraform"># ...

output &quot;zone_&lt;IDENTIFIER&gt;&quot; {
  value = module.&lt;IDENTIFIER&gt;.zone_id
}
</code></pre>
<p>Once you're done you can apply the changes with:</p>
<pre><code>terraform init
terraform apply
</code></pre>
<h2 id="adding-subdomain-redirects"><a class="header" href="#adding-subdomain-redirects">Adding subdomain redirects</a></h2>
<p>Our Terraform configuration supports creating redirects from an arbitrary
number of subdomains we control to an URL. Redirects are created with these
pieces of infrastructure:</p>
<ul>
<li>
<p>A S3 bucket for each set of redirects, named <code>rust-http-redirect-&lt;HASH&gt;</code>. The
bucket has website hosting enabled, configured to redirect all the incoming
requests to the chosen URL. This allows implementing redirects without an
underlying server.</p>
</li>
<li>
<p>An ACM certificate (plus the DNS records to validate it) for each set of
redirects, with all the sources as alternate names. This is used to enable
HTTPS redirects.</p>
</li>
<li>
<p>A CloudFront distribution for each set of redirects to support HTTPS
requests, using the previously generated ACM certificate and forwarding
requests to the S3 bucket.</p>
</li>
<li>
<p>Route53 records for each redirect in the related zones: CNAMEs
for subdomains, and ALIASes for apex domains.</p>
</li>
</ul>
<p>All the redirects are defined in <a href="https://github.com/rust-lang/simpleinfra/blob/master/terraform/redirects.tf"><code>terraform/redirects.tf</code></a>,
with a module for each destination URL. Either create a new module if you need
to redirect to a new URL, or add a new subdomain to an existing module. See an
example module here (take care of replacing the placeholders):</p>
<pre><code class="language-terraform">module &quot;redirect_&lt;IDENTIFIER&gt;&quot; {
  source = &quot;./modules/subdomain-redirect&quot;
  providers = {
    aws       = &quot;aws&quot;
    aws.east1 = &quot;aws.east1&quot;
  }

  to = &quot;&lt;DESTINATION-URL&gt;&quot;
  from = {
    &quot;&lt;SUBDOMAIN-1&gt;&quot; = module.dns.zone_&lt;DOMAIN-1-IDENTIFIER&gt;,
    &quot;&lt;SUBDOMAIN-2&gt;&quot; = module.dns.zone_&lt;DOMAIN-2-IDENTIFIER&gt;,
  }
}
</code></pre>
<p>Once you made all the changes you can apply the configuration with:</p>
<pre><code>terraform init
terraform apply
</code></pre>
<p>Note that each change is going to take around 15 minutes to deploy, as
CloudFront distribution changes are really slow to propagate. Also, it's normal
to see a bunch of resources being recreated when a domain is added or removed
from an existing redirect, as the ACM certificate will need to be regenerated.</p>
<h2 id="transferring-domain-names-to-rust"><a class="header" href="#transferring-domain-names-to-rust">Transferring domain names to Rust</a></h2>
<p>These are the steps a member of the infrastructure team needs to take to
transfer a domain name to the Rust project's registrar:</p>
<ol>
<li>
<p>Ask inside the infrastructure team if this is a domain name the project
wants to own. In some more complicated cases this will need to be escalated
to the core team.</p>
</li>
<li>
<p>If the domain name doesn’t already use AWS Route 53 as its nameserver, ask
the current owner of the domain a list of all the DNS records that will need
to be migrated. Then, add all the records to a new hosted zone on Route 53
before the transfer of the domain. See the <a href="infra/docs/dns.html#transferring-dns">section below</a> on
transferring DNS for more information on this step.</p>
</li>
<li>
<p>Ask the current owner to unlock the domain name for transfer, and get the
transfer code from them. The transfer code is key to transferring the
domain, so avoid receiving it on public communication platforms.</p>
</li>
<li>
<p>Go to the <a href="https://console.aws.amazon.com/route53/home#DomainTransfer:">Transfer Domain</a> section of AWS Route 53 and enter the
domain name. If it doesn’t give an error (which should detail which steps
are missing) enter the transfer code you received earlier, and choose to use
an existing Route 53 hosted zone (it should auto-complete the right one).
Until the Rust Foundation is up, use Pietro’s details as the domain
contacts. Finally review everything and complete the transfer process.</p>
</li>
<li>
<p>Tell the current owner to wait for an email from their registrar, which will
ask to click on a link to confirm the domain name transfer.</p>
</li>
<li>
<p>The transfer process will take a while. Once admin@rust-lang.org receives an
email telling the domain has been transferred you’re done! 🎉🎉🎉</p>
</li>
</ol>
<h3 id="transferring-dns"><a class="header" href="#transferring-dns">Transferring DNS</a></h3>
<p>Most domain names use their registrar as the DNS server, but that means that
once the domain is transferred away the old registrar also stops serving DNS
traffic. Because of that we need to ensure all the DNS records are correctly
copied over to AWS Route 53 before actually starting the transfer process.</p>
<p>Explicitly ask the current domain owner for all the <code>A</code>, <code>AAAA</code>, <code>CNAME</code>, <code>TXT</code>
and <code>MX</code> records. Everything except the <code>MX</code> records needs to be copied to the
<a href="https://github.com/rust-lang/simpleinfra/tree/master/terraform/services/dns/">Terraform DNS configuration</a> (create a new file for the domain name,
and take inspiration from the other domain names).</p>
<p>If you notice some of the records are referring to HTTP redirect services
provided by the current registrar then those will have to wait until the domain
has been transferred. Once the transfer occured, add a new <a href="https://github.com/rust-lang/simpleinfra/blob/master/terraform/redirects.tf">domain
redirect</a> on Terraform. This has to be done after the transfer
to be able to request the TLS certificate for the HTTPS redirect.</p>
<p>If the domain has <code>MX</code> records those will need to be migrated to Mailgun. Go to
<a href="https://app.mailgun.com">Mailgun</a> and add the domain name there. Ensure it’s in the US region,
it uses shared IPs, and it has a 1024 bit DKIM key (the 2048 keys do not fit
into a single AWS Route 53 record). Then copy all the records except the
<code>CNAME</code> tracking one over to the Terraform DNS configuration, and wait for the
domain to be transferred. Once the transfer happens go back to Mailgun and
verify the DNS settings for the domain. Finally, add the domain to the <a href="https://github.com/rust-lang/team/blob/master/config.toml">team
repository’s <code>config.toml</code></a> and create the mailing lists you need
through the usual process.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="docsrs-2"><a class="header" href="#docsrs-2">docs.rs</a></h1>
<ul>
<li>Source code: <a href="https://github.com/rust-lang/docs.rs">rust-lang/docs.rs</a></li>
<li>Hosted on: <code>docsrs.infra.rust-lang.org</code> (behind the bastion -- <a href="https://github.com/rust-lang/infra-team/blob/master/docs/hosts/bastion.md#logging-into-servers-through-the-bastion">how to connect</a>)</li>
<li>Maintainers: <a href="https://github.com/jyn514">Joshua Nelson</a>, <a href="https://github.com/pietroalbini">Pietro Albini</a></li>
<li><a href="https://grafana.rust-lang.org/d/rpXrFfKWz/instance-metrics?orgId=1&amp;var-instance=docsrs.infra.rust-lang.org:9100">Instance metrics</a> (only available to infra team members).</li>
<li><a href="https://grafana.rust-lang.org/d/-wWFg2cZz/docs-rs?orgId=1">Application metrics</a> (only available to infra team members).</li>
<li><a href="infra/docs/../../docs-rs/maintenance.html">Common maintenance procedures</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ecs-services-management"><a class="header" href="#ecs-services-management">ECS services management</a></h1>
<p>Some applications running on the project's infrastructure are hosted in ECS
clusters on our AWS account. This document explains the common maintenance
procedures one should follow when operating them. Most of the actions explained
here <a href="infra/docs/aws-access.html">require AWS access</a>.</p>
<blockquote>
<p><strong>Note:</strong> our ECS cluster is located in the Northern California
(<code>us-west-1</code>) AWS region. Make sure it's the selected region when interacting
with the AWS console.</p>
</blockquote>
<h2 id="inspecting-the-logs"><a class="header" href="#inspecting-the-logs">Inspecting the logs</a></h2>
<p>Logs for applications hosted on ECS are stored in CloudWatch Logs, and can
be inspected in the AWS Console. <a href="infra/docs/aws-access.html#using-the-aws-console">Open the console</a>, go to
CloudWatch Logs and select the log group called <code>/ecs/&lt;service-name&gt;</code>. There
are two ways to inspect the logs:</p>
<ul>
<li>
<p>If you need to look at the application as a whole, you can get an aggregated
view by clicking the &quot;View all log events&quot; button (or, on the classic
interface, &quot;Search Log Group&quot;).</p>
</li>
<li>
<p>If you need to debug a specific instance of a container, separate log streams
for each running task are available. The streams are named after the
container name and the task ID.</p>
</li>
</ul>
<p>Logs are periodically purged (retention varies based on the specific
application).</p>
<h2 id="restarting-an-application"><a class="header" href="#restarting-an-application">Restarting an application</a></h2>
<p>To restart an application, you can force a new deployment without actually
pushing any new code beforehand. To do so, run this command:</p>
<pre><code>aws ecs update-service --cluster rust-ecs-prod --service &lt;service-name&gt; --force-new-deployment
</code></pre>
<h2 id="rolling-back-a-deployment"><a class="header" href="#rolling-back-a-deployment">Rolling back a deployment</a></h2>
<p>To rollback a bad deployment you can run the <a href="https://github.com/rust-lang/simpleinfra/blob/master/aws-rollback.py"><code>aws-rollback.py</code></a> script (stored
in the simpleinfra repository) with your <a href="infra/docs/aws-access.html">AWS credentials</a> present
in the shell. The script requires the name of the ECR container image
repository as its first and only argument:</p>
<pre><code>./aws-rollback.py &lt;image-repository-name&gt;
</code></pre>
<p>The script will show the list of images available in the repository, and asks
for the image number to rollback to. Once that's inserted the script will point
the <code>latest</code> tag to the image you chose, and if an ECS service with the same
name as the repository exists that service will be restarted too.</p>
<h2 id="deploying-application-changes"><a class="header" href="#deploying-application-changes">Deploying application changes</a></h2>
<p>Each application stores its own Docker container in a <a href="https://aws.amazon.com/ecr/">ECR repository</a> in
our AWS account. You can deploy changes both manually and automatically (with
GitHub Actions).</p>
<p>For production applications it's recommended to setup automatic deployment.</p>
<h3 id="manual-deployments"><a class="header" href="#manual-deployments">Manual deployments</a></h3>
<p>To manually deploy a local build you first need it to tag your built image
with its ECR name:</p>
<pre><code>docker tag &lt;image-tag&gt; 890664054962.dkr.ecr.us-west-1.amazonaws.com/&lt;repository-name&gt;:latest
</code></pre>
<p>Then you can authenticate with ECR and push it:</p>
<pre><code>$(aws ecr get-login --no-include-email --region us-west-1)
docker push 890664054962.dkr.ecr.us-west-1.amazonaws.com/&lt;repository-name&gt;:latest
</code></pre>
<p>Finally, you need to force a new deployment of the ECS service with:</p>
<pre><code>aws ecs update-service --cluster rust-ecs-prod --service &lt;service-name&gt; --force-new-deployment
</code></pre>
<h3 id="automatic-deployments-with-github-actions"><a class="header" href="#automatic-deployments-with-github-actions">Automatic deployments with GitHub Actions</a></h3>
<p>The infrastructure team prepared an action for GitHub Actions that automates
deployments from CI. To use it, ask a team member to setup AWS credentials in
your repository, and then add this snippet to your workflow:</p>
<pre><code>- name: Build the Docker image
  run: docker build -t deploy-image .

- name: Deploy to production
  uses: rust-lang/simpleinfra/github-actions/upload-docker-image@master
  with:
    image: deploy-image
    repository: &lt;ecr-repository-name&gt;
    region: us-west-1
    redeploy_ecs_cluster: rust-ecs-prod
    redeploy_ecs_service: &lt;service-name&gt;
    aws_access_key_id: &quot;${{ secrets.AWS_ACCESS_KEY_ID }}&quot;
    aws_secret_access_key: &quot;${{ secrets.AWS_SECRET_ACCESS_KEY }}&quot;
  if: github.ref == 'refs/heads/&lt;deploy-branch&gt;'
</code></pre>
<p>Be sure to replace <code>&lt;ecr-repository-name&gt;</code>, <code>&lt;service-name&gt;</code> and
<code>&lt;deploy-branch&gt;</code> with the correct values for your workflow. Once the workflow
changes are merged in the branch you chose for deploys, any future commits
pushed there will be deployed to the ECS cluster.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="monitoring"><a class="header" href="#monitoring">Monitoring</a></h1>
<ul>
<li>Hosted on: <code>monitoring.infra.rust-lang.org</code> (behind the bastion -- <a href="https://github.com/rust-lang/infra-team/blob/master/docs/hosts/bastion.md#logging-into-servers-through-the-bastion">how to connect</a>)</li>
<li>Maintainers: <a href="https://github.com/pietroalbini">pietroalbini</a>, infra team</li>
<li>Public URL: <a href="https://grafana.rust-lang.org">grafana.rust-lang.org</a></li>
<li><a href="https://github.com/rust-lang/simpleinfra/blob/master/ansible/playbooks/monitoring.yml">Ansible playbook</a> to deploy this server.</li>
<li><a href="https://grafana.rust-lang.org/d/rpXrFfKWz/instance-metrics?orgId=1&amp;var-instance=monitoring.infra.rust-lang.org:9100">Instance metrics</a> (only available to infra team members).</li>
</ul>
<h2 id="service-configuration-1"><a class="header" href="#service-configuration-1">Service configuration</a></h2>
<p>Our monitoring service is composed of three parts: <a href="https://prometheus.io">Prometheus</a> to scrape,
collect and monitor metrics, <a href="https://prometheus.io/docs/alerting/alertmanager/">Alertmanager</a> to dispatch the alerts generated by
Prometheus, and <a href="https://grafana.com">Grafana</a> to display the metrics. All the parts are configured
through <a href="https://github.com/rust-lang/simpleinfra/tree/master/ansible">Ansible</a>.</p>
<p>The metrics are not backed up, as Prometheus purges them after 7 days anyway,
but the Grafana dashboards are stored in a PostgreSQL database, which is backed
up with <a href="https://restic.net">restic</a> in the <code>rust-backups</code> bucket (<code>monitoring</code> subdirectory). The
password to decrypt the backups is in 1password.</p>
<h2 id="common-maintenance-procedures-4"><a class="header" href="#common-maintenance-procedures-4">Common maintenance procedures</a></h2>
<h3 id="scrape-a-new-metrics-source"><a class="header" href="#scrape-a-new-metrics-source">Scrape a new metrics source</a></h3>
<p>Prometheus works by periodically scraping a list of HTTP endpoints for metrics,
written <a href="https://prometheus.io/docs/instrumenting/exposition_formats/">in its custom format</a>. In our configuration the list
is located in the <code>prometheus_scrape</code> section of the
<code>ansible/playbooks/monitoring.yml</code> file in the <a href="https://github.com/rust-lang/simpleinfra">simpleinfra</a> repository.</p>
<p>To add a new metrics source, add your endpoint to an existing job or, if the
metrics you're scraping are not related to any other job, a new one. The
endpoint must be reachable from the monitoring instance. You can read the
<a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#scrape_config">Prometheus documentation</a> to find all the available
options.</p>
<h3 id="create-a-new-alert"><a class="header" href="#create-a-new-alert">Create a new alert</a></h3>
<p>Alerts are generated by Prometheus every time a custom rule defined in its
configuration evaluates to true. In our configuration the list of rules is
located in the <code>prometheus_rule_groups</code> section of the
<code>ansible/playbooks/monitoring.yml</code> file in the <a href="https://github.com/rust-lang/simpleinfra">simpleinfra</a> repository.</p>
<p>To add a new alert you need to create an alerting rule either in an existing
group or a new one. The full list of options is available in the <a href="https://prometheus.io/docs/prometheus/latest/configuration/alerting_rules/">Prometheus
documentation</a>.</p>
<h3 id="add-permissions-to-a-user"><a class="header" href="#add-permissions-to-a-user">Add permissions to a user</a></h3>
<p>There are two steps needed to grant access to <a href="https://grafana.rust-lang.org">our Grafana
instance</a> to an user.</p>
<p>First of all, to enable the user to log into the instance with their GitHub
account they need to be a member of a team authorized to log in. The list of
teams is defined in the <code>grafana_github_teams</code> section of the
<code>ansible/playbooks/monitoring.yml</code> file in the <a href="https://github.com/rust-lang/simpleinfra">simpleinfra</a> repository, and it
contains a list of GitHub team IDs. To fetch an ID you can run this command:</p>
<pre><code>curl -H &quot;Authorization: token $GITHUB_TOKEN&quot; https://api.github.com/orgs/&lt;ORG&gt;/teams/&lt;NAME&gt; | jq .id
</code></pre>
<p>Once the user is a member of a team authorized to log in they will
automatically be added to the main Grafana organization with &quot;viewer&quot;
permissions. For infrastructure team members that needs to be changed to
&quot;admin&quot; (in the &quot;Configuration&quot; -&gt; &quot;Users&quot;), otherwise leave it as viewer.</p>
<p>By default a viewer only has access to the unrestricted dashboards. To grant
access to other dashboards you'll need to add them to a team (in the
&quot;Configuration&quot; -&gt; &quot;Teams&quot; page). It's also possible to grant admin privileges
to the whole Grafana instance in the &quot;Server Admin&quot; -&gt; &quot;Users&quot; -&gt;
&quot;<code>&lt;username&gt;</code>&quot; page. Do not grant those permissions except to trusted infra
team members.</p>
<h2 id="additional-resources"><a class="header" href="#additional-resources">Additional resources</a></h2>
<ul>
<li><a href="https://prometheus.io/docs/introduction/overview/">Prometheus documentation</a></li>
<li><a href="https://grafana.com/docs/">Grafana documentation</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-bots"><a class="header" href="#rust-bots">rust-bots</a></h1>
<ul>
<li>FQDN: <code>bots.infra.rust-lang.org</code> (behind the bastion -- <a href="https://github.com/rust-lang/infra-team/blob/master/docs/hosts/bastion.md#logging-into-servers-through-the-bastion">how to connect</a>)</li>
<li><a href="https://grafana.rust-lang.org/d/rpXrFfKWz/instance-metrics?orgId=1&amp;var-instance=bots.infra.rust-lang.org:9100">Instance metrics</a> (only available to infra team members).</li>
</ul>
<h2 id="common-maintenance-procedures-5"><a class="header" href="#common-maintenance-procedures-5">Common maintenance procedures</a></h2>
<h3 id="adding-a-new-domain"><a class="header" href="#adding-a-new-domain">Adding a new domain</a></h3>
<p>First, edit <code>sudo vim /etc/nginx/nginx.conf</code> to edit the nginx configuration to add the domain.</p>
<pre><code>server {
    listen 443 ssl;
    listen [::]:443 ssl;
    server_name &lt;domain&gt;.infra.rust-lang.org; # Edit &lt;domain&gt; to match here

    location /.well-known/acme-challenge {
        root /home/ssl-renew/challenges;
    }

    location / {
        # configure the domain here
    }
}
</code></pre>
<p>Then run <code>sudo -i -u ssl-renew vim renew.sh</code>. Add a <code>--domains</code> line to the script with the domain you're adding.</p>
<p>Then, run the script: <code>sudo -i -u ssl-renew ./renew.sh</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-the-rust-ci-works"><a class="header" href="#how-the-rust-ci-works">How the Rust CI works</a></h1>
<h2 id="which-jobs-we-run"><a class="header" href="#which-jobs-we-run">Which jobs we run</a></h2>
<p>The <code>rust-lang/rust</code> repository uses Azure Pipelines to test <a href="https://doc.rust-lang.org/nightly/rustc/platform-support.html">all the other
platforms</a> we support. We currently have two kinds of jobs running
for each commit we want to merge to master:</p>
<ul>
<li>
<p>Dist jobs build a full release of the compiler for that platform, including
all the tools we ship through rustup; Those builds are then uploaded to the
<code>rust-lang-ci2</code> S3 bucket and are available to be locally installed with the
<a href="https://github.com/kennytm/rustup-toolchain-install-master">rustup-toolchain-install-master</a> tool; The same builds are also used for
actual releases: our release process basically consists of copying those
artifacts from <code>rust-lang-ci2</code> to the production endpoint and signing them.</p>
</li>
<li>
<p>Non-dist jobs run our full test suite on the platform, and the test suite of
all the tools we ship through rustup; The amount of stuff we test depends on
the platform (for example some tests are run only on Tier 1 platforms), and
some quicker platforms are grouped together on the same builder to avoid
wasting CI resources.</p>
</li>
</ul>
<p>All the builds except those on macOS and Windows are executed inside that
platform’s custom Docker container. This has a lot of advantages for us:</p>
<ul>
<li>The build environment is consistent regardless of the changes of the
underlying image (switching from the trusty image to xenial was painless for
us).</li>
<li>We can use ancient build environments to ensure maximum binary compatibility,
for example <a href="https://github.com/rust-lang/rust/blob/master/src/ci/docker/host-x86_64/dist-x86_64-linux/Dockerfile">using CentOS 5</a> on our Linux builders.</li>
<li>We can avoid reinstalling tools (like QEMU or the Android emulator) every
time thanks to Docker image caching.</li>
<li>Users can run the same tests in the same environment locally by just running
<code>src/ci/docker/run.sh image-name</code>, which is awesome to debug failures.</li>
</ul>
<p>We also run tests for less common architectures (mainly Tier 2 and Tier 3
platforms) on Azure Pipelines. Since those platforms are not x86 we either run
everything inside QEMU or just cross-compile if we don’t want to run the tests
for that platform.</p>
<h2 id="merging-prs-serially-with-bors"><a class="header" href="#merging-prs-serially-with-bors">Merging PRs serially with bors</a></h2>
<p>CI services usually test the last commit of a branch merged with the last
commit in master, and while that’s great to check if the feature works in
isolation it doesn’t provide any guarantee the code is going to work once it’s
merged. Breakages like these usually happen when another, incompatible PR is
merged after the build happened.</p>
<p>To ensure a master that works all the time we forbid manual merges: instead all
PRs have to be approved through our bot, <a href="https://github.com/bors">bors</a> (the software behind it is
called <a href="https://github.com/rust-lang/homu">homu</a>). All the approved PRs are put <a href="https://bors.rust-lang.org/queue/rust">in a queue</a> (sorted
by priority and creation date) and are automatically tested one at the time. If
all the builders are green the PR is merged, otherwise the failure is recorded
and the PR will have to be re-approved again.</p>
<p>Bors doesn’t interact with CI services directly, but it works by pushing the
merge commit it wants to test to a branch called <code>auto</code>, and detecting the
outcome of the build by listening for either Commit Statuses or Check Runs.
Since the merge commit is based on the latest master and only one can be tested
at the same time, when the results are green master is fast-forwarded to that
merge commit.</p>
<p>Unfortunately testing a single PR at the time, combined with our long CI (~3.5
hours for a full run), means we can’t merge too many PRs in a single day, and a
single failure greatly impacts our throughput for the day. The maximum number
of PRs we can merge in a day is 7.</p>
<h3 id="rollups-1"><a class="header" href="#rollups-1">Rollups</a></h3>
<p>Some PRs don’t need the full test suite to be executed: trivial changes like
typo fixes or README improvements <em>shouldn’t</em> break the build, and testing
every single one of them for 2 to 3 hours is a big waste of time. To solve this
we do a &quot;rollup&quot;, a PR where we merge all the trivial PRs so they can be tested
together. Rollups are created manually by a team member who uses their
judgement to decide if a PR is risky or not, and are the best tool we have at
the moment to keep the queue in a manageable state.</p>
<h3 id="try-builds"><a class="header" href="#try-builds">Try builds</a></h3>
<p>Sometimes we need a working compiler build before approving a PR, usually for
<a href="https://perf.rust-lang.org">benchmarking</a> or <a href="https://github.com/rust-lang/crater">checking the impact of the PR across the
ecosystem</a>. Bors supports creating them by pushing the merge commit on
a separate branch (<code>try</code>), and they basically work the same as normal builds,
without the actual merge at the end. Any number of try builds can happen at the
same time, even if there is a normal PR in progress.</p>
<h2 id="which-branches-we-test"><a class="header" href="#which-branches-we-test">Which branches we test</a></h2>
<p>Our builders are defined in <code>src/ci/azure-pipelines/</code>, and they depend on the
branch used for the build. Each job is configured in one of the top <code>.yml</code>
files.</p>
<h3 id="pr-builds"><a class="header" href="#pr-builds">PR builds</a></h3>
<p>All the commits pushed in a PR run a limited set of tests: a job containing a
bunch of lints plus a cross-compile check build to Windows mingw (without
producing any artifacts) and the <code>x86_64-gnu-llvm-6.0</code> non-dist builder. Those
two builders are enough to catch most of the common errors introduced in a PR,
but they don’t cover other platforms at all. Unfortunately it would take too
many resources to run the full test suite for each commit on every PR.</p>
<p>Additionally, if the PR changes submodules the <code>x86_64-gnu-tools</code> non-dist
builder is run.</p>
<h3 id="the-try-branch"><a class="header" href="#the-try-branch">The <code>try</code> branch</a></h3>
<p>On the main rust repo try builds produce just a Linux toolchain. Builds on
those branches run a job containing the lint builder and both the dist and
non-dist builders for <code>linux-x86_64</code>. Usually we don’t need <code>try</code> builds for
other platforms, but on the rare cases when this is needed we just add a
temporary commit that changes the <code>src/ci/azure-pipelines/try.yml</code> file to
enable the builders we need on that platform (disabling Linux to avoid wasting
CI resources).</p>
<h3 id="the-auto-branch"><a class="header" href="#the-auto-branch">The <code>auto</code> branch</a></h3>
<p>This branch is used by bors to run all the tests on a PR before merging it, so
all the builders are enabled for it. bors will repeatedly force-push on it
(every time a new commit is tested).</p>
<h3 id="the-master-branch"><a class="header" href="#the-master-branch">The <code>master</code> branch</a></h3>
<p>Since all the commits to <code>master</code> are fast-forwarded from the <code>auto</code> branch (if
they pass all the tests there) we don’t need to build or test anything. A quick
job is executed on each push to update toolstate (see the toolstate description
below).</p>
<h3 id="other-branches"><a class="header" href="#other-branches">Other branches</a></h3>
<p>Other branches are just disabled and don’t run any kind of builds, since all
the in-progress branches will eventually be tested in a PR. We try to encourage
contributors to create branches on their own fork, but there is no way for us
to disable that.</p>
<h2 id="caching"><a class="header" href="#caching">Caching</a></h2>
<p>The main rust repository doesn’t use the native Azure Pipelines caching tools.
All our caching is uploaded to an S3 bucket we control
(<code>rust-lang-ci-sccache2</code>), and it’s used mainly for two things:</p>
<h3 id="docker-images-caching"><a class="header" href="#docker-images-caching">Docker images caching</a></h3>
<p>The Docker images we use to run most of the Linux-based builders take a <em>long</em>
time to fully build: every time we need to build them (for example when the CI
scripts change) we consistently reach the build timeout, forcing us to retry
the merge. To avoid the timeouts we cache the exported images on the S3 bucket
(with <code>docker save</code>/<code>docker load</code>).</p>
<p>Since we test multiple, diverged branches (<code>master</code>, <code>beta</code> and <code>stable</code>) we
can’t rely on a single cache for the images, otherwise builds on a branch would
override the cache for the others. Instead we store the images identifying them
with a custom hash, made from the host’s Docker version and the contents of all
the Dockerfiles and related scripts.</p>
<h3 id="llvm-caching-with-sccache"><a class="header" href="#llvm-caching-with-sccache">LLVM caching with sccache</a></h3>
<p>We build some C/C++ stuff during the build and we rely on <a href="https://github.com/mozilla/sccache">sccache</a> to cache
intermediate LLVM artifacts. Sccache is a distributed ccache developed by
Mozilla, and it can use an object storage bucket as the storage backend, like
we do with our S3 bucket.</p>
<h2 id="custom-tooling-around-ci"><a class="header" href="#custom-tooling-around-ci">Custom tooling around CI</a></h2>
<p>During the years we developed some custom tooling to improve our CI experience.</p>
<h3 id="cancelbot-to-keep-the-queue-short"><a class="header" href="#cancelbot-to-keep-the-queue-short">Cancelbot to keep the queue short</a></h3>
<p>We have limited CI capacity on Azure Pipelines, and while that’s enough for a
single build we can’t run more than one at the time. Unfortunately when a job
fails the other jobs on the same build will continue to run, limiting the
available capacity. To avoid the issue we have a tool called <a href="https://github.com/rust-lang/rust-central-station/tree/master/cancelbot">cancelbot</a> that
runs in cron every 2 minutes and kills all the jobs not related to a running
build through the API.</p>
<h3 id="rust-log-analyzer-to-show-the-error-message-in-prs"><a class="header" href="#rust-log-analyzer-to-show-the-error-message-in-prs">Rust Log Analyzer to show the error message in PRs</a></h3>
<p>The build logs for <code>rust-lang/rust</code> are huge, and it’s not practical to find
what caused the build to fail by looking at the logs. To improve the
developers’ experience we developed a bot called <a href="https://github.com/rust-lang/rust-log-analyzer">Rust Log Analyzer</a> (RLA)
that receives the build logs on failure and extracts the error message
automatically, posting it on the PR.</p>
<p>The bot is not hardcoded to look for error strings, but was trained with a
bunch of build failures to recognize which lines are common between builds and
which are not. While the generated snippets can be weird sometimes, the bot is
pretty good at identifying the relevant lines even if it’s an error we never
saw before.</p>
<h3 id="toolstate-to-support-allowed-failures"><a class="header" href="#toolstate-to-support-allowed-failures">Toolstate to support allowed failures</a></h3>
<p>The <code>rust-lang/rust</code> repo doesn’t only test the compiler on its CI, but also
all the tools distributed through rustup (like miri). Since
those tools rely on the compiler internals (which don’t have any kind of
stability guarantee) they often break after the compiler code is changed.</p>
<p>If we blocked merging rustc PRs on the tools being fixed we would be stuck in a
chicken-and-egg problem, because the tools need the new rustc to be fixed but
we can’t merge the rustc change until the tools are fixed. To avoid the problem
most of the tools are allowed to fail, and their status is recorded in
<a href="https://rust-lang-nursery.github.io/rust-toolstate">rust-toolstate</a>. When a tool breaks a bot automatically pings the tool authors
so they know about the breakage, and it records the failure on the toolstate
repository. The release process will then ignore broken tools on nightly,
removing them from the shipped nightlies.</p>
<p>While tool failures are allowed most of the time, they’re automatically
forbidden a week before a release: we don’t care if tools are broken on nightly
but they must work on beta and stable, so they also need to work on nightly a
few days before we promote nightly to beta.</p>
<p>More information is available in the <a href="https://forge.rust-lang.org/infra/toolstate.html">toolstate documentation</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sentry"><a class="header" href="#sentry">Sentry</a></h1>
<p>The infrastructure team manages a <a href="https://sentry.io">Sentry</a> organization on
<code>sentry.io</code> for the Rust Team to use. The instance is generously sponsored by
Sentry, and this document explains how to use it.</p>
<h2 id="log-into-the-instance"><a class="header" href="#log-into-the-instance">Log into the instance</a></h2>
<p>Every member of the <code>rust-lang</code> GitHub organization can authenticate in our
Sentry instance, using their GitHub credentials. Visit <a href="https://sentry.io/auth/login/">the authentication
page</a>, click the &quot;Single Sign-On&quot; tab and enter the <code>rust-lang</code>
Organization ID. You'll be then prompted to log with your GitHub Account!</p>
<p>If this is the first time signing into our Sentry organization, you might have
to <a href="https://sentry.io/settings/rust-lang/teams/">request access to the teams you're on</a>. Once you request access, a
member of the infrastructure team will approve it.</p>
<h2 id="request-a-new-project"><a class="header" href="#request-a-new-project">Request a new project</a></h2>
<p>If you're a member of a Rust Team and you want to use Sentry for a project your
team manages, you need to follow these steps:</p>
<ol>
<li>
<p>If the project is public facing (i.e. people outside the team are supposed
to access it) you need to contact the Core team to request support in
amending the privacy policy, adding a note that your service is using Sentry
too similar to the existing ones.</p>
</li>
<li>
<p>Once the privacy policy is sorted out (whenever needed), you can contact the
infrastructure team to create a new project in the Sentry interface and
potentially a new Sentry team.</p>
</li>
<li>
<p>Finally, you can integrate the Sentry SDK with your project.</p>
</li>
</ol>
<h2 id="creating-a-new-project"><a class="header" href="#creating-a-new-project">Creating a new project</a></h2>
<p>This section documents how the infrastructure team can actually create new
projects when requested. You need to either have a personal Sentry account with
&quot;Owner&quot; permissions, or access to the Sensitive 1Password vault (where the
admin credentials are stored).</p>
<p>To create a project, authenticate in Sentry and visit the <a href="https://sentry.io/organizations/rust-lang/projects/new/">create new project
page</a>. Pick the technology stack the team is using, a relevant name and
the team responsible for it (you can create new teams by clicking the &quot;+&quot;
icon). Finally, if you created a new team, add the relevant people to it.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="language"><a class="header" href="#language">Language</a></h1>
<p>This section documents meta processes by the language team.</p>
<h3 id="external-links-5"><a class="header" href="#external-links-5">External Links</a></h3>
<ul>
<li>The language team has communications channels on <a href="https://discord.gg/rust-lang">Discord</a> as well as <a href="https://rust-lang.zulipchat.com">Zulip</a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rfc-merge-procedure"><a class="header" href="#rfc-merge-procedure">RFC Merge Procedure</a></h1>
<p>Once an RFC has been accepted (i.e., the final comment period is complete, and
no major issues were raised), it must be merged. Right now this is a manual
process, though just about anyone can do it (if you're not a subteam member,
though, you'll have to open a PR rather than merge the RFC manually). Here is
the complete set of steps to merge an RFC -- in some cases, not all the steps
will be applicable.</p>
<h3 id="step-1-open-tracking-issue"><a class="header" href="#step-1-open-tracking-issue">Step 1: Open tracking issue</a></h3>
<p>Open a tracking issue over on rust-lang/rust. Here is a template for the issue
text. You'll have to adjust the various places labeled XXX with some suitable
content (e.g., the name of the RFC, or the most appropriate team).</p>
<pre><code class="language-markdown">This is a tracking issue for the RFC &quot;XXX&quot; (rust-lang/rfcs#NNN).

**Steps:**

- [ ] Implement the RFC (cc @rust-lang/XXX -- can anyone write up mentoring
      instructions?)
- [ ] Adjust documentation ([see instructions on rustc-dev-guide][doc-guide])
- [ ] Stabilization PR ([see instructions on rustc-dev-guide][stabilization-guide])

[stabilization-guide]: https://rustc-dev-guide.rust-lang.org/stabilization_guide.html#stabilization-pr
[doc-guide]: https://rustc-dev-guide.rust-lang.org/stabilization_guide.html#documentation-prs

**Unresolved questions:**

XXX --- list all the &quot;unresolved questions&quot; found in the RFC to ensure they are
not forgotten
</code></pre>
<p>Add the following labels to the issue:</p>
<ul>
<li><code>B-rfc-approved</code></li>
<li><code>C-tracking-issue</code></li>
<li>the approriate <code>T-XXX</code> label</li>
</ul>
<p>(If you don't have permissions to do so, leave a note cc'ing the appropriate
team and asking them to do so.)</p>
<h3 id="step-2-merge-the-rfc-pr-itself"><a class="header" href="#step-2-merge-the-rfc-pr-itself">Step 2: Merge the RFC PR itself</a></h3>
<p>In your local git checkout:</p>
<ul>
<li>Merge the RFC PR into master in your fork</li>
<li>Add a commit that moves the file name from 0000- to its RFC number</li>
<li>Edit the new file to include links to the RFC PR and the tracking issue you
just created in the header</li>
<li>Open a PR or push directly to the master branch on rust-lang/rfcs, as
appropriate</li>
</ul>
<h3 id="step-3-leave-a-comment"><a class="header" href="#step-3-leave-a-comment">Step 3: Leave a comment</a></h3>
<p>Leave a final comment on the PR directing everyone to the tracking issue.
Something like this, but feel free to add your own personal flavor (and change
the team):</p>
<pre><code class="language-markdown">**Huzzah!** The @rust-lang/lang team has decided **to accept** this RFC.

To track further discussion, subscribe to the tracking issue here:
rust-lang/rust#41517
</code></pre>
<h3 id="step-4-update-the-rendered-link"><a class="header" href="#step-4-update-the-rendered-link">Step 4: Update the rendered link</a></h3>
<p>Update the rendered link in the first post of the PR to the permanent home under
<code>https://github.com/rust-lang/rfcs/blob/master/text/</code>.</p>
<p>(This way future visitors can open it easily after the PR branch is deleted.)</p>
<h3 id="thats-it-youre-done"><a class="header" href="#thats-it-youre-done">That's it, you're done!</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="triage-meeting-procedure"><a class="header" href="#triage-meeting-procedure">Triage meeting procedure</a></h1>
<p>This page documents how to run a lang team triage meeting,
should you have the misfortune of being forced to do so.</p>
<h2 id="attending-a-meeting"><a class="header" href="#attending-a-meeting">Attending a meeting</a></h2>
<p>If you would just like to <strong>attend</strong> a lang-team triage meeting, all
you have to do is join the zoom call (the URL is attached to the
calendar invite below).</p>
<h2 id="scheduling"><a class="header" href="#scheduling">Scheduling</a></h2>
<p>Note that the scheduling for all meetings is recorded in the <a href="https://github.com/rust-lang/lang-team/#meeting-calendar">team
calendar</a>, links to which can be found on the <a href="https://github.com/rust-lang/lang-team/">rust-lang/lang-team</a>
repository.</p>
<h2 id="pre-triage"><a class="header" href="#pre-triage">Pre-triage</a></h2>
<p>To start, we have a pre-triage meeting which occurs before the main
meeting. This is not recorded. It is boring.</p>
<p>To execute this meeting you:</p>
<ul>
<li>Open the <a href="https://paper.dropbox.com/doc/T-Lang-Meeting-Current-meeting--AmyXFNnryXTNzBsSWjbdJcVSAg-nRfrSxCbfeo9q7fEYogZQ">Current Meeting</a> dropbox paper document</li>
<li>Skim down the action items and look to see if there are any you know have been handled
<ul>
<li>they can be checked off and removed</li>
</ul>
</li>
<li>Skip down to the Triage section</li>
<li>For each Triage section, click on the link and populate it with what you find
<ul>
<li>typically it is best to copy-and-paste the title of the issue, so that links remain intact</li>
</ul>
</li>
<li>For each item, click in and try to add a few notes as to the main topic
<ul>
<li>look for things where there isn't much discussion needed, or just reminders</li>
<li>these can be handled quickly in the meeting, or perhaps not at all</li>
<li>items that require more discussion will need time alotted for them</li>
</ul>
</li>
</ul>
<h2 id="main-meeting"><a class="header" href="#main-meeting">Main meeting</a></h2>
<ul>
<li>Ping the team on discord <code>@lang-team</code></li>
<li>Begin the recording on Zoom, if you have acccess 
<ul>
<li>If nobody has access to the recording, oh well, we don't do it every week</li>
</ul>
</li>
<li>Discuss item by item and take some notes on what was said
<ul>
<li>Add specific actions to the action items section above</li>
<li>If a consensus arises, make sure to create an action item to document it!</li>
<li>The goal should be that we leave some comment on every issue</li>
</ul>
</li>
</ul>
<h2 id="after-meeting"><a class="header" href="#after-meeting">After meeting</a></h2>
<ul>
<li>Export the meeting file to markdown
<ul>
<li>you will need to cleanup &quot;check boxes&quot; -- Niko usually searches and replaces 
<code>^(\s*)[ ]</code> with <code>\1* [ ]</code> or something like that to insert a
<code>*</code> before them, which makes them valid markdown</li>
</ul>
</li>
<li>Upload video to youtube if applicable and get the URL</li>
<li>Add the file to the <a href="https://github.com/rust-lang/lang-team/tree/master/minutes">minutes</a> directory of <a href="https://github.com/rust-lang/lang-team/">rust-lang/lang-team</a> repository
with a file name like <code>YYYY-MM-DD.md</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="libs"><a class="header" href="#libs">Libs</a></h1>
<p>This section documents meta processes by the Libs team.</p>
<h2 id="where-to-find-us"><a class="header" href="#where-to-find-us">Where to find us</a></h2>
<p>The <a href="https://github.com/rust-lang/libs-team"><code>rust-lang/libs-team</code></a> GitHub repository is the home of the Libs team.
It has details on current project groups, upcoming meetings, and the status of tracking issues.</p>
<p>The Libs team hangs out primarily in <a href="https://rust-lang.zulipchat.com/">the rust-lang Zulip</a> these days in the <code>#t-libs</code> stream.</p>
<p>You can also find out more details about <a href="libs/../../platforms/zulip.html">Zulip and how the Rust community uses it</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="maintaining-the-standard-library"><a class="header" href="#maintaining-the-standard-library">Maintaining the standard library</a></h1>
<blockquote>
<p>Everything I wish I knew before somebody gave me <code>r+</code></p>
</blockquote>
<p>This document is an effort to capture some of the context needed to develop and maintain the Rust standard library. It’s goal is to help members of the Libs team share the process and experience they bring to working on the standard library so other members can benefit. It’ll probably accumulate a lot of trivia that might also be interesting to members of the wider Rust community.</p>
<p>This document doesn't attempt to discuss best practices or good style. For that, see the <a href="https://rust-lang.github.io/api-guidelines">API Guidelines</a>.</p>
<h2 id="contributing"><a class="header" href="#contributing">Contributing</a></h2>
<p>If you spot anything that is outdated, under specified, missing, or just plain incorrect then feel free to open up a PR on the <a href="https://github.com/rust-lang/rust-forge"><code>rust-lang/rust-forge</code></a> repository!</p>
<h2 id="terms"><a class="header" href="#terms">Terms</a></h2>
<ul>
<li>Libs. That's us! The team responsible for development and maintenance of the standard library (among other things).</li>
<li>Pull request (PR). A regular GitHub pull request against <a href="https://github.com/rust-lang/rust"><code>rust-lang/rust</code></a>.</li>
<li>Request for Comment (RFC). A formal document created in <a href="https://github.com/rust-lang/rfcs"><code>rust-lang/rfcs</code></a> that introduces new features.</li>
<li>Tracking Issue. A regular issue on GitHub that’s tagged with <code>C-tracking-issue</code>.</li>
<li>Final Comment Period (FCP). Coordinated by <a href="https://github.com/rust-lang/rfcbot-rs"><code>rfcbot</code></a> that gives relevant teams a chance to review RFCs and PRs.</li>
</ul>
<h2 id="if-youre-ever-unsure"><a class="header" href="#if-youre-ever-unsure">If you’re ever unsure…</a></h2>
<p>Maintaining the standard library can feel like a daunting responsibility! Through <a href="https://github.com/rust-lang/highfive"><code>highfive</code></a>, the automated reviewer assignment, you’ll find yourself dropped into a lot of new contexts.</p>
<p>Ping the <code>@rust-lang/libs</code> team on GitHub anytime. We’re all here to help!</p>
<p>If you don’t think you’re the best person to review a PR then use <a href="https://github.com/rust-lang/highfive"><code>highfive</code></a> to assign it to somebody else.</p>
<h2 id="finding-reviews-waiting-for-your-input"><a class="header" href="#finding-reviews-waiting-for-your-input">Finding reviews waiting for your input</a></h2>
<p>Please remember to regularly check https://rfcbot.rs/. Click on any occurrence of your nickname to go to a page like https://rfcbot.rs/fcp/SimonSapin that only shows the reviews that are waiting for your input.</p>
<h2 id="reviewing-prs"><a class="header" href="#reviewing-prs">Reviewing PRs</a></h2>
<p>As a member of the Libs team you’ll find yourself assigned to PRs that need reviewing, and your input requested on issues in the Rust project.</p>
<h3 id="when-is-an-rfc-needed"><a class="header" href="#when-is-an-rfc-needed">When is an RFC needed?</a></h3>
<p>New unstable features don't need an RFC before they can be merged. If the feature is small, and the design space is straightforward, stabilizing it usually only requires the feature to go through FCP. Sometimes however, you may ask for an RFC before stabilizing.</p>
<h3 id="is-there-any-unsafe"><a class="header" href="#is-there-any-unsafe">Is there any <code>unsafe</code>?</a></h3>
<p>Unsafe code blocks in the standard library need a comment explaining why they're <a href="https://doc.rust-lang.org/nomicon">ok</a>. There's a <code>tidy</code> lint that checks this. The unsafe code also needs to actually be ok.</p>
<p>The rules around what's sound and what's not can be subtle. See the <a href="https://github.com/rust-lang/unsafe-code-guidelines">Unsafe Code Guidelines WG</a> for current thinking, and consider pinging <code>@rust-lang/libs</code>, <code>@rust-lang/lang</code>, and/or somebody from the WG if you're in <em>any</em> doubt. We love debating the soundness of unsafe code, and the more eyes on it the better!</p>
<h3 id="is-that-inline-right"><a class="header" href="#is-that-inline-right">Is that <code>#[inline]</code> right?</a></h3>
<p>Inlining is a trade-off between potential execution speed, compile time and code size. There's some discussion about it in <a href="https://github.com/rust-lang/hashbrown/pull/119">this PR to the <code>hashbrown</code> crate</a>. From the thread:</p>
<blockquote>
<p><code>#[inline]</code> is very different than simply just an inline hint. As I mentioned before, there's no equivalent in C++ for what <code>#[inline]</code> does. In debug mode rustc basically ignores <code>#[inline]</code>, pretending you didn't even write it. In release mode the compiler will, by default, codegen an <code>#[inline]</code> function into every single referencing codegen unit, and then it will also add <code>inlinehin</code>t. This means that if you have 16 CGUs and they all reference an item, every single one is getting the entire item's implementation inlined into it.</p>
</blockquote>
<p>You can add <code>#[inline]</code>:</p>
<ul>
<li>To public, small, non-generic functions.</li>
</ul>
<p>You shouldn't need <code>#[inline]</code>:</p>
<ul>
<li>On methods that have any generics in scope.</li>
<li>On methods on traits that don't have a default implementation.</li>
</ul>
<p><code>#[inline]</code> can always be introduced later, so if you're in doubt they can just be removed.</p>
<h4 id="what-about-inlinealways"><a class="header" href="#what-about-inlinealways">What about <code>#[inline(always)]</code>?</a></h4>
<p>You should just about never need <code>#[inline(always)]</code>. It may be beneficial for private helper methods that are used in a limited number of places or for trivial operators. A micro benchmark should justify the attribute.</p>
<h3 id="is-there-any-potential-breakage"><a class="header" href="#is-there-any-potential-breakage">Is there any potential breakage?</a></h3>
<p>Breaking changes should be avoided when possible. <a href="https://rust-lang.github.io/rfcs/1105-api-evolution.html">RFC 1105</a> lays the foundations for what constitutes a breaking change. Breakage may be deemed acceptable or not based on its actual impact, which can be approximated with a <a href="https://github.com/rust-lang/crater"><code>crater</code></a> run.</p>
<p>There are strategies for mitigating breakage depending on the impact.</p>
<p>For changes where the value is high and the impact is high too:</p>
<ul>
<li>Using compiler lints to try phase out broken behavior.</li>
</ul>
<p>If the impact isn't too high:</p>
<ul>
<li>Looping in maintainers of broken crates and submitting PRs to fix them.</li>
</ul>
<h3 id="is-behavior-changed"><a class="header" href="#is-behavior-changed">Is behavior changed?</a></h3>
<p>Breaking changes aren't just limited to compilation failures. Behavioral changes to stable functions generally can't be accepted. See <a href="https://github.com/rust-lang/rust/pull/46799">the <code>home_dir</code> issue</a> for an example.</p>
<h3 id="are-there-new-impls-for-stable-traits"><a class="header" href="#are-there-new-impls-for-stable-traits">Are there new impls for stable traits?</a></h3>
<p>A lot of PRs to the standard library are adding new impls for already stable traits, which can break consumers in many weird and wonderful ways. The following sections gives some examples of breakage from new trait impls that may not be obvious just from the change made to the standard library.</p>
<h4 id="inference-breaks-when-a-second-generic-impl-is-introduced"><a class="header" href="#inference-breaks-when-a-second-generic-impl-is-introduced">Inference breaks when a second generic impl is introduced</a></h4>
<p>Rust will use the fact that there's only a single impl for a generic trait during inference. This breaks once a second impl makes the type of that generic ambiguous. Say we have:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// in `std`
impl From&lt;&amp;str&gt; for Arc&lt;str&gt; { .. }
<span class="boring">}
</span></code></pre></pre>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// in an external `lib`
let b = Arc::from(&quot;a&quot;);
<span class="boring">}
</span></code></pre></pre>
<p>then we add:</p>
<pre><code class="language-diff">impl From&lt;&amp;str&gt; for Arc&lt;str&gt; { .. }
+ impl From&lt;&amp;str&gt; for Arc&lt;String&gt; { .. }
</code></pre>
<p>then</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let b = Arc::from(&quot;a&quot;);
<span class="boring">}
</span></code></pre></pre>
<p>will no longer compile, because we've previously been relying on inference to figure out the <code>T</code> in <code>Box&lt;T&gt;</code>.</p>
<p>This kind of breakage can be ok, but a <a href="https://github.com/rust-lang/crater"><code>crater</code></a> run should estimate the scope.</p>
<h4 id="deref-coercion-breaks-when-a-new-impl-is-introduced"><a class="header" href="#deref-coercion-breaks-when-a-new-impl-is-introduced">Deref coercion breaks when a new impl is introduced</a></h4>
<p>Rust will use deref coercion to find a valid trait impl if the arguments don't type check directly. This only seems to occur if there's a single impl so introducing a new one may break consumers relying on deref coercion. Say we have:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// in `std`
impl Add&lt;&amp;str&gt; for String { .. }

impl Deref for String { type Target = str; .. }
<span class="boring">}
</span></code></pre></pre>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// in an external `lib`
let a = String::from(&quot;a&quot;);
let b = String::from(&quot;b&quot;);

let c = a + &amp;b;
<span class="boring">}
</span></code></pre></pre>
<p>then we add:</p>
<pre><code class="language-diff">impl Add&lt;&amp;str&gt; for String { .. }
+ impl Add&lt;char&gt; for String { .. }
</code></pre>
<p>then</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let c = a + &amp;b;
<span class="boring">}
</span></code></pre></pre>
<p>will no longer compile, because we won't attempt to use deref to coerce the <code>&amp;String</code> into <code>&amp;str</code>.</p>
<p>This kind of breakage can be ok, but a <a href="https://github.com/rust-lang/crater"><code>crater</code></a> run should estimate the scope.</p>
<h3 id="could-an-implementation-use-existing-functionality"><a class="header" href="#could-an-implementation-use-existing-functionality">Could an implementation use existing functionality?</a></h3>
<p>Types like <code>String</code> are implemented in terms of <code>Vec&lt;u8&gt;</code> and can use methods on <code>str</code> through deref coersion. <code>Vec&lt;T&gt;</code> can use methods on <code>[T]</code> through deref coersion. When possible, methods on a wrapping type like <code>String</code> should defer to methods that already exist on their underlying storage or deref target.</p>
<h3 id="are-there-fundamental-items-involved"><a class="header" href="#are-there-fundamental-items-involved">Are there <code>#[fundamental]</code> items involved?</a></h3>
<p>Blanket trait impls can't be added to <code>#[fundamental]</code> types because they have different coherence rules. See <a href="https://rust-lang.github.io/rfcs/1023-rebalancing-coherence.html">RFC 1023</a> for details. That includes:</p>
<ul>
<li><code>&amp;T</code></li>
<li><code>&amp;mut T</code></li>
<li><code>Box&lt;T&gt;</code></li>
<li><code>Pin&lt;T&gt;</code></li>
</ul>
<h3 id="is-specialization-involved"><a class="header" href="#is-specialization-involved">Is specialization involved?</a></h3>
<p>Specialization is currently unstable. You can track its progress <a href="https://github.com/rust-lang/rust/issues/31844">here</a>.</p>
<p>We try to avoid leaning on specialization too heavily, limiting its use to optimizing specific implementations. These specialized optimizations use a private trait to find the correct implementation, rather than specializing the public method itself. Any use of specialization that changes how methods are dispatched for external callers should be carefully considered.</p>
<p>As an example of how to use specialization in the standard library, consider the case of creating an <code>Rc&lt;[T]&gt;</code> from a <code>&amp;[T]</code>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl&lt;T: Clone&gt; From&lt;&amp;[T]&gt; for Rc&lt;[T]&gt; {
    #[inline]
    fn from(v: &amp;[T]) -&gt; Rc&lt;[T]&gt; {
        unsafe { Self::from_iter_exact(v.iter().cloned(), v.len()) }
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>It would be nice to have an optimized implementation for the case where <code>T: Copy</code>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl&lt;T: Copy&gt; From&lt;&amp;[T]&gt; for Rc&lt;[T]&gt; {
    #[inline]
    fn from(v: &amp;[T]) -&gt; Rc&lt;[T]&gt; {
        unsafe { Self::copy_from_slice(v) }
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>Unfortunately we couldn't have both of these impls normally, because they'd overlap. This is where private specialization can be used to choose the right implementation internally. In this case, we use a trait called <code>RcFromSlice</code> that switches the implementation:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl&lt;T: Clone&gt; From&lt;&amp;[T]&gt; for Rc&lt;[T]&gt; {
    #[inline]
    fn from(v: &amp;[T]) -&gt; Rc&lt;[T]&gt; {
        &lt;Self as RcFromSlice&lt;T&gt;&gt;::from_slice(v)
    }
}

/// Specialization trait used for `From&lt;&amp;[T]&gt;`.
trait RcFromSlice&lt;T&gt; {
    fn from_slice(slice: &amp;[T]) -&gt; Self;
}

impl&lt;T: Clone&gt; RcFromSlice&lt;T&gt; for Rc&lt;[T]&gt; {
    #[inline]
    default fn from_slice(v: &amp;[T]) -&gt; Self {
        unsafe { Self::from_iter_exact(v.iter().cloned(), v.len()) }
    }
}

impl&lt;T: Copy&gt; RcFromSlice&lt;T&gt; for Rc&lt;[T]&gt; {
    #[inline]
    fn from_slice(v: &amp;[T]) -&gt; Self {
        unsafe { Self::copy_from_slice(v) }
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>Only specialization using the <code>min_specialization</code> feature should be used. The full <code>specialization</code> feature is known to be unsound.</p>
<h3 id="are-const-generics-involved"><a class="header" href="#are-const-generics-involved">Are const generics involved?</a></h3>
<p>Const generics are currently unstable. You can track their progress <a href="https://github.com/rust-lang/rust/issues/44580">here</a>.</p>
<p>Using const generics in public APIs is ok, but only const generics using the <code>min_const_generics</code> feature should be used publicly for now.</p>
<h3 id="are-there-public-enums"><a class="header" href="#are-there-public-enums">Are there public enums?</a></h3>
<p>Public enums should have a <code>#[non_exhaustive]</code> attribute if there's any possibility of new variants being introduced, so that they can be added without causing breakage.</p>
<h3 id="does-this-change-drop-order"><a class="header" href="#does-this-change-drop-order">Does this change drop order?</a></h3>
<p>Changes to collection internals may affect the order their items are dropped in. This has been accepted in the past, but should be noted.</p>
<h3 id="is-there-a-manual-drop-implementation"><a class="header" href="#is-there-a-manual-drop-implementation">Is there a manual <code>Drop</code> implementation?</a></h3>
<p>A generic <code>Type&lt;T&gt;</code> that manually implements <code>Drop</code> should consider whether a <code>#[may_dangle]</code> attribute is appropriate on <code>T</code>. The <a href="https://doc.rust-lang.org/nomicon/dropck.html">Nomicon</a> has some details on what <code>#[may_dangle]</code> is all about.</p>
<p>If a generic <code>Type&lt;T&gt;</code> has a manual drop implementation that may also involve dropping <code>T</code> then dropck needs to know about it. If <code>Type&lt;T&gt;</code>'s ownership of <code>T</code> is expressed through types that don't drop <code>T</code> themselves such as <code>ManuallyDrop&lt;T&gt;</code>, <code>*mut T</code>, or <code>MaybeUninit&lt;T&gt;</code> then <code>Type&lt;T&gt;</code> also <a href="https://github.com/rust-lang/rfcs/blob/master/text/0769-sound-generic-drop.md#phantom-data">needs a <code>PhantomData&lt;T&gt;</code> field</a> to tell dropck that <code>T</code> may be dropped. Types in the standard library that use the internal <code>Unique&lt;T&gt;</code> pointer type don't need a <code>PhantomData&lt;T&gt;</code> marker field. That's taken care of for them by <code>Unique&lt;T&gt;</code>.</p>
<p>As a real-world example of where this can go wrong, consider an <code>OptionCell&lt;T&gt;</code> that looks something like this:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct OptionCell&lt;T&gt; {
    is_init: bool,
    value: MaybeUninit&lt;T&gt;,
}

impl&lt;T&gt; Drop for OptionCell&lt;T&gt; {
    fn drop(&amp;mut self) {
        if self.is_init {
            // Safety: `value` is guaranteed to be fully initialized when `is_init` is true.
            // Safety: The cell is being dropped, so it can't be accessed again.
            unsafe { self.value.assume_init_drop() };
        }
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>Adding a <code>#[may_dangle]</code> attribute to this <code>OptionCell&lt;T&gt;</code> that didn't have a <code>PhantomData&lt;T&gt;</code> marker field opened up <a href="https://github.com/rust-lang/rust/issues/76367">a soundness hole</a> for <code>T</code>'s that didn't strictly outlive the <code>OptionCell&lt;T&gt;</code>, and so could be accessed after being dropped in their own <code>Drop</code> implementations. The correct application of <code>#[may_dangle]</code> also required a <code>PhantomData&lt;T&gt;</code> field:</p>
<pre><code class="language-diff">struct OptionCell&lt;T&gt; {
    is_init: bool,
    value: MaybeUninit&lt;T&gt;,
+   _marker: PhantomData&lt;T&gt;,
}

- impl&lt;T&gt; Drop for OptionCell&lt;T&gt; {
+ unsafe impl&lt;#[may_dangle] T&gt; Drop for OptionCell&lt;T&gt; {
</code></pre>
<h3 id="how-could-mem-break-assumptions"><a class="header" href="#how-could-mem-break-assumptions">How could <code>mem</code> break assumptions?</a></h3>
<h4 id="memreplace-and-memswap"><a class="header" href="#memreplace-and-memswap"><code>mem::replace</code> and <code>mem::swap</code></a></h4>
<p>Any value behind a <code>&amp;mut</code> reference can be replaced with a new one using <code>mem::replace</code> or <code>mem::swap</code>, so code shouldn't assume any reachable mutable references can't have their internals changed by replacing.</p>
<h4 id="memforget"><a class="header" href="#memforget"><code>mem::forget</code></a></h4>
<p>Rust doesn't guarantee destructors will run when a value is leaked (which can be done with <code>mem::forget</code>), so code should avoid relying on them for maintaining safety. Remember, <a href="http://cglab.ca/%7Eabeinges/blah/everyone-poops">everyone poops</a>.</p>
<p>It's ok not to run a destructor when a value is leaked because its storage isn't deallocated or repurposed. If the storage is initialized and is being deallocated or repurposed then destructors need to be run first, because <a href="https://doc.rust-lang.org/nightly/std/pin/index.html#drop-guarantee">memory may be pinned</a>. Having said that, there can still be exceptions for skipping destructors when deallocating if you can guarantee there's never pinning involved.</p>
<h3 id="how-is-performance-impacted"><a class="header" href="#how-is-performance-impacted">How is performance impacted?</a></h3>
<p>Changes to hot code might impact performance in consumers, for better or for worse. Appropriate benchmarks should give an idea of how performance characteristics change. For changes that affect <code>rustc</code> itself, you can also do a <a href="https://github.com/rust-lang-nursery/rustc-perf"><code>rust-timer</code></a> run.</p>
<h3 id="is-the-commit-log-tidy"><a class="header" href="#is-the-commit-log-tidy">Is the commit log tidy?</a></h3>
<p>PRs shouldn’t have merge commits in them. If they become out of date with <code>master</code> then they need to be rebased.</p>
<h2 id="merging-prs"><a class="header" href="#merging-prs">Merging PRs</a></h2>
<p>PRs to <a href="https://github.com/rust-lang/rust"><code>rust-lang/rust</code></a> aren’t merged manually using GitHub’s UI or by pushing remote branches. Everything goes through <a href="https://github.com/rust-lang/homu"><code>bors</code></a>.</p>
<h3 id="when-to-rollup"><a class="header" href="#when-to-rollup">When to <code>rollup</code></a></h3>
<p>For Libs PRs, rolling up is usually fine, in particular if it's only a new unstable addition or if it only touches docs.</p>
<p>See the <a href="libs/../compiler/reviews.html#rollups">rollup guidelines</a> for more details on when to rollup. The idea is to try collect a number of PRs together and merge them all at once, rather than individually. This can get things merged faster, but might not be appropriate for some PRs that are likely to conflict, or have performance characteristics that would be obscured in a rollup.</p>
<h3 id="when-theres-new-public-items"><a class="header" href="#when-theres-new-public-items">When there's new public items</a></h3>
<p>If the feature is new, then a tracking issue should be opened for it. Have a look at some previous <a href="https://github.com/rust-lang/rust/issues?q=label%3AC-tracking-issue+label%3AT-libs">tracking issues</a> to get an idea of what needs to go in there. The <code>issue</code> field on <code>#[unstable]</code> attributes should be updated with the tracking issue number.</p>
<p>Unstable features can be merged as normal through <a href="https://github.com/rust-lang/homu"><code>bors</code></a> once they look ready.</p>
<h3 id="when-theres-new-trait-impls"><a class="header" href="#when-theres-new-trait-impls">When there's new trait impls</a></h3>
<p>There’s no way to make a trait impl for a stable trait unstable, so <strong>any PRs that add new impls for already stable traits must go through a FCP before merging.</strong> If the trait itself is unstable though, then the impl needs to be unstable too.</p>
<h3 id="when-a-feature-is-being-stabilized"><a class="header" href="#when-a-feature-is-being-stabilized">When a feature is being stabilized</a></h3>
<p>Features can be stabilized in a PR that replaces <code>#[unstable]</code> attributes with <code>#[stable]</code> ones. The feature needs to have an accepted RFC before stabilizing. They also need to go through a FCP before merging.</p>
<p>You can find the right version to use in the <code>#[stable]</code> attribute by checking the <a href="https://forge.rust-lang.org/">Forge</a>.</p>
<h3 id="when-a-const-function-is-being-stabilized"><a class="header" href="#when-a-const-function-is-being-stabilized">When a <code>const</code> function is being stabilized</a></h3>
<p>Const functions can be stabilized in a PR that replaces <code>#[rustc_const_unstable]</code> attributes with <code>#[rustc_const_stable]</code> ones. The <a href="https://github.com/rust-lang/const-eval">Constant Evaluation WG</a> should be pinged for input on whether or not the <code>const</code>-ness is something we want to commit to. If it is an intrinsic being exposed that is const-stabilized then <code>@rust-lang/lang</code> should also be included in the FCP.</p>
<p>Check whether the function internally depends on other unstable <code>const</code> functions through <code>#[allow_internal_unstable]</code> attributes and consider how the function could be implemented if its internally unstable calls were removed. See the <em>Stability attributes</em> page for more details on <code>#[allow_internal_unstable]</code>.</p>
<p>Where <code>unsafe</code> and <code>const</code> is involved, e.g., for operations which are &quot;unconst&quot;, that the const safety argument for the usage also be documented. That is, a <code>const fn</code> has additional determinism (e.g. run-time/compile-time results must correspond and the function's output only depends on its inputs...) restrictions that must be preserved, and those should be argued when <code>unsafe</code> is used.</p>
<h3 id="when-a-feature-is-being-deprecated"><a class="header" href="#when-a-feature-is-being-deprecated">When a feature is being deprecated</a></h3>
<p>To try reduce noise in the docs from deprecated items, they should be moved to the bottom of the module or <code>impl</code> block so they're rendered at the bottom of the docs page. The docs should then be cut down to focus on why the item is deprecated rather than how you might use it.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="release"><a class="header" href="#release">Release</a></h1>
<p>This section documents the process around creating a new release of the
compiler, tools, as well information on The Rust Programming Language's platform
support.</p>
<h3 id="external-links-6"><a class="header" href="#external-links-6">External Links</a></h3>
<ul>
<li>The <a href="https://bors.rust-lang.org/">Homu/Bors</a> page provides links to the pull request testing queues for the
<code>rust-lang</code> GitHub organisation, as well as providing an overview of the bot's
syntax you can use to interact with it.</li>
<li><a href="https://rust-lang.github.io/rustup-components-history/index.html">Rustup Component History</a> documents when a component was last available (if
it was available) for a specific platform on nightly.</li>
<li><a href="https://rust-lang-nursery.github.io/rustc-pr-tracking/">PR Tracking</a> provides visualisations of pull requests made to the
<code>rust-lang/rust</code> repository.</li>
<li>kennytm's <a href="https://github.com/kennytm/rustup-toolchain-install-master"><code>rustup-toolchain-install-master</code></a> is a utility to install
the latest generated artifacts from CI into <code>rustup</code>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="backporting"><a class="header" href="#backporting">Backporting</a></h1>
<p>There's a steady trickle of patches that need to be ported to the beta and stable branch.
Only a few people are even aware of the process, but this is actually something anybody can do.</p>
<h2 id="beta-backporting-in-rust-langrust"><a class="header" href="#beta-backporting-in-rust-langrust">Beta backporting in <code>rust-lang/rust</code></a></h2>
<p>Backports of PRs to the beta branch are usually only done to fix regressions.
Getting a PR backported to the beta branch involves the following process:</p>
<ol>
<li>
<p>Add the label <a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+label%3Abeta-nominated+-label%3Abeta-accepted"><code>beta-nominated</code></a> to the PR to be backported.
This marks the PR as in the state that it needs attention from the appropriate team to decide if it should be backported.
Anybody with triage access is free to add this label.</p>
</li>
<li>
<p>If the team thinks it should be backported, then they should add the <a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+label%3Abeta-accepted"><code>beta-accepted</code></a> label.
Otherwise they should remove the nominated label.</p>
</li>
<li>
<p>Occasionally someone will make a beta rollup PR.
This is often done by the release team, but it can be done by anyone.
The process here is:</p>
<ol>
<li>
<p>Create a local branch off the <code>beta</code> branch.</p>
</li>
<li>
<p>Cherry-pick all of the PRs that have both <a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aclosed+label%3Abeta-accepted+label%3Abeta-nominated"><code>beta-nominated</code> and <code>beta-accepted</code></a> labels.
It is usually preferred to not include PRs that have not been merged in case there are any last minute changes, or it fails when running the full CI tests.</p>
</li>
<li>
<p>Run <code>./x.py run replace-version-placeholder</code> and if there were any changes, put them into a new commit.</p>
</li>
<li>
<p>(Recommended) Run some tests locally.
It is not uncommon that the backports may not apply cleanly, or the UI tests need to be re-blessed if there are differences in the output.</p>
</li>
<li>
<p>Open a PR <strong>against the beta branch</strong> with a title that starts with <code>[beta]</code> (so reviewers can see its specialness).</p>
</li>
<li>
<p>List all of the PRs being backported in the PR description.
<a href="https://github.com/rust-lang/rust/pull/64097">Here's an example</a>.</p>
</li>
<li>
<p>Go through all of the PRs being backported and:</p>
<ul>
<li>Change the milestone to the correct value for the beta release.</li>
<li>Remove the <code>beta-nominated</code> label.
This indicates that the backport has been completed.</li>
</ul>
<p>If there are a lot of PRs, this can be done quickly by opening the <a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aclosed+label%3Abeta-accepted+label%3Abeta-nominated">nominated + accepted</a> query, check all the PRs being backported, and use the &quot;Milestones&quot; and &quot;Label&quot; drop-downs to modify multiple PRs in bulk.</p>
<p>This last step can be done before or after the beta PR has been merged, though it can be easy to forget if you wait for it to be merged.</p>
</li>
</ol>
</li>
<li>
<p>A reviewer (typically from the release team) needs to verify that the backport looks correct and that it's submitted to the beta branch.
They will then approve with <code>@bors r+ rollup=never</code> (to avoid it being rolled up on accident).
If the author of the PR has r+ rights, and has not made significant changes while backporting, they can also self-approve the PR.</p>
</li>
</ol>
<p>In summary, there are three states that a PR can go through:</p>
<ol>
<li><code>beta-nominated</code>: Needs the team's attention.</li>
<li><code>beta-nominated</code> + <code>beta-accepted</code>: Waiting to be backported.</li>
<li><code>beta-accepted</code>: Backport complete.</li>
</ol>
<h2 id="stable-backporting-in-rust-langrust"><a class="header" href="#stable-backporting-in-rust-langrust">Stable backporting in <code>rust-lang/rust</code></a></h2>
<p>Backports to the stable branch work exactly the same as beta ones, labels have
just a slightly different name: <code>stable-nominated</code> identifies a PR to be
discussed for a backport and <code>stable-accepted</code> is a PR accepted for
backport. Declined stable nomination will have the <code>stable-nominated</code> label
removed.</p>
<p>The <code>T-release</code> will decide on a case by case basis if a stable backport will
warrant a point (.patch) release (f.e. release a <code>1.50.1</code> between <code>1.50</code> and <code>1.51</code>).</p>
<h2 id="beta-backporting-in-rust-langcargo"><a class="header" href="#beta-backporting-in-rust-langcargo">Beta Backporting in <code>rust-lang/cargo</code></a></h2>
<p>The procedure for backporting fixes to Cargo is similar but slightly more
extended than the <code>rust-lang/rust</code> repo's procedure. Currently there aren't
backport tags in the Cargo repository, but you'll initiate the backport process
by commenting on an associated PR, requesting a backport. Once a Cargo team
member has approved the backport to happen you're good to start sending PRs!</p>
<ul>
<li>
<p>First you'll send a PR to the <code>rust-1.21.0</code> branch of Cargo (replace 1.21 with
the current rustc beta version number). Like with <code>rust-lang/rust</code> you'll
prefix the title of your PR with <code>[beta]</code> and ensure it's flagged as going to
beta.</p>
</li>
<li>
<p>Next a Cargo reviewer will <code>@bors: r+</code> the PR and put it into the queue.
Eventually bors will automatically merge the PR (when tests are passing) to
the appropriate Cargo branch.</p>
</li>
<li>
<p>Finally you'll send a PR to the <code>rust-lang/rust</code> repository's <code>beta</code> branch,
updating the Cargo submodule. The Cargo submodule should be updated to the tip
of the <code>rust-1.21.0</code> branch (the branch your Cargo PR was merged to). As like
before, ensure you've got <code>[beta]</code> in the PR title.</p>
</li>
</ul>
<p>After that's all said and done the Cargo change is ready to get scheduled onto
the beta release!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="preparing-release-notes"><a class="header" href="#preparing-release-notes">Preparing Release Notes</a></h1>
<p>The release notes for the next release should be compiled at the beginning of
the beta cycle, 6 weeks ahead of the release.</p>
<p>Clone the <a href="https://github.com/rust-lang/relnotes">relnotes</a> utility. This program pulls all pull requests made against
<code>rust-lang/rust</code> and <code>rust-lang/cargo</code> within the latest release cycle and
prints out a markdown document containing all the pull requests, categorised
into their respective sections where possible, and prints the document to
<code>stdout</code>.</p>
<p>Only pull requests that impact stable users of Rust should be included.
Generally, more exciting items go toward the top of sections. Most items are
simply links to the PR that landed them; some that need more explanation have
additional, unlinked text; anything supported by an RFC has an additional RFC
link. Reuse the PR titles or write descriptions as needed for clarity.</p>
<p>Try to keep the language of the document independent of en-US or en-UK, when it
can't be avoided defer to en-US grammar and syntax.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-rust-release-process"><a class="header" href="#the-rust-release-process">The Rust Release Process</a></h1>
<p>Here's how Rust is currently released:</p>
<h2 id="bump-the-stable-version-number-t-6-days-friday-the-week-before"><a class="header" href="#bump-the-stable-version-number-t-6-days-friday-the-week-before">Bump the stable version number (T-6 days, Friday the week before)</a></h2>
<p>Open a PR bumping the version number in <code>src/version</code>. <code>r+ rollup=never</code> this
PR.</p>
<p>Mark it as <code>rollup=never</code>, because if it lands in a rollup as <em>not</em> the first
PR then other pull requests in that rollup will be incorrectly associated with
the prior release.</p>
<h2 id="promote-branches-t-3-days-monday"><a class="header" href="#promote-branches-t-3-days-monday">Promote branches (T-3 days, Monday)</a></h2>
<p>Both promotions should happen on Monday. You can open both PRs at the same
time, but make sure the stable promotion lands first.</p>
<h3 id="beta-to-stable"><a class="header" href="#beta-to-stable">Beta to stable</a></h3>
<p><a href="release//infra/docs/aws-access.html#using-the-aws-cli">Obtain AWS CLI credentials</a> and run this command from the <a href="https://github.com/rust-lang/simpleinfra">simpleinfra</a> repository:</p>
<pre><code>./release-scripts/promote-release.py branches
</code></pre>
<p>Once that's done, send a PR to the freshly created beta branch of rust-lang/rust
with two commits:</p>
<ul>
<li>The changes caused by running <code>./x.py run replace-version-placeholder</code></li>
<li>An update of <code>src/ci/channel</code> to <code>beta</code></li>
</ul>
<p>The version placeholder replacement changes must be in a separate commit so
that they can be cherry picked to the master branch.</p>
<p>Also send a PR to rust-lang/rust targeting the new stable branch making the
following changes:</p>
<ul>
<li>Update <code>src/ci/channel</code> to <code>stable</code></li>
<li>Update release notes to the latest available copy
<ul>
<li>e.g., <code>git checkout origin/master -- RELEASES.md</code></li>
</ul>
</li>
</ul>
<p>Once the PRs are sent, r+ both and give them a high <code>p=1000</code> (for stable) and
<code>p=10</code> for beta.</p>
<p>After the PR is merged you'll need to start a <strong>dev</strong> release. <a href="release//infra/docs/aws-access.html#using-the-aws-cli">Obtain AWS CLI
credentials</a> and run this command from the <a href="https://github.com/rust-lang/simpleinfra">simpleinfra</a> repository:</p>
<pre><code># The date here is of the actual, production, stable release. Used for the blog post.
./release-scripts/promote-release.py release dev stable --release-date YYYY-MM-DD
</code></pre>
<h2 id="master-bootstrap-update-t-2-day-tuesday"><a class="header" href="#master-bootstrap-update-t-2-day-tuesday">Master bootstrap update (T-2 day, Tuesday)</a></h2>
<p>Send a PR to the master branch to:</p>
<ul>
<li>
<p>Cherry pick the commit that ran <code>./x.py run replace-version-placeholder</code>
from the now merged beta branch PR. Do not re-run the tool as there might
have been other stabilizations on master which were not included in the
branched beta, so may not be attributed to the current release.</p>
</li>
<li>
<p>Run <code>./x.py run src/tools/bump-stage0</code> to update the bootstrap compiler to
the beta you created yesterday.</p>
</li>
<li>
<p>Remove references to the <code>bootstrap</code> and <code>not(bootstrap)</code> conditional
compilation attributes. You can find all of them by installing <a href="https://github.com/burntsushi/ripgrep">ripgrep</a> and
running this command:</p>
<pre><code>rg '#!?\[.*\(bootstrap' -t rust
</code></pre>
<p>The general guidelines (both for <code>#[]</code> and <code>#![]</code>) are:</p>
<ul>
<li>Remove any item annotated with <code>#[cfg(bootstrap)]</code>.</li>
<li>Remove any <code>#[cfg(not(bootstrap))]</code> attribute while keeping the item.</li>
<li>Remove any <code>#[cfg_attr(bootstrap, $attr)]</code> attribute while keeping the item.</li>
<li>Replace any <code>#[cfg_attr(not(bootstrap), doc=&quot;$doc&quot;)]</code> with <code>$doc</code> in the
relevant documentation block (or in a new documentation block).</li>
<li>Replace any <code>#[cfg_attr(not(bootstrap), $attr)]</code> with <code>#[$attr]</code>.</li>
</ul>
</li>
</ul>
<h2 id="release-day-thursday"><a class="header" href="#release-day-thursday">Release day (Thursday)</a></h2>
<p>Decide on a time to do the release, T.</p>
<ul>
<li>
<p><strong>T-50m</strong> - Run the following command in a shell with <a href="release//infra/docs/aws-access.html#using-the-aws-cli">AWS
credentials</a> in the <a href="https://github.com/rust-lang/simpleinfra">simpleinfra</a> repository:</p>
<pre><code>./release-scripts/promote-release.py release prod stable
</code></pre>
<p>That'll, in the background, schedule the <code>promote-release</code> binary to run on
the production secrets (not the dev secrets). That'll sign everything, upload
it, update the html index pages, and invalidate the CDN. Note that this takes
about 30 minutes right now. This will also push a signed tag to rust-lang/rust.</p>
</li>
<li>
<p><strong>T-2m</strong> - Merge blog post.</p>
</li>
<li>
<p><strong>T</strong> - Tweet and post everything!</p>
<ul>
<li>Twitter <a href="https://twitter.com/rustlang">@rustlang</a></li>
<li><a href="https://users.rust-lang.org/">Users forum</a></li>
</ul>
</li>
<li>
<p><strong>T+5m</strong> - Release and tag Cargo. From a rust-lang/rust checkout (script will
checkout the stable branch automatically), run the following script from
<a href="https://github.com/rust-lang/simpleinfra">simpleinfra</a>.</p>
<pre><code class="language-sh">../simpleinfra/release-scripts/tag-cargo.sh
</code></pre>
</li>
<li>
<p><strong>T+1hr</strong> Send a PR to the beta branch running <code>./x.py run src/tools/bump-stage0</code> to bump the boostrap compiler to the stable you
just released.</p>
</li>
</ul>
<p>Bask in your success.</p>
<h2 id="rebuilding-stable-pre-releases"><a class="header" href="#rebuilding-stable-pre-releases">Rebuilding stable pre-releases</a></h2>
<p>If something goes wrong and we need to rebuild the stable artifacts, merge the
PR on the <code>stable</code> branch of the <a href="https://github.com/rust-lang/rust">rust-lang/rust</a> repository. Once the commit
is merged, issue the following command in a shell with <a href="release//infra/docs/aws-access.html#using-the-aws-cli">AWS
credentials</a> on the <a href="https://github.com/rust-lang/simpleinfra">simpleinfra</a> repository:</p>
<pre><code>./release-scripts/promote-release.py release dev stable --bypass-startup-checks
</code></pre>
<p>You'll also want to update the previously published blog post and internals post
with the new information.</p>
<h2 id="publishing-a-nightly-based-off-a-try-build"><a class="header" href="#publishing-a-nightly-based-off-a-try-build">Publishing a nightly based off a try build</a></h2>
<p>Sometimes a PR requires testing how it behaves when downloaded from rustup, for
example after a manifest change. In those cases it's possible to publish a new
nightly based off that PR on dev-static.rust-lang.org.</p>
<p>Once the try build finishes grab the merge commit SHA and run the following
command in a shell with <a href="release//infra/docs/aws-access.html#using-the-aws-cli">AWS credentials</a> on the <a href="https://github.com/rust-lang/simpleinfra">simpleinfra</a>
repository:</p>
<pre><code class="language-sh">./release-scripts/promote-release.py release dev nightly $MERGE_COMMIT_SHA
</code></pre>
<p>When the release process end you'll be able to install the new nightly with:</p>
<pre><code class="language-sh">RUSTUP_DIST_SERVER=https://dev-static.rust-lang.org rustup toolchain install nightly
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rollup-procedure"><a class="header" href="#rollup-procedure">Rollup Procedure</a></h1>
<h2 id="background"><a class="header" href="#background">Background</a></h2>
<p>The Rust project has a policy that every pull request must be tested after merge
before it can be pushed to master. As PR volume increases this can scale poorly,
especially given the long (~3.5hr) current CI duration for Rust.</p>
<p>Enter rollups! Changes that are small, not performance sensitive, or not platform
dependent are marked with the <code>rollup</code> command to bors (<code>@bors r+ rollup</code> to
approve a PR and mark as a rollup, <code>@bors rollup</code> to mark a previously approved
PR, <code>@bors rollup-</code> to un-mark as a rollup).  'Performing a Rollup' then means
collecting these changes into one PR and merging them all at once. The rollup
command accepts four values <code>always</code>, <code>maybe</code>, <code>iffy</code>, and <code>never</code>. See <a href="release/../compiler/reviews.html#rollups">the
Rollups section</a> of the review policies for guidance on what these different
statuses mean.</p>
<p>You can see the list of rollup PRs on Rust's <a href="https://bors.rust-lang.org/queue/rust">Homu queue</a>, they are
listed at the bottom of the 'approved' queue with a priority of 'rollup' meaning
they will not be merged by themselves until everything in front of them in the
queue has been merged.</p>
<h2 id="making-a-rollup"><a class="header" href="#making-a-rollup">Making a Rollup</a></h2>
<ol>
<li>
<p>Using the interface on <a href="https://bors.rust-lang.org/queue/rust">Homu queue</a>, select pull requests and then
use &quot;rollup&quot; button to make a rollup pull request. (The text about
fairness can be ignored.)
<strong>Important note</strong>:  consider for addition PRs marked as
<code>rollup=always</code>, <code>rollup=maybe</code> and <code>rollup=iffy</code>, based on the
review policies of <a href="release/../compiler/reviews.html#rollups">the Rollups section</a>.  Be extra careful when
deciding what to include, in particular on <code>rollup=maybe</code> and
<code>rollup=iffy</code> PRs. We should try as much as possible to avoid risking
and hit regressions (bugs or perf).  Also consider that contributors
often forget to tag things with rollup=never, when they should have
done so, so when PRs are not explicitly tagged with rollup, be extra
careful.</p>
</li>
<li>
<p>Run the following command in the pull request thread:</p>
<pre><code>@bors r+ rollup=never p=&lt;NUMBER_OF_PRS_IN_ROLLUP&gt;
</code></pre>
</li>
<li>
<p>If the rollup fails, use the logs rust-highfive (really it is
rust-log-analyzer) provides to bisect the failure to a specific PR and do
<code>@bors r-</code>. If the PR is running, you need to do <code>@bors r- retry</code>. Otherwise,
your rollup succeeded. If it did, proceed to the next rollup (every now and
then let <code>rollup=never</code> and toolstate PRs progress).</p>
</li>
<li>
<p>Recreate the rollup without the offending PR starting again from <strong>1.</strong></p>
</li>
</ol>
<h2 id="selecting-pull-requests"><a class="header" href="#selecting-pull-requests">Selecting Pull Requests</a></h2>
<p>This is something you will learn to improve over time. Some basic tips include
(from obvious to less):</p>
<ol>
<li>Avoid <code>rollup=never</code> PRs (these are red in the interface).</li>
<li>Include all PRs marked with <code>rollup=always</code> (these are green). Try to check
if some of the pull requests in this list shouldn't be rolled up — in the
interest of time you can do so sometimes after you've made the rollup PR.</li>
<li>Avoid pull requests that touch the CI configuration or bootstrap.
(Unless the CI PRs have been marked as <code>rollup</code>. -- see 2.)</li>
<li>Avoid having too many large diff pull requests in the same rollup.</li>
<li>Avoid having too many submodule updates in the same rollup (especially LLVM).
(Updating LLVM frequently forces most devs to rebuild LLVM which is not fun.)</li>
<li>Do not include toolstate PRs like those fixing Miri, Clippy, etc.</li>
<li>Do include docs PRs (they should hopefully be marked as green).</li>
</ol>
<h2 id="failed-rollups"><a class="header" href="#failed-rollups">Failed rollups</a></h2>
<p>If the rollup has failed, run the <code>@bors retry</code> command if the
failure was spurious (e.g. due to a network problem or a timeout). If it wasn't spurious,
find the offending PR and throw it out by copying a link to the rust-highfive comment,
and writing <code>Failed in &lt;link_to_comment&gt;, @bors r-</code>. Hopefully,
the author or reviewer will give feedback to get the PR fixed or confirm that it's not
at fault. The failed rollup PR can be closed.</p>
<p>Once you've removed the offending PR, re-create your rollup without it (see 1.).
Sometimes however, it is hard to find the offending PR. If so, use your intuition
to avoid the PRs that you suspect are the problem and recreate the rollup.
Another strategy is to raise the priority of the PRs you suspect,
mark them as <code>rollup=never</code> and let bors test them standalone to dismiss
or confirm your hypothesis.</p>
<p>If a rollup continues to fail you can run the <code>@bors rollup=never</code> command to
never rollup the PR in question.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="triage-procedure"><a class="header" href="#triage-procedure">Triage Procedure</a></h1>
<h2 id="pull-request-triage"><a class="header" href="#pull-request-triage">Pull Request Triage</a></h2>
<h3 id="status-tags"><a class="header" href="#status-tags">Status Tags</a></h3>
<ul>
<li>
<p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+draft%3Afalse+is%3Apr+sort%3Aupdated-asc+label%3AS-waiting-on-author+-label%3AI-nominated+-label%3Aneeds-fcp">S-waiting-on-author</a> - Author needs to make changes to address reviewer
comments, or merge conflicts/test failures are present. This also covers more
obscure cases, like a PR being blocked on another (usually with the S-blocked
label in addition), or waiting for a <a href="https://github.com/rust-lang-nursery/crater">crater</a> run -- it is the author's
responsibility to push the PR forward.</p>
<p>Also used for work-in-progress PRs, sometimes the PR will also be marked as
draft in GitHub.</p>
</li>
<li>
<p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+draft%3Afalse+is%3Apr+sort%3Aupdated-asc+label%3AS-waiting-on-review+-label%3AI-nominated+-label%3Aneeds-fcp">S-waiting-on-review</a> - Review is incomplete</p>
</li>
<li>
<p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+is%3Apr+label%3AS-waiting-on-team+sort%3Aupdated-asc">S-waiting-on-team</a> - A <code>T-</code> label is marked, and team has been CC'd for
feedback.</p>
</li>
<li>
<p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+is%3Apr+label%3AS-waiting-on-bors+sort%3Aupdated-asc">S-waiting-on-bors</a> - Currently approved, waiting to merge. Managed by <a href="https://github.com/rust-lang/homu">bors</a>.</p>
</li>
<li>
<p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+is%3Apr+label%3AS-waiting-on-crater+sort%3Aupdated-asc">S-waiting-on-crater</a> - Waiting to see what the impact the PR will have on the
ecosystem</p>
</li>
<li>
<p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+is%3Apr+label%3AS-waiting-on-bikeshed+sort%3Aupdated-asc">S-waiting-on-bikeshed</a> - Waiting on the consensus over a minor detail</p>
</li>
<li>
<p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+is%3Apr+label%3AS-waiting-on-perf+sort%3Aupdated-asc">S-waiting-on-perf</a> - Waiting on the results of a perf run</p>
</li>
<li>
<p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+is%3Apr+label%3AS-blocked+sort%3Aupdated-asc">S-blocked</a> - Waiting for another PR to be merged or for discussion to be
resolved</p>
</li>
<li>
<p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+is%3Apr+label%3AS-inactive+sort%3Aupdated-asc">S-inactive</a> - Hasn't had activity in a while</p>
</li>
<li>
<p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+label%3AS-experimental+sort%3Aupdated-asc">S-experimental</a> - An experimental PR that shouldn't be triaged.
<a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+draft%3Afalse+is%3Apr+sort%3Aupdated-asc+label%3AS-waiting-on-author+-label%3AI-nominated+-label%3Aneeds-fcp">S-waiting-on-author</a> used to be used for this, but <a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+label%3AS-experimental+sort%3Aupdated-asc">S-experimental</a>
communicates that the PR is an experiment to test out some changes.</p>
</li>
</ul>
<p>Also: <a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aopen+-label%3AS-waiting-on-author+-label%3AS-waiting-on-review+-label%3AS-waiting-on-team+-label%3AS-waiting-on-bors+-label%3AS-waiting-on-crater+-label%3AS-waiting-on-bikeshed+-label%3AS-waiting-on-perf+-label%3AS-blocked+-label%3AS-inactive+-label%3AS-waiting-on-fcp+-label%3AS-experimental">PRs with no status tags</a>. This is useful to find PRs
where highfive conked out and didn't assign a reviewer and thus didn't assign
<a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+draft%3Afalse+is%3Apr+sort%3Aupdated-asc+label%3AS-waiting-on-review+-label%3AI-nominated+-label%3Aneeds-fcp">S-waiting-on-review</a>. These PRs can get lost otherwise. (Note that you should
likely <strong>not</strong> triage PRs that have <code>r? @ghost</code> since that means the author does
not need a review yet.)</p>
<h3 id="procedure"><a class="header" href="#procedure">Procedure</a></h3>
<p>We primarily triage three status labels: S-waiting-on-review,
S-waiting-on-author, and (once in a while) S-blocked. Here is the procedure for
each:</p>
<h4 id="s-waiting-on-review"><a class="header" href="#s-waiting-on-review">S-waiting-on-review</a></h4>
<p>Click <a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+draft%3Afalse+is%3Apr+sort%3Aupdated-asc+label%3AS-waiting-on-review+-label%3AI-nominated+-label%3Aneeds-fcp">this link</a> to see all PRs with the
S-waiting-on-review label. Only triage PRs that were last updated 15 days or
more ago (give or take a day).</p>
<p>For each PR:</p>
<ol>
<li>
<p>If the PR has new conflicts, CI failed, or a new review has been made then
change the label to S-waiting-on-author and ping the author.</p>
</li>
<li>
<p>Add the PR to your <a href="release/triage-procedure.html#triage-report">report</a>.</p>
</li>
</ol>
<h4 id="s-waiting-on-author"><a class="header" href="#s-waiting-on-author">S-waiting-on-author</a></h4>
<p>Click <a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+draft%3Afalse+is%3Apr+sort%3Aupdated-asc+label%3AS-waiting-on-author+-label%3AI-nominated+-label%3Aneeds-fcp">this link</a> to see all PRs with the
S-waiting-on-author label. Only triage PRs that were last updated 15 days or
more ago (give or take a day).</p>
<p>For each PR:</p>
<ol>
<li>
<p>If the author did what the PR was waiting on them for then update the
label to S-waiting-on-review.</p>
<p>Otherwise, if the author still needs to do something, then ping the author if
they are <strong>not</strong> a member of a Rust team (does not include working groups —
only teams like <code>T-compiler</code>, <code>T-lang</code>, <code>T-rustdoc</code>, etc.).</p>
</li>
<li>
<p>Add the PR to your <a href="release/triage-procedure.html#triage-report">report</a>.</p>
</li>
</ol>
<h4 id="s-blocked"><a class="header" href="#s-blocked">S-blocked</a></h4>
<p>You only need to check S-blocked PRs occasionally (e.g., once a month).  Click
<a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+is%3Apr+label%3AS-blocked+sort%3Aupdated-asc">this link</a> to see all PRs with the S-blocked label.</p>
<p>For each PR:</p>
<ol>
<li>
<p>If it is still blocked then leave it as-is.</p>
<p>Otherwise, if it is no longer blocked, then remove S-blocked (and add a
status label like S-waiting-on-review if appropriate).</p>
</li>
<li>
<p>Add the PR to your <a href="release/triage-procedure.html#triage-report">report</a>.</p>
</li>
</ol>
<h4 id="triage-report"><a class="header" href="#triage-report">Triage Report</a></h4>
<p>You should record information about each PR you triage in a report. The report
is just a small document that looks like:</p>
<blockquote>
<h4 id="s-waiting-on-review-1"><a class="header" href="#s-waiting-on-review-1">S-waiting-on-review</a></h4>
<p>#12345 20 days - still waiting on review - author: ferris, assignee: bors</p>
<p>[...]</p>
</blockquote>
<p>Your report can look different, just make sure you include this information for
each PR:</p>
<ol>
<li>
<p>The PR number (e.g., <code>#12345</code>). No need to manually add a link; the Rust
Zulip will autolink PR (and issue) numbers.</p>
</li>
<li>
<p>Number of days since last activity. &quot;Activity&quot; means:</p>
<ul>
<li>author, reviewer, or team member commented or reviewed; or</li>
<li>bors commented about merge conflicts; or</li>
<li>PR was pushed to;</li>
<li>etc.</li>
</ul>
</li>
<li>
<p>Author, reviewer, and who or what (person, team, other PR, etc.) the PR is
waiting on.</p>
</li>
<li>
<p>Current status and what the most recent activity was (e.g., merge conflicts,
reviewer commented).</p>
</li>
</ol>
<p>Once you are done triaging PRs, post your report in the topic for the current
week's triage in the <code>#t-release/triage</code> Zulip stream.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="triaging-crater-runs"><a class="header" href="#triaging-crater-runs">Triaging Crater Runs</a></h1>
<h2 id="running-crater"><a class="header" href="#running-crater">Running crater</a></h2>
<p>We regularly run Crater runs, and this documents the procedure for triaging a beta run; it may also
be applicable to non-release team runs (e.g., PR crater runs) with minor modifications.</p>
<p>First, file a new issue titled &quot;Crater runs for 1.x&quot; (<a href="https://github.com/rust-lang/rust/issues/66244">example</a>)</p>
<p>A crater run for beta should be started as soon as we have beta out. Use the following craterbot
invocations.</p>
<p>$BETA_VERSION is e.g. 1.40.0-1, increment the 1 if it's not the first beta crater run, you can also
use the auto-incremented counter on the beta <code>rustc --version</code>.</p>
<p>$STABLE is e.g. 1.39.0 (the stable release)
$BETA is beta-YYYY-MM-DD, get the date by looking at https://static.rust-lang.org/manifests.txt and
get the date of the most recent channel-rust-beta.toml.</p>
<pre><code>@craterbot run name=beta-$BETA_VERSION start=$STABLE end=$BETA mode=build-and-test cap-lints=warn p=10
@craterbot run name=beta-rustdoc-$BETA_VERSION start=$STABLE end=$BETA mode=rustdoc cap-lints=warn p=5
</code></pre>
<p>Once the runs complete, you want to triage them</p>
<h2 id="triaging"><a class="header" href="#triaging">Triaging</a></h2>
<p>These steps should generally be done for the normal rustc run, and then followed up by a triage of
the rustdoc run. Ignore failures in rustdoc that look to be rooted in rustc (i.e., duplicate
failures).</p>
<p>There will usually be quite a few regressions -- there are a couple tools that can help reduce the
amount of work that you need to do. It's mostly a matter of personal preference which is more
helpful.</p>
<ul>
<li>https://github.com/Mark-Simulacrum/crater-generate-report/
<ul>
<li>This groups regressions by 'root' by parsing the logs to look for the compilation failed
messages printed by Cargo</li>
</ul>
</li>
<li>https://github.com/Centril/crater-cat-errors
<ul>
<li>This groups regressions by the &quot;error&quot; message, also by parsing logs</li>
</ul>
</li>
</ul>
<p>If you've written a tool, feel free to add it here! We're still figuring out what the best UI for
this is.</p>
<p>Regardless of the tool you've run, you ultimately need to read through a bunch of logs and try to
quickly determine if they're genuine failures or spurious. Most of the time, a compiler failure is
genuine, and test failures are mostly spurious, but this usually requires some level of guessing.</p>
<p>Once you've determined that something is a genuine failure, add it to a list somewhere (local file,
HackMD, whatever) with the error &quot;category.&quot; Mostly, you're trying to group things such that the
regressions in a single group are all caused by the same set of commits, and different groups have
different causes.</p>
<p>Once this is done, and you have all the regressions triaged into their separate groups, you want to
file a new issue for each group. It should have the <code>regression-from-stable-to-beta</code> and
<code>T-compiler</code> label by default, possibly <code>T-libs</code> if it's a standard library regression, but that's
relatively rare. If you happen to think you know the PR that caused the failure, cc the PR author in
a separate comment and link to the PR; otherwise compiler team will triage the issue soon.</p>
<p>Leave a comment on the original issue with the crater runs linking to all the issues you just
opened, ideally with the issue titles as well.</p>
<p>You're done!</p>
<h2 id="re-running-rustc-on-a-crate"><a class="header" href="#re-running-rustc-on-a-crate">Re-running rustc on a crate</a></h2>
<p>For the crates which we're not sure about, you can try running crater locally, or build the crate
directly (<a href="https://gist.githubusercontent.com/lqd/4a8af10389d10840d90655c109df5eac/raw/1bb8ac86e211b745b1674041bc725a859b390c3c/cratesio-curl"><code>cratesio-curl</code></a> can be helpful). Be careful -- regardless of what you do, you are running arbitrary code locally. It's
also fine to file issues for the crates you're not sure about and let the triage process naturally
categorize the error, though it's not good to do this for <em>all</em> the crates. Once you've triaged a
crater run a couple times you get a pretty good sense of what is spurious and what isn't, too.</p>
<p>You can run crater on just a single crate by doing something like this (at least, as of now).
Note that this will download several gigabytes (on first use) and requires Docker to be running.</p>
<pre><code>git clone https://github.com/rust-lang/crater
cd crater
cargo run -- prepare-local
CRATES=&quot;crates-io-crate-0.4.0,owner/repository-name&quot; # Edit this.
cargo run -- define-ex --crate-select=list:$CRATES --cap-lints=forbid 1.38.0 beta # Edit the stable version.
cargo run -- run-graph --threads 4
cargo run -- gen-report work/ex/default/
# view report for this crate
</code></pre>
<p>It's also possible to re-queue a subset of crates onto the official builders, for which that take a
look at: https://gist.github.com/ecstatic-morse/be799bfa4d3b3d6e163fa61a9c30706f</p>
<h2 id="determining-the-root-cause-of-the-regression"><a class="header" href="#determining-the-root-cause-of-the-regression">Determining the root cause of the regression</a></h2>
<p>It's not always apparent why a crate stopped building. This isn't generally something done as part
of crater triage -- but can be a good followup. Here, <a href="https://github.com/rust-lang/cargo-bisect-rustc"><code>cargo-bisect-rustc</code></a> and Felix's
<a href="http://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/">minimization guide</a> are excellent tools to apply.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="archive"><a class="header" href="#archive">Archive</a></h1>
<p>This section is for content that has become outdated, but that we want to keep
available to be read for historical/archival reasons.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="friends-of-the-tree"><a class="header" href="#friends-of-the-tree">Friends of the Tree</a></h1>
<p><a href="http://www.rust-lang.org/team.html">The Rust Team</a> likes to occasionally
recognize people who have made outstanding contributions to The Rust Project,
its ecosystem, and its community. These people are 'Friends of the Tree',
archived here for eternal glory.</p>
<h2 id="2016-02-26-mitaa"><a class="header" href="#2016-02-26-mitaa">2016-02-26 @mitaa</a></h2>
<p>This week we would like to nominate @mitaa as Friend of the Tree. Recently @mitaa
<a href="https://github.com/rust-lang/rust/pull/31837">has</a> <a href="https://github.com/rust-lang/rust/pull/31835">sent</a> <a href="https://github.com/rust-lang/rust/pull/31839">a</a> <a href="https://github.com/rust-lang/rust/pull/31715">wave</a> <a href="https://github.com/rust-lang/rust/pull/31626">of</a> <a href="https://github.com/rust-lang/rust/pull/31614">fixes</a> <a href="https://github.com/rust-lang/rust/pull/31602">to</a>
<a href="https://github.com/rust-lang/rust/pull/31596">rustdoc</a> (yes those are all separate links) with even more on the way!
Rustdoc has historically been a tool in need of some love, and the extra help in
fixing bugs is especially appreciated. Thanks @mitaa!</p>
<h2 id="2016-02-12-jeffrey-seyfried-jseyfried"><a class="header" href="#2016-02-12-jeffrey-seyfried-jseyfried">2016-02-12 Jeffrey Seyfried (@jseyfried)</a></h2>
<p><strong>This week's friend of the tree is Jeffrey Seyfried (@jseyfried)!</strong></p>
<p>Jeffrey Seyfried (@jseyfried) has made some awesome contributions to name
resolution. He has fixed a ton of bugs, reported previously unknown edge cases,
and done some big refactorings, all of which have helped improve a complex and
somewhat neglected part of the compiler.</p>
<h2 id="2015-12-04-vadim-petrochenkov-petrochenkov"><a class="header" href="#2015-12-04-vadim-petrochenkov-petrochenkov">2015-12-04 Vadim Petrochenkov @petrochenkov</a></h2>
<p>This week we'd like to nominate @petrochenkov for Friend of the Tree. Vadim has
been doing some absolutely amazing compiler work recently such as <a href="https://github.com/rust-lang/rust/pull/29726">fixing
privacy bugs</a>, <a href="https://github.com/rust-lang/rust/pull/29748">fixing hygiene bugs</a>, <a href="https://github.com/rust-lang/rust/pull/29383">fixing pattern bugs</a>,
<a href="https://github.com/rust-lang/rust/pull/29952">paving the way</a> and <a href="https://github.com/rust-lang/rust/pull/30206">implementing <code>#[deprecated]</code></a>,
<a href="https://github.com/rust-lang/rust/pull/29973">fixing and closing many privacy holes</a>, <a href="https://github.com/rust-lang/rust/pull/30087">refactoring</a>
<a href="https://github.com/rust-lang/rust/pull/30095">and</a> <a href="https://github.com/rust-lang/rust/pull/30145">improving</a> the HIR, and reviving <a href="https://github.com/rust-lang/rust/pull/30184">the old type ascription
PR</a>. The list of outstanding bugs and projects in the compiler is
growing ever smaller now; thanks @petrochenkov!</p>
<h2 id="2015-11-16-peter-atashian-windowsbunny-retep998"><a class="header" href="#2015-11-16-peter-atashian-windowsbunny-retep998">2015-11-16 Peter Atashian (WindowsBunny, retep998)</a></h2>
<p>In his own words, WindowsBunny is &quot;a hopping encyclopedia of all the issues
windows users might run into and how to solve them.&quot; One of the heroes that make
Rust work on Windows, he actively pushes the frontiers of what Rust can do on
the platform. He is also notably the maintainer of the
<a href="https://crates.io/crates/winapi">winapi</a> family of crates, a comprehensive set
of bindings to the Windows system APIs. You da bunny, WindowsBunny. Also, a
friend of the tree.</p>
<p><a href="https://internals.rust-lang.org/t/subteam-reports-2015-11-16/2910">Source</a>.</p>
<h2 id="2015-10-31-marcus-klaas"><a class="header" href="#2015-10-31-marcus-klaas">2015-10-31 Marcus Klaas</a></h2>
<p>Today @nrc would like to nominated @marcusklaas as Friend of the Tree:</p>
<p>Marcus is one of the primary authors of
<a href="https://github.com/nrc/rustfmt">rustfmt</a>. He has been involved since the early
days and is now the
<a href="https://github.com/nrc/rustfmt/graphs/contributors">top contributor</a>. He has
fixed innumerable bugs, implemented new features, reviewed a tonne of PRs, and
contributed to the design of the project. Rustfmt would not be the software it
is today without his hard work; he is indeed a Friend Of The Tree.</p>
<h2 id="2015-10-16-ryan-prichard"><a class="header" href="#2015-10-16-ryan-prichard">2015-10-16 Ryan Prichard</a></h2>
<p>nmatsakis would also like to declare Ryan Prichard a <strong>Friend of the Tree</strong>.
Over the last few months, Ryan has been comparing the Rust compiler's parsing
behavior with that of the rust-grammar project, which aims to create a LALR(1)
grammar for parsing Rust. Ryan has found a number of inconsistencies and bugs
between the two. This kind of work is useful for two reasons: it finds bugs,
obviously, which are often hard to uncover any other way. Second, it helps pave
the way for a true Rust reference grammar outside of the compiler source itself.
So Ryan Prichard, thanks!</p>
<h2 id="2015-10-02-vikrant-chaudhary"><a class="header" href="#2015-10-02-vikrant-chaudhary">2015-10-02 Vikrant Chaudhary</a></h2>
<p><a href="https://github.com/nasa42">Vikrant Chaudhary (nasa42)</a> is an individual who
believes in the Rust community. Since June he has been contributing to
<a href="http://this-week-in-rust.org">This Week in Rust</a>, coordinating its publication
on
<a href="https://users.rust-lang.org/t/this-week-in-rust-editors-thread/1806/51">urlo</a>,
and stirring up contributions. He recently rolled out an overhaul to the site's
design that brings it more inline with the main website. Today Vikrant is the
main editor on the weekly newsletter, assisted by
<a href="http://github.com/llogiq">llogiq</a> and other contributors. Thanks for keeping
TWiR running, Vikrant, you friend of the tree.</p>
<p><a href="https://internals.rust-lang.org/t/subteam-reports-2015-10-02/2716">Source</a>.</p>
<h2 id="2015-07-24-tshepang-lekhonkhobe"><a class="header" href="#2015-07-24-tshepang-lekhonkhobe">2015-07-24 Tshepang Lekhonkhobe</a></h2>
<p><a href="http://github.com/Gankra">@Gankra</a> has nominated
<a href="http://github.com/tshepang">@tshepang</a> for Friend of the Tree this week:</p>
<p>Over the last year Tshepang has landed over 100 improvements to our
documentation. Tshepang saw where documentation was not, and said &quot;No. This will
not do.&quot;</p>
<p>We should all endeavor to care about docs as much as Tshepang.</p>
<p><a href="https://internals.rust-lang.org/t/subteam-reports-2015-07-24/2397">Source</a>.</p>
<h2 id="2015-05-19-chris-morgan"><a class="header" href="#2015-05-19-chris-morgan">2015-05-19 Chris Morgan</a></h2>
<p>I'd like to nominate Chris Morgan (@chris-morgan) for Friend of the Tree today.
Chris recently redesigned the play.rust-lang.org site for the 1.0 release,
giving the site a more modern and rustic feel to it. Chris has been contributing
to Rust for quite some time now, his first contribution dating back to July 2013
and also being one of the early pioneers in the space of HTTP libraries written
in Rust. Chris truly is a friend of the tree!</p>
<h2 id="2015-03-24-andrew-gallant-burntsushi"><a class="header" href="#2015-03-24-andrew-gallant-burntsushi">2015-03-24 Andrew Gallant (BurntSushi)</a></h2>
<p><a href="https://github.com/burntsushi">BurntSushi</a> is an individual who practically needs no introduction. He's
written many of the world's most popular crates, including <a href="https://github.com/docopt/docopt.rs">docopt.rs</a>, <a href="https://github.com/rust-lang/regex">regex</a>,
<a href="https://github.com/BurntSushi/quickcheck">quickcheck</a>, <a href="https://github.com/BurntSushi/rust-cbor">cbor</a>, and <a href="https://github.com/BurntSushi/byteorder">byteorder</a>. Don't forget his CSV swiss-army-knife,
<a href="https://github.com/BurntSushi/xsv">xsv</a>, built on <a href="https://github.com/BurntSushi/rust-csv">rust-csv</a>. Feedback from his early work on libraries helped
informed the evolution of Rust during a critical time in its development, and
BurntSushi continues to churn out the kind of Rust gems that can only come from
someone who is a skilled friendofthetree.</p>
<h2 id="2015-03-03-manish-goregaokar-manishearth"><a class="header" href="#2015-03-03-manish-goregaokar-manishearth">2015-03-03 Manish Goregaokar (Manishearth)</a></h2>
<p>Manish started working on Servo as part of the GSoC program in 2014, where he
implemented XMLHttpRequest. Since then he's become in integral part of the Servo
team while finishing his university studies and organizing Rust community
events. In 2015 he took an interest in bors' queue and started making rollup PRs
to accelerate the integration process. Nursing the PR queue is the kind of
time-consuming labor that creates friends of the tree like Manish, the rollup
friend of the tree.</p>
<h2 id="2015-02-17-toby-scrace"><a class="header" href="#2015-02-17-toby-scrace">2015-02-17 Toby Scrace</a></h2>
<p>Today I would like to nominate Toby Scrace as Friend of the Tree. Toby emailed
me over the weekend about a login vulnerability on crates.io where you could log
in to whomever the previously logged in user was regardless of whether the
GitHub authentication was successful or not. I very much appreciate Toby
emailing me privately ahead of time, and I definitely feel that Toby has earned
becoming Friend of the Tree.</p>
<h2 id="2015-02-10-jonathan-reem-reem"><a class="header" href="#2015-02-10-jonathan-reem-reem">2015-02-10 Jonathan Reem (reem)</a></h2>
<p>Jonathan Reem has been making an impact on Rust since May 2014. His primary
contribution has been as the main author of the prominent <a href="https://github.com/iron/iron">Iron</a> web
framework, though he has also created several other popular projects including
the testing framework <a href="https://github.com/reem/stainless">stainless</a>. His practical experience with these projects
has led to several improvements in upstream rust, most notably his complete
rewrite of the <code>TaskPool</code> type. Reem is doing everything he can to advance the
Rust cause.</p>
<h2 id="2015-01-20-barosl-lee-barosl"><a class="header" href="#2015-01-20-barosl-lee-barosl">2015-01-20 Barosl Lee (barosl)</a></h2>
<p>Today I would like to nominate Barosl Lee (@barosl) for Friend of the Tree.
Barosl has recently rewritten our bors cron job in a new project called <a href="https://github.com/barosl/homu">homu</a>.
Homu has a number of benefits including:</p>
<ul>
<li>Zero &quot;down time&quot; between testing different PRs (compared to 30+ minutes for
bors!)</li>
<li>A new rollup button to create separate rollup PRs from other PRs.</li>
<li>Multiple repositories are supported (Cargo and Rust are on the same page)</li>
</ul>
<p>Homu was recently deployed for rust-lang/rust thanks to a number of issues being
closed out by Barosl, and it's been working fantastically so far! Barosl has
also been super responsive to any new issues cropping up. Barosl truly is a
Friend of the Tree!</p>
<h2 id="2015-01-13-kang-seonghoon-lifthrasiir-yurume"><a class="header" href="#2015-01-13-kang-seonghoon-lifthrasiir-yurume">2015-01-13 Kang Seonghoon (lifthrasiir, Yurume)</a></h2>
<p>Seonghoon has been an active member of the Rust community since early 2013, and
although he has made a number of valuable contributions to Rust itself, his
greatest work has been in developing key libraries out of tree. <a href="https://github.com/lifthrasiir/rust-encoding">rust-encoding</a>,
one of the most popular crates in Cargo, performs character encoding, and
<a href="https://github.com/lifthrasiir/rust-chrono">rust-chrono</a> date / time handling, both of which fill critical holes in the
functionality of the standard library. <a href="https://github.com/lifthrasiir/rust-strconv">rust-strconv</a> is a prototype of
efficient numerical string conversions that is a candidate for future inclusion
in the standard library. He maintains a <a href="https://lifthrasiir.github.io/rustlog/">blog</a> where he discusses his
work.</p>
<h2 id="2015-01-06-jorge-aparicio-japaric"><a class="header" href="#2015-01-06-jorge-aparicio-japaric">2015-01-06 Jorge Aparicio (japaric)</a></h2>
<p>I nominate Jorge Aparicio (japaric) for Friend of the Tree (for the second time,
no less!). japaric has done tremendous work porting the codebase to use the new
language features that are now available. First, he converted APIs in the
standard library to take full advantage of DST after it landed. Next, he
converted APIs to use unboxed closures. Then, he converted a large portion of
the libraries to use associated types. Finally, he removed boxed closures from
the compiler entirely. He has also worked to roll out RFCs changing the
overloaded operators and comparison traits, including both their definitions and
their impact on the standard library. And this list excludes a number of smaller
changes, like deprecating older syntax. The alpha release would not be where it
is without him; Japaric is simply one of the best friends the tree has ever had.</p>
<h2 id="2014-12-30-kevin-ballard-kballard-eridius"><a class="header" href="#2014-12-30-kevin-ballard-kballard-eridius">2014-12-30 Kevin Ballard (kballard, Eridius)</a></h2>
<p>This is a belated recognition of Kevin Ballard (aka @kballard, aka Eridius) as a
friend of the tree. Kevin put a lot of work into Unicode issues in Rust,
especially as related to platform-specific constraints. He wrote the current
path module in part to accommodate these constraints, and participated in the
recent redesign of the module. He has also been a dedicated and watchful
reviewer. Thanks, Kevin, for your contributions!</p>
<h2 id="2014-12-16-gábor-lehel-glaebhoerl"><a class="header" href="#2014-12-16-gábor-lehel-glaebhoerl">2014-12-16 Gábor Lehel (glaebhoerl)</a></h2>
<p>Gabor's major contributions to Rust have been in the area of language design. In
the last year he has produced a number of very high quality RFCs, and though
many of them of not yet been accepted, his ideas are often thought-provoking and
have had a strong influence on the direction of the language. His <a href="https://github.com/rust-lang/rfcs/pull/243">trait based
exception handling RFC</a> was particularly innovative, as well that <a href="https://github.com/rust-lang/rfcs/pull/146">for
future-proofing checked arithmetic</a>. Gabor is an exceedingly clever
Friend of the Tree.</p>
<h2 id="2014-11-11-brian-koropoff-unwound"><a class="header" href="#2014-11-11-brian-koropoff-unwound">2014-11-11 Brian Koropoff (unwound)</a></h2>
<p>In the last few weeks, he has fixed many, many tricky ICEs all over the
compiler, but particularly in the area of unboxed closures and the borrow
checker. He has also completely rewritten how unboxed closures interact with
monomorphization and had a huge impact on making them usable. Brian Koropoff is
truly a Friend of the Tree.</p>
<h2 id="2014-10-07-alexis-beingessner-gankra"><a class="header" href="#2014-10-07-alexis-beingessner-gankra">2014-10-07 Alexis Beingessner (Gankra)</a></h2>
<p>Alexis Beingessner (aka @Gankra) began contributing to Rust in July, and has
already had a major impact on several library-related areas. Her main focus has
been collections. She completely rewrote BTree, providing a vastly more complete
and efficient implementation. She proposed and implemented the new Entry API.
She's written extensive new documentation for the collections crate. She pitched
in on collections reform.</p>
<p>And she added collapse-all to rustdoc!</p>
<p>Alexis is, without a doubt, a FOTT.</p>
<h2 id="2014-09-02-jorge-aparicio-japaric"><a class="header" href="#2014-09-02-jorge-aparicio-japaric">2014-09-02 Jorge Aparicio (japaric)</a></h2>
<p>Jorge has made several high-impact contributions to the wider Rust community. He
is the primary author of rustbyexample.com, and last week published &quot;eulermark&quot;,
a comparison of language performance on project Euler problems, which happily
showed Rust performing quite well. As part of his benchmarking work he has
ported the 'criterion' benchmarking framework to Rust.</p>
<h2 id="2014-07-29-björn-steinbrink-dotdash-doener"><a class="header" href="#2014-07-29-björn-steinbrink-dotdash-doener">2014-07-29 Björn Steinbrink (dotdash, doener)</a></h2>
<p>Contributing since April 2013. Björn has done many optimizations for Rust,
including removing allocation bloat in iterators, fmt, and managed boxes;
optimizing <code>fail!</code>; adding strategic inlining in the libraries; speeding up data
structures in the compiler; eliminating quadratic blowup in translation, and
other IR bloat problems.</p>
<p>He's really done an amazing number of optimizations to Rust.</p>
<p>Most recently he earned huge kudos by teaching LLVM about the lifetime of
variables, allowing Rust to make much more efficient use of the stack.</p>
<p>Björn is a total FOTT.</p>
<h2 id="2014-07-22-jonas-hietala-treeman"><a class="header" href="#2014-07-22-jonas-hietala-treeman">2014-07-22 Jonas Hietala (treeman)</a></h2>
<p>Jonas Hietala, aka @treeman, has been contributing a large amount of
documentation examples recently for modules such as hashmap, treemap,
priority_queue, collections, bigint, and vec. He has also additionally been
fixing UI bugs in the compiler such as those related to format!</p>
<p>Jonas continues to add new examples/documentation every day, making
documentation more approachable and understandable for all newcomers. Jonas
truly is a friend of the tree!</p>
<h2 id="2014-07-08-sven-nilson-bvssvni-long_void"><a class="header" href="#2014-07-08-sven-nilson-bvssvni-long_void">2014-07-08 Sven Nilson (bvssvni, long_void)</a></h2>
<p>Sven Nilson has done a great deal of work to build up the Rust crate ecosystem,
starting with the well-regarded rust-empty project that provides boilerplate
build infrastructure and - crucially - integrates well with other tools like
Cargo.</p>
<p>His Piston project is one of the most promising Rust projects, and its one that
integrates a number of crates, stressing Rust's tooling at just the right time:
when we need to start learning how to support large-scale external projects.</p>
<p>Sven is a friend of the tree.</p>
<h2 id="2014-06-24-jakub-wieczorek-jakub-"><a class="header" href="#2014-06-24-jakub-wieczorek-jakub-">2014-06-24 Jakub Wieczorek (jakub-)</a></h2>
<p>jakub-, otherwise known as Jakub Wieczorek, has recently been working very hard
to improve and fix lots of match-related functionality, a place where very few
dare to venture! Most of this code appears to be untouched for quite some time
now, and it's receiving some well-deserved love now.</p>
<p>Jakub has fixed 10 bugs this month alone, many of which have been long-standing
problems in the compiler. He has also been very responsive in fixing bugs as
well as triaging issues that come up from fun match assertions.</p>
<p>Jakub truly is a friend of the tree!</p>
<h2 id="2014-04-22-klutzy"><a class="header" href="#2014-04-22-klutzy">2014-04-22 klutzy</a></h2>
<p>klutzy has been doing an amazing amount of Windows work for years now. He picks
up issues that affect our quality on Windows and picks them off 1 by 1. It's
tedious and doesn't get a ton of thanks, but is hugely appreciated by us. As
part of the Korean community, he has also done a lot of work for the local
community there. He is a friend of the tree. Thank you!</p>
<ul>
<li>Rust on Windows crusader</li>
<li>Fixed issues with x86 C ABI struct arguments</li>
<li>Fixed multiple issues with non-US locales</li>
</ul>
<h2 id="2014-03-18-clark-gaebel-cgaebel"><a class="header" href="#2014-03-18-clark-gaebel-cgaebel">2014-03-18 Clark Gaebel (cgaebel)</a></h2>
<p>This week's friend of the tree is Clark Gaebel. He just landed a huge first
contribution to Rust. He dove in and made our hashmaps significantly faster by
implementing Robin Hood hashing. He is an excellent friend of the tree.</p>
<h2 id="2014-02-25-erick-tryzelaar-erickt"><a class="header" href="#2014-02-25-erick-tryzelaar-erickt">2014-02-25 Erick Tryzelaar (erickt)</a></h2>
<ul>
<li>Contributing since May 2011</li>
<li>Wrote the serialization crate</li>
<li>Organizes the bay area Rust meetups</li>
<li>Just rewrote the Hash trait</li>
</ul>
<h2 id="2014-02-11-flavio-percoco-flaper87"><a class="header" href="#2014-02-11-flavio-percoco-flaper87">2014-02-11 Flavio Percoco (FlaPer87)</a></h2>
<ul>
<li>Contributing since September</li>
<li>Does issue triage</li>
<li>Organizing community events in Italy</li>
<li>Optimized the 'pow' function</li>
<li>Recently been fixing lots of small but important bugs</li>
</ul>
<h2 id="2014-01-27---jeff-olson-olsonjefferey"><a class="header" href="#2014-01-27---jeff-olson-olsonjefferey">2014-01-27 - Jeff Olson (olsonjefferey)</a></h2>
<ul>
<li>Contributing since February 2012</li>
<li>Did the original libuv integration</li>
<li>Implemented our second attempt at I/O, first using libuv</li>
<li>Ported parts of the C++ runtime to Rust</li>
<li>Implemented file I/O for the newest runtime</li>
<li>Last week published an article about file I/O on the Safari books blog</li>
</ul>
<h2 id="2014-01-21---steven-fackler-sfackler"><a class="header" href="#2014-01-21---steven-fackler-sfackler">2014-01-21 - Steven Fackler (sfackler)</a></h2>
<ul>
<li>Contributing since last May</li>
<li>CMU grad</li>
<li>Lots of library improvements, Base64, Bitv, I/O</li>
<li>Rustdoc improvements</li>
<li>Mut/RefCell</li>
<li>std::io::util</li>
<li>external module loading</li>
</ul>
<h2 id="2014-01-14---eduard-burtescu-eddyb"><a class="header" href="#2014-01-14---eduard-burtescu-eddyb">2014-01-14 - Eduard Burtescu (eddyb)</a></h2>
<ul>
<li>Contributing since October</li>
<li>Working on the compiler, including trans</li>
<li>Reduced rustc memory usage</li>
<li>Optimized vector operations</li>
<li>Helping refactor the compiler to eliminate use of deprecated features</li>
<li>Cleaned up ancient code in the compiler</li>
<li>Removed our long-standing incorrect use of the environment argument to pass
the self param</li>
</ul>
<h2 id="2014-01-07---vadim-chugunov-vadimcn"><a class="header" href="#2014-01-07---vadim-chugunov-vadimcn">2014-01-07 - Vadim Chugunov (vadimcn)</a></h2>
<ul>
<li>Contributing since June</li>
<li>Fixed numerous bugs on Windows</li>
<li>Fixing broken tests</li>
<li>Improved compatibility with newer mingw versions</li>
<li>Eliminated our runtime C++ dependency by implementing unwinding through
libunwind</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-release-history"><a class="header" href="#rust-release-history">Rust Release history</a></h1>
<p>This is an archive of Rust release artifacts from 0.1–1.7.0. Each release is
signed with the Rust <a href="https://www.rust-lang.org/rust-key.gpg.ascii">GPG signing key</a> (<a href="https://www.rust-lang.org/rust-key-old.gpg.ascii">older key</a>, <a href="https://www.rust-lang.org/rust-key-very-old.gpg.ascii">even
older key</a>).</p>
<h2 id="170"><a class="header" href="#170">1.7.0</a></h2>
<ul>
<li><a href="http://blog.rust-lang.org/2016/03/02/Rust-1.7.html">Announcement</a></li>
<li><a href="https://github.com/rust-lang/rust/blob/stable/RELEASES.md#version-170-2016-03-03">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rustc-1.7.0-src.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rustc-1.7.0-src.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-x86_64-pc-windows-gnu.exe">Windows x86_64 .exe gnu installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.7.0-x86_64-pc-windows-gnu.exe.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-x86_64-pc-windows-gnu.msi">Windows x86_64 .msi gnu installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.7.0-x86_64-pc-windows-gnu.msi.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-x86_64-pc-windows-msvc.exe">Windows x86_64 .exe MSVC installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.7.0-x86_64-pc-windows-msvc.exe.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-x86_64-pc-windows-msvc.msi">Windows x86_64 .msi MSVC installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.7.0-x86_64-pc-windows-msvc.msi.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-pc-windows-gnu.exe">Windows i686 .exe gnu installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-pc-windows-gnu.exe.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-pc-windows-gnu.msi">Windows i686 .msi gnu installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-pc-windows-gnu.msi.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-pc-windows-msvc.exe">Windows i686 .exe MSVC installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-pc-windows-msvc.exe.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-pc-windows-msvc.msi">Windows i686 .msi MSVC installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-pc-windows-msvc.msi.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-x86_64-unknown-linux-gnu.tar.gz">Linux x86_64 tarball</a> (<a href="https://static.rust-lang.org/dist/rust-1.7.0-x86_64-unknown-linux-gnu.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-unknown-linux-gnu.tar.gz">Linux i686 tarball</a> (<a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-unknown-linux-gnu.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-apple-darwin.pkg">Mac OS X i686 pkg</a> (<a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-apple-darwin.pkg.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-apple-darwin.tar.gz">Mac OS X i686 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-1.7.0-i686-apple-darwin.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.7.0-x86_64-apple-darwin.pkg">Mac OS X x86_64 pkg</a> (<a href="https://static.rust-lang.org/dist/rust-1.7.0-x86_64-apple-darwin.pkg.asc">signature</a>)</li>
</ul>
<h2 id="160"><a class="header" href="#160">1.6.0</a></h2>
<ul>
<li><a href="http://blog.rust-lang.org/2016/01/21/Rust-1.6.html">Announcement</a></li>
<li><a href="https://github.com/rust-lang/rust/blob/stable/RELEASES.md#version-160-2016-01-21">Release notes</a></li>
</ul>
<h2 id="150"><a class="header" href="#150">1.5.0</a></h2>
<ul>
<li><a href="http://blog.rust-lang.org/2015/12/10/Rust-1.5.html">Announcement</a></li>
<li><a href="https://github.com/rust-lang/rust/blob/stable/RELEASES.md#version-150-2015-12-10">Release notes</a></li>
</ul>
<h2 id="140"><a class="header" href="#140">1.4.0</a></h2>
<ul>
<li><a href="http://blog.rust-lang.org/2015/10/29/Rust-1.4.html">Announcement</a></li>
<li><a href="https://github.com/rust-lang/rust/blob/8ab8581f6921bc7a8e3fa4defffd2814372dcb15/RELEASES.md#version-140-october-2015">Release notes</a></li>
</ul>
<h2 id="130"><a class="header" href="#130">1.3.0</a></h2>
<ul>
<li><a href="http://blog.rust-lang.org/2015/09/17/Rust-1.3.html">Announcement</a></li>
<li><a href="https://github.com/rust-lang/rust/blob/master/RELEASES.md#version-130-september-2015">Release notes</a></li>
</ul>
<h2 id="120"><a class="header" href="#120">1.2.0</a></h2>
<ul>
<li><a href="http://blog.rust-lang.org/2015/08/06/Rust-1.2.html">Announcement</a></li>
<li><a href="https://github.com/rust-lang/rust/blob/master/RELEASES.md#version-120-2015-08-07">Release notes</a></li>
</ul>
<h2 id="110"><a class="header" href="#110">1.1.0</a></h2>
<ul>
<li><a href="http://blog.rust-lang.org/2015/06/25/Rust-1.1.html">Announcement</a></li>
<li><a href="https://github.com/rust-lang/rust/blob/master/RELEASES.md#version-110-2015-06-25">Release notes</a></li>
</ul>
<h2 id="100"><a class="header" href="#100">1.0.0</a></h2>
<ul>
<li><a href="http://blog.rust-lang.org/2015/05/15/Rust-1.0.html">Announcement</a></li>
<li><a href="https://github.com/rust-lang/rust/blob/master/RELEASES.md#version-100-2015-05-15">Release notes</a></li>
</ul>
<h2 id="100-beta"><a class="header" href="#100-beta">1.0.0-beta</a></h2>
<ul>
<li><a href="http://blog.rust-lang.org/2015/04/03/Rust-1.0-beta.html">Announcement</a></li>
</ul>
<h2 id="100-alpha2"><a class="header" href="#100-alpha2">1.0.0-alpha.2</a></h2>
<ul>
<li><a href="http://blog.rust-lang.org/2015/02/20/Rust-1.0-alpha2.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/1.0.0-alpha.2/RELEASES.md">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-x86_64-pc-windows-gnu.exe">Windows x86_64 .exe installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-x86_64-pc-windows-gnu.exe.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-i686-pc-windows-gnu.exe">Windows i686 .exe installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-i686-pc-windows-gnu.exe.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-x86_64-pc-windows-gnu.msi">Windows x86_64 .msi installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-x86_64-pc-windows-gnu.msi.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-i686-pc-windows-gnu.msi">Windows i686 .msi installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-i686-pc-windows-gnu.msi.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-x86_64-unknown-linux-gnu.tar.gz">Linux x86_64 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-x86_64-unknown-linux-gnu.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-i686-unknown-linux-gnu.tar.gz">Linux i686 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-i686-unknown-linux-gnu.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-x86_64-apple-darwin.pkg">Mac OS X x86_64 pkg</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-x86_64-apple-darwin.pkg.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-i686-apple-darwin.pkg">Mac OS X i686 pkg</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-i686-apple-darwin.pkg.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-x86_64-apple-darwin.tar.gz">Mac OS X x86_64 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-x86_64-apple-darwin.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-i686-apple-darwin.tar.gz">Mac OS X i686 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.2-i686-apple-darwin.tar.gz.asc">signature</a>)</li>
<li><a href="http://doc.rust-lang.org/1.0.0-alpha.2/index.html">Documentation</a></li>
</ul>
<h2 id="100-alpha"><a class="header" href="#100-alpha">1.0.0-alpha</a></h2>
<ul>
<li><a href="http://blog.rust-lang.org/2015/01/09/Rust-1.0-alpha.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/1.0.0-alpha/RELEASES.md">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-x86_64-pc-windows-gnu.exe">Windows x86_64 installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-x86_64-pc-windows-gnu.exe.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-i686-pc-windows-gnu.exe">Windows i686 installer</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-i686-pc-windows-gnu.exe.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-x86_64-unknown-linux-gnu.tar.gz">Linux x86_64 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-x86_64-unknown-linux-gnu.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-i686-unknown-linux-gnu.tar.gz">Linux i686 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-i686-unknown-linux-gnu.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-x86_64-apple-darwin.pkg">Mac OS X x86_64 pkg</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-x86_64-apple-darwin.pkg.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-i686-apple-darwin.pkg">Mac OS X i686 pkg</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-i686-apple-darwin.pkg.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-x86_64-apple-darwin.tar.gz">Mac OS X x86_64 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-x86_64-apple-darwin.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-i686-apple-darwin.tar.gz">Mac OS X i686 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-1.0.0-alpha-i686-apple-darwin.tar.gz.asc">signature</a>)</li>
<li><a href="http://doc.rust-lang.org/1.0.0-alpha/index.html">Documentation</a></li>
</ul>
<h1 id="rust-0x"><a class="header" href="#rust-0x">Rust 0.x</a></h1>
<p>In addition to the included short-form release in the mailing list, each
0.x release has a longer explanation in the release notes.</p>
<h2 id="0120"><a class="header" href="#0120">0.12.0</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2014-October/011267.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/0.12.0/RELEASES.md">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.12.0.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.12.0.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.12.0-x86_64-w64-mingw32.exe">Windows x86_64 installer</a>
(<a href="https://static.rust-lang.org/dist/rust-0.12.0-x86_64-w64-mingw32.exe.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.12.0-i686-w64-mingw32.exe">Windows i686 installer</a>
(<a href="https://static.rust-lang.org/dist/rust-0.12.0-i686-w64-mingw32.exe.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.12.0-x86_64-unknown-linux-gnu.tar.gz">Linux x86_64 tarball</a> (<a href="https://static.rust-lang.org/dist/rust-0.12.0-x86_64-unknown-linux-gnu.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.12.0-i686-unknown-linux-gnu.tar.gz">Linux i686 tarball</a> (<a href="https://static.rust-lang.org/dist/rust-0.12.0-i686-unknown-linux-gnu.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.12.0-x86_64-apple-darwin.pkg">Mac OS X x86_64 pkg</a>
(<a href="https://static.rust-lang.org/dist/rust-0.12.0-x86_64-apple-darwin.pkg.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.12.0-i686-apple-darwin.pkg">Mac OS X i686 pkg</a> (<a href="https://static.rust-lang.org/dist/rust-0.12.0-i686-apple-darwin.pkg.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.12.0-x86_64-apple-darwin.tar.gz">Mac OS X x86_64 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-0.12.0-x86_64-apple-darwin.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.12.0-i686-apple-darwin.tar.gz">Mac OS X i686 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-0.12.0-i686-apple-darwin.tar.gz.asc">signature</a>)</li>
<li><a href="http://doc.rust-lang.org/0.12.0/index.html">Documentation</a></li>
</ul>
<h2 id="0110"><a class="header" href="#0110">0.11.0</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2014-July/010655.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/0.11.0/RELEASES.txt">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.11.0.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.11.0.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.11.0-install.exe">Windows installer</a> (<a href="https://static.rust-lang.org/dist/rust-0.11.0-install.exe.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.11.0-x86_64-unknown-linux-gnu.tar.gz">Linux x86_64 tarball</a> (<a href="https://static.rust-lang.org/dist/rust-0.11.0-x86_64-unknown-linux-gnu.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.11.0-i686-unknown-linux-gnu.tar.gz">Linux i686 tarball</a> (<a href="https://static.rust-lang.org/dist/rust-0.11.0-i686-unknown-linux-gnu.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.11.0-x86_64-apple-darwin.pkg">Mac OS X x86_64 pkg</a>
(<a href="https://static.rust-lang.org/dist/rust-0.11.0-x86_64-apple-darwin.pkg.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.11.0-i686-apple-darwin.pkg">Mac OS X i686 pkg</a> (<a href="https://static.rust-lang.org/dist/rust-0.11.0-i686-apple-darwin.pkg.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.11.0-x86_64-apple-darwin.tar.gz">Mac OS X x86_64 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-0.11.0-x86_64-apple-darwin.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.11.0-i686-apple-darwin.tar.gz">Mac OS X i686 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-0.11.0-i686-apple-darwin.tar.gz.asc">signature</a>)</li>
<li><a href="http://doc.rust-lang.org/0.11.0/index.html">Documentation</a></li>
</ul>
<h2 id="010"><a class="header" href="#010">0.10</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2014-April/009387.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/0.10/RELEASES.txt">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.10.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.10.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.10-install.exe">Windows installer</a> (<a href="https://static.rust-lang.org/dist/rust-0.10-install.exe.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.10-x86_64-unknown-linux-gnu.tar.gz">Linux x86_64 tarball</a> (<a href="https://static.rust-lang.org/dist/rust-0.10-x86_64-unknown-linux-gnu.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.10-i686-unknown-linux-gnu.tar.gz">Linux i686 tarball</a> (<a href="https://static.rust-lang.org/dist/rust-0.10-i686-unknown-linux-gnu.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.10-x86_64-apple-darwin.pkg">Mac OS X x86_64 pkg</a> (<a href="https://static.rust-lang.org/dist/rust-0.10-x86_64-apple-darwin.pkg.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.10-i686-apple-darwin.pkg">Mac OS X i686 pkg</a> (<a href="https://static.rust-lang.org/dist/rust-0.10-i686-apple-darwin.pkg.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.10-x86_64-apple-darwin.tar.gz">Mac OS X x86_64 tarball</a>
(<a href="https://static.rust-lang.org/dist/rust-0.10-x86_64-apple-darwin.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.10-i686-apple-darwin.tar.gz">Mac OS X i686 tarball</a> (<a href="https://static.rust-lang.org/dist/rust-0.10-i686-apple-darwin.tar.gz.asc">signature</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.10/index.html">Documentation</a></li>
</ul>
<h2 id="09"><a class="header" href="#09">0.9</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2014-January/007753.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/0.9/RELEASES.txt">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.9.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.9.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.9-install.exe">Windows installer</a> (<a href="https://static.rust-lang.org/dist/rust-0.9-install.exe.asc">signature</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.9/index.html">Documentation</a></li>
</ul>
<h2 id="08"><a class="header" href="#08">0.8</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2013-September/005804.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/0.8/RELEASES.txt">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.8.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.8.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.8-install.exe">Windows installer</a> (<a href="https://static.rust-lang.org/dist/rust-0.8-install.exe.asc">signature</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.8/tutorial.html">Tutorial</a>
<ul>
<li><a href="http://doc.rust-lang.org/doc/0.8/tutorial-borrowed-ptr.html">borrowed pointers</a> |
<a href="http://doc.rust-lang.org/doc/0.8/tutorial-conditions.html">conditions</a> | <a href="http://doc.rust-lang.org/doc/0.8/tutorial-container.html">containers</a>
| <a href="http://doc.rust-lang.org/doc/0.8/tutorial-ffi.html">ffi</a> | <a href="http://doc.rust-lang.org/doc/0.8/tutorial-macros.html">macros</a> |
<a href="http://doc.rust-lang.org/doc/0.8/tutorial-rustpkg.html">rustpkg</a> | <a href="http://doc.rust-lang.org/doc/0.8/tutorial-tasks.html">tasks</a></li>
</ul>
</li>
<li><a href="http://doc.rust-lang.org/doc/0.8/rust.html">Manual</a> (<a href="http://doc.rust-lang.org/doc/0.8/rust.pdf">PDF</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.8/rustpkg.html">Rustpkg manual</a></li>
<li><a href="http://doc.rust-lang.org/doc/0.8/std/index.html">Standard library docs</a></li>
<li><a href="http://doc.rust-lang.org/doc/0.8/extra/index.html">Extra library docs</a></li>
</ul>
<h2 id="07"><a class="header" href="#07">0.7</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2013-July/004667.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/release-0.7/RELEASES.txt">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.7.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.7.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.7-install.exe">Windows installer</a> (<a href="https://static.rust-lang.org/dist/rust-0.7-install.exe.asc">signature</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.7/tutorial.html">Tutorial</a></li>
<li><a href="http://doc.rust-lang.org/doc/0.7/rust.html">Manual</a> (<a href="http://doc.rust-lang.org/doc/0.7/rust.pdf">PDF</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.7/std/index.html">Standard library docs</a></li>
<li><a href="http://doc.rust-lang.org/doc/0.7/extra/index.html">Extra library docs</a></li>
</ul>
<h2 id="06"><a class="header" href="#06">0.6</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2013-April/003427.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/release-0.6/RELEASES.txt">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.6.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.6.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.6-install.exe">Windows installer</a> (<a href="https://static.rust-lang.org/dist/rust-0.6-install.exe.asc">signature</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.6/tutorial.html">Tutorial</a></li>
<li><a href="http://doc.rust-lang.org/doc/0.6/rust.html">Manual</a> (<a href="http://doc.rust-lang.org/doc/0.6/rust.pdf">PDF</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.6/core/index.html">Core library docs</a></li>
<li><a href="http://doc.rust-lang.org/doc/0.6/std/index.html">Standard library docs</a></li>
</ul>
<h2 id="05"><a class="header" href="#05">0.5</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2012-December/002787.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/release-0.5/RELEASES.txt">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.5.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.5.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.5-install.exe">Windows installer</a> (<a href="https://static.rust-lang.org/dist/rust-0.5-install.exe.asc">signature</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.5/tutorial.html">Tutorial</a></li>
<li><a href="http://doc.rust-lang.org/doc/0.5/rust.html">Manual</a> (<a href="http://doc.rust-lang.org/doc/0.5/rust.pdf">PDF</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.5/core/index.html">Core library docs</a></li>
<li><a href="http://doc.rust-lang.org/doc/0.5/std/index.html">Standard library docs</a></li>
</ul>
<h2 id="04"><a class="header" href="#04">0.4</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2012-October/002489.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/release-0.4/RELEASES.txt">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.4.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.4.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.4-install.exe">Windows installer</a> (<a href="https://static.rust-lang.org/dist/rust-0.4-install.exe.asc">signature</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.4/tutorial.html">Tutorial</a></li>
<li><a href="http://doc.rust-lang.org/doc/0.4/rust.html">Manual</a> (<a href="http://doc.rust-lang.org/doc/0.4/rust.pdf">PDF</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.4/core/index.html">Core library docs</a></li>
<li><a href="http://doc.rust-lang.org/doc/0.4/std/index.html">Standard library docs</a></li>
</ul>
<h2 id="031"><a class="header" href="#031">0.3.1</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2012-July/002152.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/release-0.3.1/RELEASES.txt">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.3.1.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.3.1.tar.gz.asc">signature</a>)</li>
</ul>
<p>This was an OS X bugfix release.</p>
<h2 id="03"><a class="header" href="#03">0.3</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2012-July/002087.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/release-0.3/RELEASES.txt">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.3.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.3.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.3-install.exe">Windows installer</a> (<a href="https://static.rust-lang.org/dist/rust-0.3-install.exe.asc">signature</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.3/tutorial.html">Tutorial</a></li>
<li><a href="http://doc.rust-lang.org/doc/0.3/rust.html">Manual</a> (<a href="http://doc.rust-lang.org/doc/0.3/rust.pdf">PDF</a>)</li>
<li><a href="http://doc.rust-lang.org/doc/0.3/core/index.html">Core library docs</a></li>
<li><a href="http://doc.rust-lang.org/doc/0.3/std/index.html">Standard library docs</a></li>
</ul>
<h2 id="02"><a class="header" href="#02">0.2</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2012-March/001511.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/release-0.2/RELEASES.txt">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.2.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.2.tar.gz.asc">signature</a>)</li>
<li><a href="https://static.rust-lang.org/dist/rust-0.2-install.exe">Windows installer</a> (<a href="https://static.rust-lang.org/dist/rust-0.2-install.exe.asc">signature</a>)</li>
</ul>
<h2 id="01"><a class="header" href="#01">0.1</a></h2>
<ul>
<li><a href="https://mail.mozilla.org/pipermail/rust-dev/2012-January/001256.html">Announcement</a></li>
<li><a href="https://github.com/mozilla/rust/blob/release-0.1/RELEASES.txt">Release notes</a></li>
<li><a href="https://static.rust-lang.org/dist/rust-0.1.tar.gz">Source code</a> (<a href="https://static.rust-lang.org/dist/rust-0.1.tar.gz.asc">signature</a>)</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="js/moment.min.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
